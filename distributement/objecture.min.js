const e={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null};Object.values(e);const t={object:Object,array:Array};Object.values(t);const n=Object.assign({},e,t);Object.values(n);var r=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();const s={depth:0,maxDepth:10,accessors:[{default:(e,t)=>void 0===t?e:e[t]}.default]};function i(e,t){const n=[],r=Object.assign({},s,t);if(r.depth++,r.depth>r.maxDepth)return n;for(const t of r.accessors){const s=t.bind(e)(e);if(s)for(const[e,t]of Object.entries(s))if(r.values?r.values&&n.push([e,t]):n.push(e),"object"==typeof t&&null!==t&&t!==s){const s=i(t,r);if(r.values){if(r.values)for(const[t,r]of s){const s=[e,t].join(".");n.push([s,r])}}else for(const t of s){const r=[e,t].join(".");n.push(r)}}}return n}function a(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=r(e[t]),i=r(s);e[t]="object"===n&&"object"===i?a(e[t],s):s}return e}var o={default:(e,t)=>void 0===t?e:e[t]};function l(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var r=e.substr(0,t),s=e.substr(t+2);if(r.length>0&&s.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function c(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,r=0,s=0,i=-1,a=[""],o=[],p=0;p<e.length;p++){var u=e[p];if("\\"!==u){if("{"===u)if(n)r++;else if(p>i&&!r){t=e.substring(i+1,p);for(var d=0;d<a.length;d++)a[d]+=t;o=[],i=p,n=!0,r++}else r--;else if("}"===u)if(n)s++;else if(1===s){if(t=e.substring(i+1,p),o.length>0){var f=[];o.push(c(t));for(d=0;d<a.length;d++)for(var h=0;h<o.length;h++)for(var v=0;v<o[h].length;v++)f.push(a[d]+o[h][v]);a=f}else{t=l(t);for(d=0;d<a.length;d++)a[d]+=t}i=p,s--}else s--;else n||","!==u||s-r!=1||(t=e.substring(i+1,p),o.push(c(t)),i=p);!n||s!==r&&p!==e.length-1||(n=!1,p=i-1)}else p++}if(-1===i)return[e];var g="{"===e[i]?i:i+1;if(g<e.length){t=e.substr(g);for(d=0;d<a.length;d++)a[d]+=t}return a}function p(e,t){var n,r=!1!==t["!"],s=!1!==t["()"],i=!1;if(r){for(n=0;n<e.length&&"!"===e[n];n++){if(s&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function u(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function d(e,t,n){var r=void 0===t.separator||t.separator,s="",i="",a=".";!0===r?(s="/",i="[/\\\\]",a="[^/\\\\]"):a=r?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=u(e[n]);return t}(s=r)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var o=r?i+"+?":"",l=r?i+"*?":"",c=r?e.split(s):[e];return{source:e,segments:c,options:t,separator:r,separatorSplitter:s,separatorMatcher:i,optionalSeparator:l,requiredSeparator:o,wildcard:a,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:r&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function f(e,t,n,r){return{source:e,isFirst:n,isLast:r,end:e.length-1}}var h="(?!\\.)";function v(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=h+t),e.dotHandled=!0,e.result.match+=t),e.result}function g(e,t,n){var r=e.support,s=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(r.excludeDot||(s.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:v(s,i);if(r.globstar&&"**"===t.source)return v(s,"(?:"+((s.dotHandled?"":h)+e.wildcard+"*?"+i)+")*?");for(;++s.i<=t.end;){if(s.char=s.segment.source[s.i],s.nextChar=s.i<t.end?t.source[s.i+1]:"","\\"===s.char){if(s.i<s.segment.end){s.escapeChar=!0;continue}s.char=""}e=s.pattern,t=s.segment;var a=s.char,o=s.i;if(e.support.brackets&&!s.scanningForParens){if(o>s.openingBracket&&o<=s.closingBracket){s.escapeChar?v(s,u(a)):o===s.closingBracket?(v(s,"]"),s.openingBracket=t.source.length):"-"===a&&o===s.closingBracket-1?v(s,"\\-"):"!"===a&&o===s.openingBracket+1?v(s,"^"):v(s,"]"===a?"\\]":a),s.escapeChar=!1;continue}if(o>s.openingBracket){"]"===a&&!s.escapeChar&&o>s.openingBracket+1&&o>s.closingBracket?(s.closingBracket=o,s.i=s.openingBracket,e.separator?v(s,"(?!"+e.separatorMatcher+")[",!0):v(s,"[",!0)):o===t.end&&(v(s,"\\["),s.i=s.openingBracket,s.openingBracket=t.source.length,s.closingBracket=t.source.length),s.escapeChar=!1;continue}if("["===a&&!s.escapeChar&&o>s.closingBracket&&o<t.end){s.openingBracket=o,s.escapeChar=!1;continue}}if(s.pattern.support.extglobs){var l=s.extglobModifiers,c=(a=s.char,s.nextChar);o=s.i;if("("!==c||s.escapeChar||"@"!==a&&"?"!==a&&"*"!==a&&"+"!==a&&"!"!==a){if(")"!==a||s.escapeChar){if("|"===a&&s.closingParens&&!s.scanningForParens&&!s.escapeChar){v(s,"|");continue}}else if(s.scanningForParens)s.closingParens++;else if(l.length){var p=l.pop();if("!"===p&&-1!==l.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");v(s,")"+(p="!"===p||"@"===p?"":p)),s.addToMatch=!0,s.addToUnmatch=!0,s.closingParens--;continue}}else if(s.scanningForParens)s.openingParens++;else if(o>s.parensHandledUntil&&!s.closingParens)s.parensHandledUntil=o,s.scanningForParens=!0,s.openingParens++;else{if(s.closingParens>=s.openingParens){"!"===a&&(s.addToMatch=!0,s.addToUnmatch=!1,v(s,s.pattern.wildcard+"*?",!0),s.addToMatch=!1,s.addToUnmatch=!0,s.result.useUnmatch=!0),l.push(a),v(s,"(?:",!0),s.openingParens--,s.i++;continue}s.openingParens--}if(s.scanningForParens){s.closingParens!==s.openingParens&&o!==s.segment.end||(s.scanningForParens=!1,s.i=s.parensHandledUntil-1),s.escapeChar=!1;continue}}r=(e=s.pattern).support;!s.escapeChar&&r.star&&"*"===s.char?s.i!==s.segment.end&&"*"===s.nextChar||v(s,e.wildcard+"*?",!0):!s.escapeChar&&r.qMark&&"?"===s.char?v(s,e.wildcard,!0):v(s,u(s.char)),s.escapeChar=!1}return v(s,i)}function y(e,t,n){for(var r=d(e,t,n),s={match:"",unmatch:"",useUnmatch:!1},i=r.segments,a=0;a<i.length;a++){g(r,f(i[a],0,0===a,a===i.length-1),s)}return s.useUnmatch?"(?!^"+s.unmatch+"$)"+s.match:s.match}function b(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function j(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],r=0;r<e.length;r++)for(var s=t(e[r]),i=0;i<s.length;i++)n.push(s[i]);return n}(e,c));for(var n=[],r=[],s="",i=0;i<e.length;i++){var a=p(e[i],t),o=y(a.pattern,t,!a.isNegated);a.isNegated?r.push(o):n.push(o)}return r.length&&(s="(?!(?:"+r.join("|")+")$)"),n.length>1?s+="(?:"+n.join("|")+")":1===n.length?s+=n[0]:s.length&&(s+=y("**",t,!0)),"^"+s+"$"}(e,t),r=new RegExp(n,t.flags),s=b.bind(null,r);return s.options=t,s.pattern=e,s.regexp=r,s}class m{#e;#t=!1;#n=[];#r=[];#s;#i;#a;constructor(e,t){if(!e||!t)return this;const n=((e={})=>{const t={enable:!1,assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent",bindListener:!0,errorLog:!1,methods:{assign:{addEventListener:function(e,t){const{type:n,listener:r,settings:s}=e,{options:i,useCapture:a}=s;return t.addEventListener(n,r,i||a)},on:function(e,t){const{type:n,listener:r}=e;return t.on(n,r)},once:function(e,t){const{type:n,listener:r}=e;return t.once(n,r)}},deassign:{removeEventListener:function(e,t){const{type:n,listener:r,settings:s}=e,{options:i,useCapture:a}=s;return t.removeEventListener(n,r,i||a)},off:function(e,t){const{type:n,listener:r}=e;return t.off(n,r)}},transsign:{dispatchEvent:function(e,t,n){return t.dispatchEvent(n)},emit:function(e,t,n,...r){return t.emit(n,...r)}}}};for(const[n,r]of Object.entries(e))switch(n){case"methods":t[n]=a(t[n],r);break;case"enableEvents":break;default:t[n]=r}return t})(e);Object.defineProperties(this,{settings:{value:n},path:{value:n.path},type:{value:n.type},assigned:{value:[]},deassigned:{value:[]},transsigned:{value:[]},listener:{configurable:!0,get(){let e;if("string"===r(n.listener)){let s=t;e:for(const e of n.listener.split(".")){if(void 0===s[e])break e;s=s[e]}"function"===r(s)&&(e=s)}else e=n.listener;return!0===n.bindListener&&(e=e.bind(this.#e)),Object.defineProperty(this,"listener",{value:e}),e}}}),this.#e=t,this.enable=this.settings.enable}get enable(){return this.#t}set enable(e){const t=this.#o,n=this.assigned,r=this.deassigned;n.length=0,r.length=0;for(const s of t){const{path:t,target:i,enable:a}=s;if(this.settings,a!==e)if(!0===e)try{this.#l(i),s.enable=e,n.push(s)}catch(e){this.settings.errorLog&&console.error(e)}else if(!1===e)try{this.#c(i),s.enable=e,r.push(s)}catch(e){this.settings.errorLog&&console.error(e)}}this.#t=e}get#p(){return this.settings.target}get#o(){const e=this.#r,t=[];if(this.#p)for(const n of[].concat(this.#p)){const r=e.find((e=>e?.path===this.path));void 0!==r?t.push(r):void 0===r&&ptargets.push({path:this.path,target:n,enable:!1})}else if("string"===r(this.path)){const n=[];if(this.path===this.#u){const e={path:this.path,target:this.#e,enable:!1};t.push(e)}else{if(this.settings.propertyDirectory){const e=this.#d,t=j(this.path,{separator:"."});for(const[r,s]of e){!0===t(r)&&n.push([r,s])}"*"===this.path.charAt(0)&&n.unshift(this.#u)}else n.push(this.path);for(const[r,s]of n){const n=e.find((e=>e.path===r));let i,a=s;void 0!==a&&(a===n?.target?i=n:"object"==typeof a&&(i={path:r,target:a,enable:!1})),void 0!==i&&t.push(i)}}}return this.#r=t,this.#r}get#u(){return this.settings.propertyDirectory.scopeKey}get#l(){return void 0!==this.#s||(this.#s=this.settings.methods.assign[this.settings.assign].bind(null,this)),this.#s}get#c(){return void 0!==this.#i||(this.#i=this.settings.methods.deassign[this.settings.deassign].bind(null,this)),this.#i}get#f(){return void 0!==this.#a||(this.#a=this.settings.methods.transsign[this.settings.transsign].bind(null,this)),this.#a}get#d(){if(!this.settings.propertyDirectory)return null;const e=Object.assign(this.settings.propertyDirectory,{values:!0});return i(this.#e,e)}emit(){const e=this.#o,t=this.transsigned,n=this.#n;t.length=0,n.length=0;for(const r of e){const{target:e}=r;try{this.#f(e,...arguments),t.push(r)}catch(e){n.push(r)}}return this}}class E extends EventTarget{static implement=function(e,t){if(!e||!t)return;const n=((e={})=>{const t={events:{},enableEvents:!1,propertyDirectory:{accessors:[o.default],scopeKey:":scope",maxDepth:10},propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents",emitEvents:"emitEvents"}};for(const[n,r]of Object.entries(e))switch(n){case"propertyDefinitions":case"propertyDirectory":t[n]=Object.assign(t[n],r);break;default:t[n]=r}return t})(t),r=[];return Object.defineProperties(e,{[n.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments[0])return r;const e=[],t=[].concat(arguments[0]);for(const n of t)for(const t of r){let r;e:for(const[e,s]of Object.entries(n)){let n;if(n="listener"===e?t.settings[e]===s:t[e]===s,!1===r)break e;r=n}!0===r&&e.push(t)}return e}},[n.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments.length)return e;let t=function(e,t=":scope"){if(Array.isArray(e)||void 0===e)return e;const n=[];for(const[r,s]of Object.entries(e)){const e=r.trim().split(" ");let i,a,o;1===e.length?(i=t,a=e[0]):e.length>1&&(i=e[0],a=e[1]),Array.isArray(s)?(o=s[0],s[1]):o=s;const l={type:a,path:i,listener:o,enable:!1};n.push(l)}return n}(arguments[0],n.propertyDirectory.scopeKey),s=arguments[1]||!1;for(let i of t){const t={};for(const e of["assign","deassign","transsign","propertyDirectory","bindListener"]){const r=n[e];void 0!==r&&(t[e]=r)}a(t,i);const o=new m(t,e);s&&(o.enable=!0),r.push(o)}return e}},[n.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;let s=r.length-1;for(;s>-1;){const e=r[s];t.includes(e)&&(e.enable=!1,r.splice(s,1)),s--}return e}},[n.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!0;return e}},[n.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!1;return e}},[n.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[n.propertyDefinitions.getEvents](arguments[0]);for(const e of t)e.enable=!1,e.enable=!0;return e}},[n.propertyDefinitions.emitEvents]:{enumerable:!1,writable:!1,value:function(t,...r){const s=e[n.propertyDefinitions.getEvents](t);for(const e of s)e.emit(...r);return e}}}),n.events&&e[n.propertyDefinitions.addEvents](n.events),!0===n.enableEvents&&e[n.propertyDefinitions.enableEvents](),e};constructor(e={}){return super(),E.implement(this,e)}}const O={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null},P=Object.keys(O),w=Object.values(O),k={object:Object,array:Array},x=Object.keys(k),S=Object.values(k),D=Object.assign({},O,k),$=Object.keys(D),A=Object.values(D),T=[O.String,O.Number,O.Boolean,k.Object,k.Array];var _=Object.freeze({__proto__:null,ObjectKeys:x,ObjectValues:S,Objects:k,PrimitiveKeys:P,PrimitiveValues:w,Primitives:O,TypeKeys:$,TypeMethods:T,TypeValues:A,Types:D}),V=/\.(?=(?:[^"]*"[^"]*")*[^"]*$)/,q=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function C(e){let t;const n=q(e);if("string"===n){const n=e.toLowerCase();"object"===n?t={}:"array"===n&&(t=[])}else"object"===n?t={}:"array"===n&&(t=[]);return t}function I(e,t){const n=e.split(new RegExp(V)),r=n.pop();let s=t;for(const e of n)s=s[e];return s[r]}function N(e,t){const n=q(t),r=q(e);if(!["string","function"].includes(n)||!["array","object"].includes(r))return e;let s=C(e);for(const[r,i]of Object.entries(e))"string"===n?s[r]=I(t,i):"function"===n&&(s[r]=t(i)),s[r]&&"object"==typeof s[r]&&(s[r]=N(s[r],t));return s}function L(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,r]of Object.entries(n)){const n=q(e[t]),s=q(r);e[t]="object"===n&&"object"===s?L(e[t],r):r}return e}var B={type:!1};function R(e,t,n){const r=Object.assign({},B,n),s=Object.getOwnPropertyDescriptor(e,t);return r.type&&(s.type=q(s.value)),["array","object"].includes(q(s.value))&&(s.value=z(s.value)),s}function z(e,t){const n=Object.assign({},B,t),r={};for(const t of Object.keys(Object.getOwnPropertyDescriptors(e)))r[t]=R(e,t,n);return r}var M={typeCoercion:!1};function K(e,t,n,r){const s=Object.assign({},M,r),i=q(n.value);if(["array","object"].includes(i)){const e=(e=>{let t;const n=q(e);if("array"===n)t=!0;else if("object"===n&&Number.isInteger(e.length)&&e.length>=0){e:for(const n of Object.keys(Object.getOwnPropertyDescriptors(e)))if("length"!==n&&(t=!isNaN(n),!t))break e}else t=!1;return t})(Object.defineProperties(C(i),n.value))?[]:{};n.value=U(e,n.value)}else s.typeCoercion&&void 0!==Object.getOwnPropertyDescriptor(n,"type")&&!["undefined","null"].includes(i)&&(n.value=O[n.type](value));return Object.defineProperty(e,t,n),e}function U(e,t,n){Object.assign({},M,n);for(const[n,r]of Object.entries(t))K(e,n,r);return e}class W extends EventTarget{#h=localStorage;#v;constructor(e){super(),this.path=e}get path(){return this.#v}set path(e){void 0===this.#v&&(this.#v=e)}get(){try{return U(JSON.parse(this.#h.getItem(this.path)))}catch(e){console.error(e)}}set(e){try{return this.#h.setItem(this.path,JSON.stringify(z(e)))}catch(e){console.error(e)}}remove(){try{return this.#h.removeItem(this.path)}catch(e){console.error(e)}}}class F extends EventTarget{constructor(e){super();const t=Object.assign({},e);Object.defineProperties(this,{type:{value:t.type},key:{value:t.key},value:{value:t.value},message:{configurable:!0,get(){let e;return void 0!==this.pass&&(e=t.messages[String(this.pass)](this),Object.defineProperty(this,"message",{value:e})),e}},pass:{writable:!0,set pass(e){Object.defineProperty(this,"pass",{value:e})}}})}}const H={true:e=>`${e.valid}`,false:e=>`${e.valid}`};function J(e="expand",t){const n=t||this,r=n.schema,s=[].concat(n.advance,n.deadvance,n.unadvance);if("expand"===e){const t=C(r.type);for(const n of s){const r=[].concat(n.advance,n.deadvance,n.unadvance);t[n.key]={};for(const s of r)t[n.key][s.type]={},s.validation?t[n.key][s.type]=this.report(e,s.validation):t[n.key][s.type]=s}return t}if("impand"===e){if(!1===n.valid)return!1;const t=C(r.type);for(const n of s){const r=[].concat(n.advance,n.deadvance,n.unadvance);let s;e:for(const t of r)if("type"===t.type){t.validation&&n.valid&&(s=this.report(e,t.validation));break e}s||(s=n.valid),t[n.key]=s}return t}}class G extends EventTarget{constructor(e={},t){super();const n=Object.assign({messages:H},e);Object.defineProperties(this,{schema:{value:t},verificationType:{value:n.verificationType},required:{value:n.required},definition:{value:n.definition},key:{value:n.key},value:{value:n.value},advance:{value:[]},deadvance:{value:[]},unadvance:{value:[]},valid:{writable:!0,get valid(){},set valid(e){Object.defineProperty(this,"valid",{value:e})}},report:{configurable:!0,get(){const e=J.bind(this);return Object.defineProperty(this,"report",{value:e}),e}}})}}const Q={true:e=>`${e.pass}`,false:e=>`${e.pass}`};class X extends EventTarget{constructor(e={},t){super();const n=Object.freeze(Object.assign({messages:Q},e));Object.defineProperties(this,{definition:{value:n},schema:{value:t},type:{value:n.type},messages:{value:n.messages},validate:{configurable:!0,get(){const e=function(e,t,n,r){const{definition:s,messages:i,type:a}=this;let o=new F({type:a,key:e,value:s.value,messages:L({},i,s.messages)});const l=s.validate(...arguments);return"object"==typeof l?(o.validation=l,o.pass=l.valid):o.pass=l,o}.bind(this);return Object.defineProperty(this,"validate",{value:e}),e}}})}}class Y extends X{constructor(e,t){super(Object.assign({},e,{type:"required",validate:(e,n,r,s)=>{const{requiredProperties:i,requiredPropertiesSize:a,type:o}=t,l=Object.assign({},i);let c,p=a;if(Object.assign(C(o),r,s),this.definition,a){if(Object.hasOwn(l,e)&&(delete l[e],p--),p){const e=new oe(l,{path:t.path,parent:t.parent}),n=Object.assign({},s,r);c=e.validate(n).valid}}else c=!0;return c}}),t)}}const{ObjectKeys:Z,TypeKeys:ee}=_;class te extends X{constructor(e={},t){super(Object.assign({},e,{type:"type",validate:(e,t,n,r)=>{let s;const i=this.definition;let a=q(i.value);if(a="function"===a?q(i.value()):i.value instanceof oe?i.value.type:q(i.value),ee.includes(a)){const e=q(t);if("undefined"===e)s=!1;else if("undefined"===a)s=!0;else if(i.value instanceof oe){s=i.value.validate(t,n)}else s=a===e}else s=!1;return s}}),t)}}class ne extends X{constructor(e={},t){super(Object.assign(e,{type:"range",validate:(e,t)=>{const n=this.definition;let r;if("number"!=typeof t)r=!1;else{const{min:e,max:s}=n;let i,a;i=void 0===e||t>=e.value,a=void 0===s||t<=s.value,r=!(!i||!a)}return r}}),t)}}class re extends X{constructor(e={},t){super(Object.assign(e,{type:"length",validate:(e,t)=>{const n=this.definition;let r;if("string"!=typeof t)r=!1;else{const{min:e,max:s}=n;let i,a;i=void 0===e||t.length>=e.value,a=void 0===s||t.length<=s.value,r=!(!i||!a)}return r}}),t)}}class se extends X{constructor(e={},t){super(Object.assign(e,{type:"enum",validate:(e,t)=>{const n=this.definition;let r;if(["string","number","boolean"].includes(typeof t)){r=n.value.includes(t)}else r=!1;return r}}),t)}}class ie extends X{constructor(e={},t){super(Object.assign(e,{type:"match",validate:(e,t)=>{const n=this.settings;let r;if(["string","number","boolean"].includes(typeof t)){n.value.exec(t)}else r=!1;return!!r}}),t)}}var ae=(...e)=>Object.assign({required:!1,verificationType:"all",strict:!1,properties:{type:"type",value:"value"}},...e);class oe extends EventTarget{constructor(e={},t={}){super(),Object.defineProperties(this,{options:{value:ae(t)},type:{value:q(e)},parent:{configurable:!0,get(){const{options:e}=this,t=e.parent?e.parent:null;return Object.defineProperty(this,"parent",{value:t}),t}},root:{configurable:!0,get(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}},key:{configurable:!0,get(){const{path:e}=this,t=e?e.split(".").pop():null;return Object.defineProperty(this,"key",{value:t}),t}},path:{configurable:!0,get(){const{options:e}=this,t=e.path?String(e.path):null;return Object.defineProperty(this,"path",{value:t}),t}},required:{configurable:!0,get(){const e=this.options.required;return Object.defineProperty(this,"required",{value:e}),e}},requiredProperties:{configurable:!0,get(){const e=C(this.type);for(const[t,n]of Object.entries(this.target))!0===n.required?.value&&(e[t]=n);return Object.defineProperty(this,"requiredProperties",{value:Object.freeze(e)}),e}},requiredPropertiesSize:{configurable:!0,get(){const e=Object.keys(this.requiredProperties).length;return Object.defineProperty(this,"requiredPropertiesSize",{value:e}),e}},verificationType:{configurable:!0,get(){const e=this.options.verificationType;return Object.defineProperty(this,"verificationType",{value:e}),e}},target:{configurable:!0,get(){let t;const n=this.type;"array"===n?t=e.slice(0,1):"object"===n&&(t=e);const r=function(e,t){const n=C(e);if(le(e,t))return e;for(const[r,s]of Object.entries(e)){let e={};q(s);const i=le(s,t);if(_.TypeValues.includes(s))Object.assign(e,{type:{value:s}});else if(_.TypeKeys.includes(s))Object.assign(e,{type:{value:_.Types[s]}});else if(i){if(i)for(const[n,i]of Object.entries(s)){const s=ce(i,t);if(s)s&&(e[n]=i);else{let s;if("type"===n)if(i&&"object"==typeof i){const e=t.path?[t.path,r].join("."):r;s=new oe(i,Object.assign({},t.options,{parent:t,path:e}))}else s=i;else s=i;e[n]={type:n,value:s}}}}else{const n=t.path?[t.path,r].join("."):r;Object.assign(e,{type:{type:"type",value:new oe(s,Object.assign({},t.options,{parent:t,path:n}))}})}e.validators=[],n[r]=e;const a=new Map;a.set("type",Object.assign({},{type:"type",validator:te,value:e.type.value})),a.set("required",Object.assign({},{type:"required",validator:Y,value:e.required?.value||!1})),e.range?a.set("range",Object.assign({},e.range,{type:"range",validator:ne})):(e.min||e.max)&&a.set("range",Object.assign({},{type:"range",min:e.min,max:e.max,validator:ne})),e.length?a.set("length",Object.assign({},e.length,{type:"length",validator:re})):(e.minLength||e.maxLength)&&a.set("length",Object.assign({},{type:"length",min:e.minLength,max:maxLength,validator:re})),e.enum&&a.set("enum",Object.assign({},e.enum,{type:"enum",validator:se})),e.match&&a.set("match",Object.assign({},e.match,{type:"match",validator:ie})),delete e.min,delete e.max,delete e.minLength,delete e.maxLength;for(const[n,r]of a.entries()){const s=r.validator;e[n]=r,e.validators.push(new s(r,t))}}return n}(t,this);return Object.defineProperty(this,"target",{value:r}),r}},validate:{value:function(...e){let{$sourceName:t,$source:n,$target:r}=function(...e){let t,n,r;1===e.length?(t=null,n=e.shift(),r=null):2===e.length?["number","string"].includes(typeof e[0])?(t=e.shift(),n=e.shift(),r=null):e[0]&&"object"==typeof e[0]&&(t=null,n=e.shift(),r=e.shift()):3===e.length&&["number","string"].includes(typeof e[0])&&(t=e.shift(),n=e.shift(),r=e.shift());return{$sourceName:t,$source:n,$target:r}}(...e);r=r||C(n);const{target:s,path:i,required:a,type:o,verificationType:l}=this;let c=new G({required:a,verificationType:l,definition:s,key:t,value:n},this);const p=Object.entries(n);let u=0;for(;u<p.length;){const[e,t]=p[u],s=this.validateProperty(e,t,n,r);!0===s.valid?c.advance.push(s):!1===s.valid?c.deadvance.push(s):void 0===s.valid&&c.unadvance.push(s),u++}return c.advance.length?c.valid=!0:c.deadvance.length?c.valid=!1:c.unadvance.length?c.valid=void 0:c.valid=!0,c}},validateProperty:{value:function(){const{$key:e,$value:t,$source:n,$target:r}=function(...e){let[t,n,r,s]=e;return{$key:t,$value:n,$source:r,$target:s}}(...arguments),{target:s,path:i,required:a,schema:o,type:l,verificationType:c}=this;let p;"array"===l?p=s[0]:"object"===l&&(p=s[e]);const u=new G({required:a,verificationType:c,definition:p,key:e,value:t},this);if(void 0===p){const n=new F({type:null,definition:null,key:e,value:t},this);n.pass=!1,u.unadvance.push(n)}else e:for(const[s,i]of Object.entries(p.validators)){const s=i.validate(e,t,n,r);if(!0===s.pass?u.advance.push(s):!1===s.pass?u.deadvance.push(s):void 0===s.pass&&u.unadvance.push(s),"one"===this.verificationType&&u.deadvance.length)break e}return u.deadvance.length?u.valid=!1:u.advance.length?u.valid=!0:u.unadvance.length&&(u.valid=!1),u}}})}}function le(e,t){if(!e||e instanceof oe)return!1;const n=t.options.properties.type;return Object.hasOwn(e,n)}function ce(e,t){if(!e)return!1;const n=t.options.properties.value;return Object.hasOwn(e,n)}class pe extends CustomEvent{constructor(e,t,n){super(e,t),Object.defineProperties(this,{model:{get:()=>n},key:{configurable:!0,get(){const e=this.path?this.path.split(".").pop():null;return Object.defineProperty(this,"key",{value:e}),e}},change:{configurable:!0,get(){const e=t.change;return Object.defineProperty(this,"change",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},path:{configurable:!0,get(){const e=t.path;return Object.defineProperty(this,"path",{value:e}),e}},detail:{configurable:!0,get(){const e=t.detail;return Object.defineProperty(this,"detail",{value:e}),e}}})}}class ue{#g=!1;#y=!1;#b=!1;#j=!1;#m;#E;#O;#P;constructor(e={}){for(const[t,n]of Object.entries(e))this[t]=n}get preter(){return this.#E}set preter(e){if(!0===this.#y)return this.#E;this.#E=e?.valueOf(),this.#y=!0}get anter(){return this.#O}set anter(e){if(!0===this.#b)return this.#O;this.#O=e?.valueOf(),this.#b=!0}get conter(){if(!0===this.#j||[this.#y,this.#b].includes(!1))return this.#P;const e=JSON.stringify(this.preter);let t;return t=JSON.stringify(this.anter)!==e,this.#P=t,this.#j=!0,this.#P}}let de=class extends CustomEvent{constructor(e,t,n){super(e),Object.defineProperties(this,{key:{configurable:!0,get(){const e=t.key;return Object.defineProperty(this,"key",{value:e}),e}},path:{configurable:!0,get(){const e=n.path?[n.path,t.key].join("."):t.key;return Object.defineProperty(this,"path",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},valid:{configurable:!0,get(){const e=t.valid;return Object.defineProperty(this,"valid",{value:e}),e}}})}};var fe={assign:function(e,t,...n){const r=Object.assign({},t),s=r.assignArray||"assign",{path:i,schema:a,source:o,target:l}=e,{enableValidation:c,mutatorEvents:p,required:u,sourceTree:d,validationEvents:f}=r,h=[],v=new ue({preter:e});for(let t of n){let n;const o=new ue({preter:e});let u;Array.isArray(t)?n=[]:t&&"object"==typeof t&&(n={}),c&&a&&(u=a.validate(t,e.valueOf()),u.report());e:for(let[o,u]of Object.entries(t)){const h=new ue({preter:l[o]}),v=new ue({preter:l[o]});if(a&&c){const n=e.valueOf(),r=t,s=a.validateProperty(o,u,r,n);if(f){let t,n;s.valid?(t="validProperty",n=["validProperty",o].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",o].join(":"));for(const r of[t,n])e.dispatchEvent(new de(r,s,e))}if(!s.valid)continue e}let g;if(u&&"object"==typeof u){let t;u instanceof e.constructor&&(g=u.valueOf()),t="array"===a?.type?a.target[0].type.value:"object"===a?.type?a.target[o].type.value:null;const c=i?[i,o].join("."):String(o);if(!1===d){const s=L({},r,{path:c,parent:e});g=new e.constructor(u,t,s);const i={[o]:g};Object.assign(l,i),Object.assign(n,i)}else{if(l[o]instanceof e.constructor)g=l[o];else{const n=C(u),s=L({},r,{path:c,parent:e});g=new e.constructor(n,t,s)}const i={[o]:g};Object.assign(l,i),Object.assign(n,i),e.retroReenableEvents(),"array"===g.type?["push","unshift"].includes(s)?g[s](...u):g[s](u):"object"===g.type&&g.assign(u)}}else{g=u;const e={[o]:g};Object.assign(l,e),Object.assign(n,e)}if(p){const t=i?[i,o].join("."):String(o);if(p["assignSourceProperty:$key"]){const r=["assignSourceProperty",o].join(":");v.anter=l[o],e.dispatchEvent(new pe(r,{path:t,value:g,change:v,detail:{source:n}},e))}p.assignSourceProperty&&(h.anter=l[o],e.dispatchEvent(new pe("assignSourceProperty",{path:t,value:g,change:h,detail:{source:n}},e)))}}h.push(n),p&&p.assignSource&&(o.anter=e,e.dispatchEvent(new pe("assignSource",{path:i,change:o,detail:{source:n}},e)))}return p&&p.assign&&(v.anter=e,e.dispatchEvent(new pe("assign",{path:i,change:v,detail:{sources:h}},e))),e},defineProperties:function(e,t,n){const{path:r,schema:s}=e;let{enableValidation:i,mutatorEvents:a,required:o,validation:l,validationEvents:c,validationReport:p}=t;const u=Object.entries(n),d=new ue({preter:e});for(const[n,r]of u)e.defineProperty(n,r,Object.assign({},t,{validation:l,validationReport:p}));return a&&a.defineProperties&&(d.anter=e,e.dispatchEvent(new pe("defineProperties",{path:r,value:e.valueOf(),detail:{descriptors:n}},e))),e},defineProperty:function(e,t,n,r){const s=Object.assign({},t),i=s.assignArray||"defineProperties",{descriptorTree:a,enableValidation:o,mutatorEvents:l,validation:c,validationEvents:p,validationReport:u}=s,{target:d,path:f,schema:h}=e,v=r.value,g=(Object.getOwnPropertyDescriptor(d,n)||{}).value,y=new ue({preter:g}),b=new ue({preter:g}),j=g instanceof e.constructor;if(h&&o){const t=h.validateProperty(n,N(v,"value")||v,{},e.valueOf());if(p){let r,s;t.valid?(r="validProperty",s=["validProperty",n].join(":")):(r="nonvalidProperty",s=["nonvalidProperty",n].join(":"));for(const n of[r,s])e.dispatchEvent(new de(n,t,e))}if(!t.valid)return e}if(v&&"object"==typeof v){const t=f?[f,n].join("."):String(n);if(j)!0===a?g.defineProperties(r):Object.defineProperty(d,n,r);else{let o;h&&(o="array"===h.type?h.target[0].type.value:"object"===h.type?h.target[n].type.value:void 0);let l=C(v);const c=L({},s,{path:t,parent:e}),p=new e.constructor(l,o,c);!0===a?(d[n]=p,e.retroReenableEvents(),"array"===p.type?["push","unshift"].includes(i)?p[i](...v):p[i](v):"object"===p.type&&p.defineProperties(v)):!1===a&&Object.defineProperty(d,n,r)}}else Object.defineProperty(d,n,r);if(l){const t=f?[f,n].join("."):String(n);if(l["defineProperty:$key"]){b.anter=d[n];const s=["defineProperty",n].join(":");e.dispatchEvent(new pe(s,{path:t,value:v,change:b,detail:{prop:n,descriptor:r}},e))}l.defineProperty&&(y.anter=d[n],e.dispatchEvent(new pe("defineProperty",{path:t,value:v,change:y,detail:{prop:n,descriptor:r}},e)))}return e},freeze:function(e,t){const{recursive:n,mutatorEvents:r}=t,{target:s}=e;if(!0===n)for(const[t,n]of Object.entries(s))n instanceof e.constructor&&(n.freeze(),r&&r.freezeProperty&&e.dispatchEvent(new pe("freezeProperty",{path:n.path},e)));return Object.freeze(s),r&&r.freeze&&e.dispatchEvent(new pe("freeze",{path:e.path},e)),e},seal:function(e,t){const{recursive:n,mutatorEvents:r}=t,{target:s}=e;if(!0===n)for(const[t,n]of Object.entries(s))n instanceof e.constructor&&(n.seal(),r&&r.sealProperty&&e.dispatchEvent(new pe("sealProperty",{path:n.path},e)));return Object.seal(s),r&&r.seal&&e.dispatchEvent(new pe("seal",{path:e.path},e)),e}};var he={concat:function(e,t){const{target:n,path:r,schema:s}=e,{enableValidation:i,mutatorEvents:a,source:o,validationEvents:l}=t,c=[].concat(...arguments);let p=n.length;const u=[];let d,f=[...Array.from(n)];e:for(let t of c){if(s&&i){const t=e.valueOf(),n=o||C(t),r=s.validateProperty(p,$subvalue,n,t);if(s&&l){let t,n;r.valid?(t="validProperty",n=["validProperty",p].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",p].join(":"));for(const s of[t,n])e.dispatchEvent(new de(s,r,e))}if(!r.valid){p++;continue e}}const n=r?[r,p].join("."):String(p);if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());let r=s?.target[0].type.value||null;const i=C(t);let a=new e.constructor(i,r,{path:n,parent:e});a.concat(t),u[p]=a}else u[p]=t;if(f=Array.prototype.concat.call(f,u[p]),a){const t=r?[r,p].join("."):String(p);a.concatElement&&e.dispatchEvent(new pe("concatElement",{path:t,value:u[p],detail:{valueIndex:p,value:u[p]}},e)),a["concatElement:$index"]&&e.dispatchEvent(new pe("concatElement",{path:t,value:u[p],detail:{valueIndex:p,value:u[p]}},e))}p++}return d=new e.constructor(f,s,e.options),a&&a.concat&&e.dispatchEvent(new pe("concat",{path:r,detail:{values:d}},e)),d},copyWithin:function(e,t){const{target:n,path:r}=e,{enableValidation:s,validationEvents:i,mutatorEvents:a}=t,o=arguments[0]>=0?arguments[0]:n.length=arguments[0],l=arguments[1]>=0?arguments[1]:n.length+arguments[1],c=void 0===arguments[2]?n.length:arguments[2]>=0?arguments[2]:n.length+arguments[2],p=[];let u=l,d=o;for(;u<c;){const t=n[u];if(p.push(t),Array.prototype.copyWithin.call(n,d,u,u+1),e.retroReenableEvents(),a){const n=r?[r,u].join("."):String(u);if(a.copyWithinElement&&e.dispatchEvent(new pe("copyWithinElement",{path:n,value:t,detail:{target:d,start:u,end:u+1,item:t}},e)),a["copyWithinElement:$index"]){const r=["copyWithinElement",u].join(":");e.dispatchEvent(new pe(r,{path:n,value:t,detail:{target:d,start:u,end:u+1,item:t}},e))}}u++,d++}return a&&a.copyWithin&&e.dispatchEvent(new pe("copyWithin",{path:r,detail:{target:o,start:l,end:c,items:p}},e)),e},fill:function(e,t,...n){const r=Object.assign({},t),{target:s,path:i,schema:a}=e,o=r.assignObject,l=r.assignArray||o,{enableValidation:c,lengthen:p,mutatorEvents:u,validationEvents:d}=r,f=[];let h,v;h="number"==typeof n[1]?n[1]>=0?n[1]:s.length+n[1]:0,v="number"==typeof n[2]?n[2]>=0?n[2]:s.length+n[2]:s.length,p&&s.length<v&&(s.length=v);let g=h;e:for(;g<s.length&&g<v;){if(a&&c){let t=a.validate(t,e.valueOf());if(d){let n,r;t.valid?(n="validProperty",r=["validProperty",g].join(":")):(n="nonvalidProperty",r=["nonvalidProperty",g].join(":"));for(const s of[n,r])e.dispatchEvent(new de(s,t,e))}if(!t.valid)continue e}const t=i?[i,g].join("."):String(g);let p,h=n[0];if(h&&"object"==typeof h){h instanceof e.constructor&&(h=h.valueOf());const n=a?.target[0].type.value||null,s=C(h),i=Object.assign({},r,{path:t,parent:e});p=new e.constructor(s,n,i)}if(Array.prototype.fill.call(s,p,g,g+1),e.retroReenableEvents(),"array"===p.type?["push","unshift"].includes(l)?p[l](...h):p[l](h):"object"===p.type&&p[o](h),f.push(p),u){const t=i?[i,g].join("."):String(g);if(u.fillElement&&e.dispatchEvent(new pe("fillElement",{path:t,value:p,detail:{start:g,end:g+1,value:p}},e)),u["fillElement:$index"]){const n=["fillElement",g].join(":");e.dispatchEvent(new pe(n,{path:t,detail:{start:g,end:g+1,value:p}},e))}}g++}return u&&u.fill&&e.dispatchEvent(new pe("fill",{path:i,detail:{start:h,end:v,filled:f}},e)),e},pop:function(e,t){const{mutatorEvents:n}=t,{target:r,path:s}=e,i=Array.prototype.pop.call(r),a=r.length-1;if(e.retroReenableEvents(),n&&n.pop){const t=s?[s,a].join("."):String(a);e.dispatchEvent(new pe("pop",{path:t,value:i,detail:{elementIndex:a,element:i}},e))}return i},push:function(e,t,...n){const r=Object.assign({},t),s="push",i=r.assignObject,{enableValidation:a,mutatorEvents:o,source:l,validationEvents:c}=r,{target:p,path:u,schema:d}=e,f=[];let h=0;for(let t of n){let n;if(d&&a){const n=e.valueOf(),r=l||C(n),s=d.validateProperty(h,t,r,n);if(c){let t,n;s.valid?(t="validProperty",n=["validProperty",h].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",h].join(":"));for(const r of[t,n])e.dispatchEvent(new de(r,s,e))}if(!s.valid)return p.length}const v=u?[u,h].join("."):String(h);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const a=d?.target[0].type.value||null,o=C(q(t)),l=Object.assign({},r,{path:v,parent:e});n=new e.constructor(o,a,l),Array.prototype.push.call(p,n),e.retroReenableEvents(),"array"===n.type?["push","unshift"].includes(s)?n[s](...t):n[s](t):"object"===n.type&&n[i](t)}else n=t,Array.prototype.push.call(p,n);if(f.push(n),o){const t=u?[u,h].join("."):String(h);if(o.pushElement&&e.dispatchEvent(new pe("pushElement",{path:t,value:f[h],detail:{elementsIndex:h,element:f[h]}},e)),o["pushElement:$index"]){const n=["pushElement",h].join(":");e.dispatchEvent(new pe(n,{path:t,value:f[h],detail:{elementsIndex:h,element:f[h]}},e))}}h++}return o&&o.push&&e.dispatchEvent(new pe("push",{path:u,detail:{elements:f}},e)),p.length},reverse:function(e,t){const{mutatorEvents:n}=t,{target:r,path:s}=e;return Array.prototype.reverse.call(r,...arguments),e.retroReenableEvents(),n&&n.reverse&&e.dispatchEvent(new pe("reverse",{path:s,detail:{reference:r}},e)),e},shift:function(e,t){const{mutatorEvents:n}=t,{target:r,path:s}=e,i=Array.prototype.shift.call(r),a=0;if(e.retroReenableEvents(),n&&n.shift){const t=s?[s,a].join("."):String(a);e.dispatchEvent(new pe("shift",{path:t,value:i,detail:{elementIndex:a,element:i}},e))}return i},splice:function(e,t){const n=Object.assign({},t),r=n.assignObject,s=n.assignArray||r,{mutatorEvents:i,source:a}=n,{target:o,path:l,schema:c}=e,{enableValidation:p,validationEvents:u}=n,d=[...arguments],f=d[0]>=0?d[0]:o.length+d[0],h=d[1]<=0?0:void 0===d[1]||f+d[1]>=o.length?o.length-f:d[1],v=d.slice(2),g=v.length,y=[];let b=0;for(;b<h;){const t=Array.prototype.splice.call(o,f,1)[0];if(y.push(t),i){const n=l?[l,b].join("."):String(b);if(i.spliceDeleteElement&&e.dispatchEvent(new pe("spliceDeleteElement",{path:n,value:t,detail:{index:f+b,deleteIndex:b,deleteItem:t}},e)),i["spliceDeleteElement:$index"]){const r=["spliceDeleteElement",b].join(":");e.dispatchEvent(new pe(r,{path:n,value:t,detail:{index:f+b,deleteIndex:b,deleteItem:t}},e))}}b++}let j=0;e:for(;j<g;){let t=v[j];if(c&&p){const t=e.valueOf(),n=a||C(t),r=c.validateProperty(elementIndex,element,n,t);if(u){let t,n;r.valid?(t="validProperty",n=["validProperty",j].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",j].join(":"));for(const s of[t,n])e.dispatchEvent(new ValidatorEvent(s,r,e))}if(!r.valid){j++;continue e}}const d=l?[l,j].join("."):String(j);let h=f+j;if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());const i=c?.target[0].type.value||null,a=C(t),l=recursiveAssign({},n,{path:d,parent:e});t=new e.constructor(a,i,l),Array.prototype.splice.call(o,h,0,t),e.retroReenableEvents(),"array"===t.type?["push","unshift"].includes(s)?t[s](...$value):t[s]($value):"object"===t.type&&t[r]($value)}else Array.prototype.splice.call(o,h,0,t);if(i){const n=l?[l,j].join("."):String(j);if(i.spliceAddElement&&e.dispatchEvent(new pe("spliceAddElement",{path:n,value:t,detail:{index:f+j,addIndex:j,addItem:t}},e)),i["spliceAddElement:$index"]){const r=["spliceAddElement",j].join(":");e.dispatchEvent(new pe(r,{path:n,value:t,detail:{index:f+j,addIndex:j,addItem:t}},e))}}j++}return i&&i.splice&&e.dispatchEvent(new pe("splice",{path:l,detail:{$start:f,deleted:y,added:v,length:o.length}},e)),y},unshift:function(e,t,...n){const r=Object.assign({},t),s=r.assignObject,{enableValidation:i,mutatorEvents:a,source:o,validationEvents:l}=r,{target:c,path:p,schema:u}=e,d=[];let f=0;for(let t of n){let n;if(u&&i){const n=e.valueOf(),r=o||C(n),s=u.validateProperty(f,t,r,n);if(l){let t,n;s.valid?(t="validProperty",n=["validProperty",f].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",f].join(":"));for(const r of[t,n])e.dispatchEvent(new ValidatorEvent(r,s,e))}if(!s.valid)return c.length}const h=p?[p,f].join("."):String(f);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const i=u?.target[0].type.value||null,a=C(q(t)),o=Object.assign({},r,{path:h,parent:e});n=new e.constructor(a,i,o),Array.prototype.unshift.call(c,n),e.retroReenableEvents(),"array"===n.type?n.unshift(...t):"object"===n.type&&n[s](t)}else n=t,Array.prototype.unshift.call(c,n);if(d.unshift(n),a){const t=p?[p,f].join("."):String(f);if(a.unshiftElement&&e.dispatchEvent(new pe("unshiftElement",{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e)),a["unshiftElement:$index"]){const n=["unshiftElement",f].join(":");e.dispatchEvent(new pe(n,{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e))}}f++}return a&&a.unshift&&e.dispatchEvent(new pe("unshift",{path:p,detail:{elements:d}},e)),c.length}};var ve={get:function(e,t,...n){let r;const s=t;return"string"==typeof n[0]?(2===n.length&&L(s,n[1]),r=function(e,t,n){const{target:r,path:s}=e,{mutatorEvents:i,pathkey:a,subpathError:o}=t;if(!0===a){const a=n.split(new RegExp(V)),l=a.shift();let c=r[l];if(a.length){if(!1===o&&void 0===c)return;return c.get(a.join("."),t)}if(i&&(i.getProperty&&e.dispatchEvent(new pe("getProperty",{path:s,value:c,detail:{key:l,value:c}},e)),i["getProperty:$key"])){const t=["getProperty",l].join(":"),n=[s,l].join(".");e.dispatchEvent(new pe(t,{path:n,detail:{value:c}},e))}return c}if(!1===a)return r[propertyKey]}(e,s,...n)):(1===n.length&&L(s,n[0]),r=function(e,t){const{path:n}=e,{mutatorEvents:r}=t;return r&&r.get&&e.dispatchEvent(new pe("get",{path:n,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,s,...n)),r},set:function(e,t,...n){let r;const s=t;return"string"==typeof n[0]?(3===n.length&&L(s,n[2]),r=function(e,t,n,r){const s=Object.assign({},t),i="set",a=s.assignArray||"set",{target:o,path:l,schema:c}=e,{enableValidation:p,mutatorEvents:u,pathkey:d,recursive:f,subpathError:h,validationEvents:v,source:g}=s;if(!0===d){const t=n.split(new RegExp(V)),d=t.shift();let y;const b=q(r),j=l?[l,d].join("."):String(d);if(t.length){if(f&&void 0===o[d]){let t,n;t="array"===c?.type?c.target[0].type.value:"object"===c?.type?c.target[d].type.value:void 0,n="array"===b?[]:"object"===b||isNaN(Number(d))?{}:[];const r=L({},s,{path:j,parent:e});y=new e.constructor(n,t,r)}else y=o[d];if(!1===h&&void 0===y)return;return"array"===y.type?["push","unshift"].includes(a)?y[a](...r):y[a](r):"object"===y.type&&y[i](t.join("."),r,s),y}if(c&&p){const t=e.valueOf(),n=g||C(t),s=c.validateProperty(d,r,n,t);if(v){let t,n;s.valid?(t="validProperty",n=["validProperty",d].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",d].join(":"));for(const r of[t,n])e.dispatchEvent(new de(r,s,e))}if(!s.valid)return}if(r&&"object"==typeof r){r instanceof e.constructor&&(r=r.valueOf());const t=q(r);let n,l;n="array"===c?.type?c.target[0].type.value:"object"===c?.type?c.target[d].type.value:void 0,l="array"===t?[]:"object"===t||isNaN(Number(d))?{}:[];const p=L({},s,{path:j,parent:e});y=new e.constructor(l,n,p),o[d]=y,e.retroReenableEvents(),"array"===y.type?["push","unshift"].includes(a)?y[a](...r):y[a](r):"object"===y.type&&y[i](r)}else y=r,o[d]=y;const m=y.valueOf();if(u){const t=l?[l,d].join("."):String(d);if(u.setProperty&&e.dispatchEvent(new pe("setProperty",{path:t,value:m,detail:{key:d,value:m}},e)),u["setProperty:$key"]){const n=["setProperty",d].join(":");e.dispatchEvent(new pe(n,{path:t,value:m,detail:{value:m}},e))}}return y}if(!1===d){let t=n;if(r&&"object"==typeof r){r instanceof e.constructor&&(r=r.valueOf());const n=q(r);let p,u;"array"===c?.type&&(p=c.target[0].type.value),p="object"===c?.type?c.target[t].type.value:void 0,u="array"===n?[]:"object"===n||isNaN(Number(t))?{}:[];const d=L({},s,{path:l?[l,t].join("."):String(t),parent:e});propertyValue=new e.constructor(u,p,d),o[t]=propertyValue,e.retroReenableEvents(),"array"===propertyValue.type?["push","unshift"].includes(a)?propertyValue[a](...r):propertyValue[a](r):"object"===propertyValue.type&&propertyValue[i](r)}else propertyValue=r,o[t]=propertyValue;if(u){const n=l?[l,t].join("."):String(t);if(u.setProperty&&e.dispatchEvent(new pe("setProperty",{path:n,value:_propertyValue,detail:{key:t,value:_propertyValue}},e)),u["setProperty:$key"]){const r=["setProperty",t].join(":");e.dispatchEvent(new pe(r,{path:n,value:_propertyValue,detail:{value:_propertyValue}},e))}}return propertyValue}}(e,s,...n)):(2===n.length&&L(s,n[1]),r=function(e,t,n){const{path:r,schema:s}=e;let{enableValidation:i,mutatorEvents:a,required:o,validationEvents:l}=t;for(const[r,s]of Object.entries(n))e.set(r,s,Object.assign(t,{source:n}));return a&&a.set&&e.dispatchEvent(new pe("set",{path:r,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,s,...n)),r},delete:function(e,t,...n){let r;const s=t;return"string"==typeof n[0]?(2===n.length&&L(s,n[1]),r=function(e,t,n){const{target:r,path:s,schema:i}=e,{mutatorEvents:a,pathkey:o,subpathError:l,enableValidation:c,validationEvents:p}=t;if(!0!==o)if(!1!==o);else{const o=n,l=r[o];if(i&&c){const t=e.valueOf();delete t[o];const n=i.validate(o,t,e.valueOf());if(p){let t,r;n.valid?(t="validProperty",r=["validProperty",o].join(":")):(t="nonvalidProperty",r=["nonvalidProperty",o].join(":"));for(const s of[t,r])e.dispatchEvent(new de(s,n,e))}if(!n.valid)return}if(l instanceof e.constructor&&l.delete(t),delete r[o],a&&(a.deleteProperty&&e.dispatchEvent(new pe("deleteProperty",{path:s,value:l,detail:{key:o,value:l}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",o].join(":"),n=[s,o].join(".");e.dispatchEvent(new pe(t,{path:n,value:l,detail:{value:l}},e))}}else{const o=n.split(new RegExp(V)),u=o.shift();let d=r[u];if(o.length){if(!1===l&&void 0===d)return;return d.delete(o.join("."),t)}if(i&&c){const t=e.valueOf();delete t[u];const n=i.validate(u,t,{},e.valueOf());if(p){let t,r;const i=s?[s,u].join("."):String(u);n.valid?(t="validProperty",r=["validProperty",u].join(":")):(t="nonvalidProperty",r=["nonvalidProperty",u].join(":"));for(const s of[t,r])e.dispatchEvent(new de(s,Object.assign(n,{path:i}),e))}if(!n.valid)return}if(d&&"object"==typeof d&&d.delete(t),delete r[u],a&&(a.deleteProperty&&e.dispatchEvent(new pe("deleteProperty",{path:s,value:d,detail:{key:u,value:d}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",u].join(":"),n=[s,u].join(".");e.dispatchEvent(new pe(t,{path:n,value:d,detail:{value:d}},e))}}}(e,s,...n)):(1===n.length&&L(s,n[0]),r=function(e,t){const{target:n}=e;for(const[r,s]of Object.entries(n))e.delete(r,t);const{path:r}=e,{mutatorEvents:s}=t;return s&&s.delete&&e.dispatchEvent(new pe("delete",{path:r,detail:{value:e.valueOf()}},e)),e}(e,s,...n)),r}};const ge=Object.freeze({object:[{keys:["valueOf"],methodDescriptor:function(e,t){return{value:function(){return t.parse({type:"object"})}}}},{keys:["toString"],methodDescriptor:function(e,t){return{value:function(e={}){const n=void 0!==e.replacer?e.replacer:null,r=void 0!==e.space?e.space:0;return t.parse({type:"string",replacer:n,space:r})}}}},{keys:["entries","fromEntries","getOwnPropertyDescriptors","getOwnPropertyDescriptor","getOwnPropertyNames","groupBy","hasOwn","is","getPrototypeOf","isExtensible","isFrozen","isSealed","keys","preventExtensions","values"],methodDescriptor:function(e,t){return{value:Object[e].bind(null,t.valueOf())}}},{keys:["propertyIsEnumerable","hasOwnProperty"],methodDescriptor:function(e,t){return{value:()=>t.parse({type:"object"})[e]}}},{type:"mutators",keys:Object.keys(fe),methodDescriptor:function(e,t,n){return{value:fe[e].bind(null,t,n)}}}],array:[{keys:["length"],methodDescriptor:function(e,t,n){return{get:()=>t.target.length,set(e){t.target.length=e}}}},{keys:["from","fromAsync","isArray","of"],methodDescriptor:function(e,t){return{value:Array[e]}}},{keys:["at","every","filter","find","findIndex","findLast","findLastIndex","flat","flatMap","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","sort","toReversed","toSorted","toSpliced","with"],methodDescriptor:function(e,t){return{value:Array.prototype[e].bind(null,t)}}},{type:"mutators",keys:Object.keys(he),methodDescriptor:function(e,t,n){return{value:he[e].bind(null,t,n)}}}],map:[{type:"mutators",keys:Object.keys(ve),methodDescriptor:function(e,t,n){return{value:ve[e].bind(null,t,n)}}}]});const ye=Object.freeze(["push","unshift"]),be=Object.freeze(["assign","defineProperties","set"]);function je(e,t,n){const{type:r}=e,{assignObject:s,assignArray:i}=n;return"array"===r&&ye.includes(i)?e[i](...t):"object"===r&&be.includes(s)&&e[s](t),e}class me extends E{constructor(e={},t=null,n={}){super({propertyDirectory:{accessors:[(e,t)=>void 0===t?e.target:e.get(t)]}}),e instanceof me&&(e=e.valueOf());let r=null,s=null;try{Object.defineProperty(this,"mount",{value:function(e){const t=e.parent,n=e.path,i=n?n.split(".").pop():n;r&&r.unmount(i),r=t,s=n}})}catch(e){console.error(e)}try{Object.defineProperty(this,"unmount",{value:function(e){e.path;delete this[$property]}})}catch(e){console.error(e)}Object.defineProperties(this,{options:{configurable:!0,get(){const e=(e=>L({autoload:!1,autosave:!1,localStorage:!1,path:null,parent:null,enableEvents:!1,enableValidation:!0,validationEvents:{"validProperty:$key":!0,validProperty:!0,"nonvalidProperty:$key":!0,nonvalidProperty:!0},pathkey:!0,subpathError:!1,assignObject:"set",assignArray:"set",methods:{map:{get:{mutatorEvents:{get:!0,getProperty:!0,"getProperty:$key":!0}},set:{recursive:!0,mutatorEvents:{set:!0,setProperty:!0,"setProperty:$key":!0}},delete:{mutatorEvents:{delete:!0,deleteProperty:!0,"deleteProperty:$key":!0}}},array:{concat:{mutatorEvents:{"concatElement:$index":!0,concatElement:!0,concat:!0}},copyWithin:{mutatorEvents:{"copyWithinElement:$index":!0,copyWithinElement:!0,copyWithin:!0}},fill:{lengthen:!0,mutatorEvents:{"fillElement:$index":!0,fillElement:!0,fill:!0}},pop:{mutatorEvents:{pop:!0}},push:{mutatorEvents:{"pushElement:$index":!0,pushElement:!0,push:!0}},reverse:{mutatorEvents:{reverse:!0}},shift:{mutatorEvents:{shift:!0}},splice:{mutatorEvents:{"spliceDeleteElement:$index":!0,spliceDeleteElement:!0,"spliceAddElement:$index":!0,spliceAddElement:!0,splice:!0}},unshift:{mutatorEvents:{"unshiftElement:$index":!0,unshiftElement:!0,unshift:!0}}},object:{assign:{sourceTree:!0,mutatorEvents:{"assignSourceProperty:$key":!0,assignSourceProperty:!0,assignSource:!0,assign:!0}},defineProperties:{descriptorTree:!0,mutatorEvents:{defineProperties:!0}},defineProperty:{descriptorTree:!0,mutatorEvents:{defineProperty:!0,"defineProperty:$key":!0}},freeze:{recursive:!0,mutatorEvents:{freezeProperty:!0,freeze:!0}},seal:{recursive:!0,mutatorEvents:{sealProperty:!0,seal:!0}}}}},e))(n);if(e.events&&(this.addEvents(e.events),delete e.events),e.enableEvents){const t=typeof e.enableEvents;"boolean"===t?this.enableEvents():"object"===t&&this.enableEvents(e.enableEvents)}return Object.defineProperty(this,"options",{value:e}),e}},parent:{get:()=>r},path:{get:()=>s},key:{get:()=>s?s.pop():s},target:{configurable:!0,get(){const t=C(e);return Object.defineProperty(this,"target",{value:t}),t}},type:{configurable:!0,get(){const e=q(this.target);return Object.defineProperty(this,"type",{value:e}),e}},schema:{configurable:!0,get(){const e=q(t);let n;return["undefined","null"].includes(e)?n=null:t instanceof oe?n=t:["array","object"].includes(e)&&(n=new oe(t)),Object.defineProperty(this,"schema",{value:n}),n}}}),this.mount({parent:this.options.parent,path:this.options.path}),localStorage&&this.options.localStorage&&Object.defineProperties(this,{localStorage:{configurable:!0,get(){let e,t=[window.location.pathname];return this.path&&t.push(this.path),t=t.join(""),e=new W(t),Object.defineProperty(this,"localStorage",{value:e}),e}},save:{value:function(){return this.localStorage.set(this.valueOf())}},load:{value:function(){return this.localStorage.get()}},unload:{value:function(){return this.localStorage.remove()}}}),function(e){for(const[t,n]of Object.entries(ge))for(const r of n){const{keys:n,methodDescriptor:s,type:i}=r;for(const r of n)if("map"===t||"mutators"===i){const n=structuredClone(e.options.methods[t][r]),i=Object.assign({},e.options,n);delete i.mutatorEvents,i.mutatorEvents=n.mutatorEvents,Object.defineProperty(e,r,s(r,e,i))}else Object.defineProperty(e,r,s(r,e))}}(this),this.options.autoload?je(this,this.load()||e,this.options):je(this,e,this.options)}retroReenableEvents(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}parse(e={type:"object",replacer:null,space:0}){let t=C(this.type);for(const[e,n]of Object.entries(Object.getOwnPropertyDescriptors(this.target))){let{enumerable:r,value:s,writable:i,configurable:a}=n;s instanceof me?Object.defineProperty(t,e,{enumerable:r,value:s.valueOf(),writable:i,configurable:a}):Object.defineProperty(t,e,{enumerable:r,value:s,writable:i,configurable:a})}let{type:n,replacer:r,space:s}=e;return"object"===n?t:"string"===n?JSON.stringify(t,r,s):void 0}}export{me as Model,oe as Schema,G as Validation,X as Validator,F as Verification};
//# sourceMappingURL=objecture.min.js.map
