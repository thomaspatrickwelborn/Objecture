function e(e){if(Array.isArray(e)||void 0===e)return e;const t=[];for(const[n,r]of Object.entries(e)){const e=n.split(" ");let i,s,a,o;1===e.length?(i=":scope",s=e[0]):e.length>1&&(i=e[0],s=e[1]),Array.isArray(r)?(a=r[0],o=r[1]):a=r;const l={type:s,path:i,listener:a,enable:!1};t.push(l)}return t}const t={depth:0,maxDepth:10};function n(e,r){const i=[],s=Object.assign({},t,r);if(s.depth++,s.depth>s.maxDepth)return i;for(const[t,r]of Object.entries(e))if(i.push(t),"object"==typeof r&&null!==r&&r!==e){const e=n(r,s);for(const n of e){let e;e="object"==typeof n?[t,...n].join("."):[t,n].join("."),i.push(e)}}return i}const r=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function i(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=r(e[t]),a=r(s);e[t]="object"===n&&"object"===a?i(e[t],s):s}return e}const s={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null},a=Object.keys(s),o=Object.values(s),l={object:Object,array:Array},c=Object.keys(l),p=Object.values(l),h=Object.assign({},s,l),d=Object.keys(h),u=Object.values(h),f=[s.String,s.Number,s.Boolean,l.Object,l.Array];var v=Object.freeze({__proto__:null,ObjectKeys:c,ObjectValues:p,Objects:l,PrimitiveKeys:a,PrimitiveValues:o,Primitives:s,TypeKeys:d,TypeMethods:f,TypeValues:u,Types:h}),g=Object.freeze({__proto__:null,expandEvents:e,impandEvents:function(e){if(!Array.isArray(e))return e;const t={};for(const n of e){const{path:e,type:r,listener:i,options:s}=n,a=`${$path} ${$type}`;t[a]=void 0!==s?[i,s]:i}return t},isPropertyDefinition:function(e){return!!(Object.getOwnPropertyDescriptor(e,"type")&&(u.includes(e.type)||d.includes(e.type))||"object"==typeof e.type&&Object.getOwnPropertyDescriptor(e.type,"value")&&(u.includes(e.type.value)||d.includes(e.type.value)))},propertyDirectory:n,recursiveAssign:i,recursiveAssignConcat:function e(t,...n){if(!t)return t;for(const i of n)if(i)for(const[n,s]of Object.entries(i)){const i=r(t[n]),a=r(s);t[n]="object"===i&&"object"===a?e(t[n],s):"array"===i&&"array"===a?t[n].concat(s):s}return t},recursiveFreeze:function e(t){for(const[n,r]of Object.entries(t))r&&"object"==typeof r&&e(r);return Object.freeze(t)},typeOf:r,typedObjectLiteral:function(e){return"object"===r(e)?{}:"array"===r(e)?[]:"string"===r(e)?"object"===e?{}:"array"===e?[]:void 0:void 0},variables:v});function y(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var r=e.substr(0,t),i=e.substr(t+2);if(r.length>0&&i.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function b(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,r=0,i=0,s=-1,a=[""],o=[],l=0;l<e.length;l++){var c=e[l];if("\\"!==c){if("{"===c)if(n)r++;else if(l>s&&!r){t=e.substring(s+1,l);for(var p=0;p<a.length;p++)a[p]+=t;o=[],s=l,n=!0,r++}else r--;else if("}"===c)if(n)i++;else if(1===i){if(t=e.substring(s+1,l),o.length>0){var h=[];o.push(b(t));for(p=0;p<a.length;p++)for(var d=0;d<o.length;d++)for(var u=0;u<o[d].length;u++)h.push(a[p]+o[d][u]);a=h}else{t=y(t);for(p=0;p<a.length;p++)a[p]+=t}s=l,i--}else i--;else n||","!==c||i-r!=1||(t=e.substring(s+1,l),o.push(b(t)),s=l);!n||i!==r&&l!==e.length-1||(n=!1,l=s-1)}else l++}if(-1===s)return[e];var f="{"===e[s]?s:s+1;if(f<e.length){t=e.substr(f);for(p=0;p<a.length;p++)a[p]+=t}return a}function j(e,t){var n,r=!1!==t["!"],i=!1!==t["()"],s=!1;if(r){for(n=0;n<e.length&&"!"===e[n];n++){if(i&&"("===e[n+1]){n--;break}s=!s}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:s}}function m(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function P(e,t,n){var r=void 0===t.separator||t.separator,i="",s="",a=".";!0===r?(i="/",s="[/\\\\]",a="[^/\\\\]"):a=r?(s=function(e){for(var t="",n=0;n<e.length;n++)t+=m(e[n]);return t}(i=r)).length>1?"((?!"+(s="(?:"+s+")")+").)":"[^"+s+"]":".";var o=r?s+"+?":"",l=r?s+"*?":"",c=r?e.split(i):[e];return{source:e,segments:c,options:t,separator:r,separatorSplitter:i,separatorMatcher:s,optionalSeparator:l,requiredSeparator:o,wildcard:a,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:r&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function E(e,t,n,r){return{source:e,isFirst:n,isLast:r,end:e.length-1}}var O="(?!\\.)";function x(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=O+t),e.dotHandled=!0,e.result.match+=t),e.result}function w(e,t,n){var r=e.support,i=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),s=t.isLast?e.optionalSeparator:e.requiredSeparator;if(r.excludeDot||(i.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:x(i,s);if(r.globstar&&"**"===t.source)return x(i,"(?:"+((i.dotHandled?"":O)+e.wildcard+"*?"+s)+")*?");for(;++i.i<=t.end;){if(i.char=i.segment.source[i.i],i.nextChar=i.i<t.end?t.source[i.i+1]:"","\\"===i.char){if(i.i<i.segment.end){i.escapeChar=!0;continue}i.char=""}e=i.pattern,t=i.segment;var a=i.char,o=i.i;if(e.support.brackets&&!i.scanningForParens){if(o>i.openingBracket&&o<=i.closingBracket){i.escapeChar?x(i,m(a)):o===i.closingBracket?(x(i,"]"),i.openingBracket=t.source.length):"-"===a&&o===i.closingBracket-1?x(i,"\\-"):"!"===a&&o===i.openingBracket+1?x(i,"^"):x(i,"]"===a?"\\]":a),i.escapeChar=!1;continue}if(o>i.openingBracket){"]"===a&&!i.escapeChar&&o>i.openingBracket+1&&o>i.closingBracket?(i.closingBracket=o,i.i=i.openingBracket,e.separator?x(i,"(?!"+e.separatorMatcher+")[",!0):x(i,"[",!0)):o===t.end&&(x(i,"\\["),i.i=i.openingBracket,i.openingBracket=t.source.length,i.closingBracket=t.source.length),i.escapeChar=!1;continue}if("["===a&&!i.escapeChar&&o>i.closingBracket&&o<t.end){i.openingBracket=o,i.escapeChar=!1;continue}}if(i.pattern.support.extglobs){var l=i.extglobModifiers,c=(a=i.char,i.nextChar);o=i.i;if("("!==c||i.escapeChar||"@"!==a&&"?"!==a&&"*"!==a&&"+"!==a&&"!"!==a){if(")"!==a||i.escapeChar){if("|"===a&&i.closingParens&&!i.scanningForParens&&!i.escapeChar){x(i,"|");continue}}else if(i.scanningForParens)i.closingParens++;else if(l.length){var p=l.pop();if("!"===p&&-1!==l.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");x(i,")"+(p="!"===p||"@"===p?"":p)),i.addToMatch=!0,i.addToUnmatch=!0,i.closingParens--;continue}}else if(i.scanningForParens)i.openingParens++;else if(o>i.parensHandledUntil&&!i.closingParens)i.parensHandledUntil=o,i.scanningForParens=!0,i.openingParens++;else{if(i.closingParens>=i.openingParens){"!"===a&&(i.addToMatch=!0,i.addToUnmatch=!1,x(i,i.pattern.wildcard+"*?",!0),i.addToMatch=!1,i.addToUnmatch=!0,i.result.useUnmatch=!0),l.push(a),x(i,"(?:",!0),i.openingParens--,i.i++;continue}i.openingParens--}if(i.scanningForParens){i.closingParens!==i.openingParens&&o!==i.segment.end||(i.scanningForParens=!1,i.i=i.parensHandledUntil-1),i.escapeChar=!1;continue}}r=(e=i.pattern).support;!i.escapeChar&&r.star&&"*"===i.char?i.i!==i.segment.end&&"*"===i.nextChar||x(i,e.wildcard+"*?",!0):!i.escapeChar&&r.qMark&&"?"===i.char?x(i,e.wildcard,!0):x(i,m(i.char)),i.escapeChar=!1}return x(i,s)}function k(e,t,n){for(var r=P(e,t,n),i={match:"",unmatch:"",useUnmatch:!1},s=r.segments,a=0;a<s.length;a++){w(r,E(s[a],0,0===a,a===s.length-1),i)}return i.useUnmatch?"(?!^"+i.unmatch+"$)"+i.match:i.match}function S(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function A(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],r=0;r<e.length;r++)for(var i=t(e[r]),s=0;s<i.length;s++)n.push(i[s]);return n}(e,b));for(var n=[],r=[],i="",s=0;s<e.length;s++){var a=j(e[s],t),o=k(a.pattern,t,!a.isNegated);a.isNegated?r.push(o):n.push(o)}return r.length&&(i="(?!(?:"+r.join("|")+")$)"),n.length>1?i+="(?:"+n.join("|")+")":1===n.length?i+=n[0]:i.length&&(i+=k("**",t,!0)),"^"+i+"$"}(e,t),r=new RegExp(n,t.flags),i=S.bind(null,r);return i.options=t,i.pattern=e,i.regexp=r,i}class ${#e;#t;#n;#r=!1;#i;#s=[];#a=[];#o=[];#l;#c;#p;constructor(e,t){if(!e||!t)return this;this.#e=((e={})=>{const t={propertyDirectory:{maxDepth:10},enable:!1,accessors:[(e,t)=>e[t]],assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent",bindListener:!0,methods:{assign:{addEventListener:function(e,t){const{type:n,listener:r,settings:i}=e,{options:s,useCapture:a}=i;return t.addEventListener(n,r,s||a)},on:function(e,t){const{type:n,listener:r}=e;return t.on(n,r)},once:function(e,t){const{type:n,listener:r}=e;return t.once(n,r)}},deassign:{removeEventListener:function(e,t){const{type:n,listener:r,settings:i}=e,{options:s,useCapture:a}=i;return t.removeEventListener(n,r,s||a)},off:function(e,t){const{type:n,listener:r}=e;return t.off(n,r)}},transsign:{dispatchEvent:function(e,t,n){return t.dispatchEvent(n)},emit:function(e,t,n,...r){return t.emit(n,...r)}}}};for(const[n,r]of Object.entries(e))switch(n){case"propertyDirectory":t[n]=Object.assign(t[n],r);break;case"accessors":t[n]=t[n].concat(r);break;case"methods":t[n]=i(t[n],r);break;case"enableEvents":break;default:t[n]=r}return t})(e),this.#t=t,this.enable=this.settings.enable}get settings(){return this.#e}get path(){return this.settings.path}get type(){return this.settings.type}get listener(){if(void 0!==this.#n)return this.#n;const e=this.settings.listener;return!0===this.settings.bindListener?this.#n=e.bind(this.#t):this.#n=e,this.#n}get enable(){return this.#r}set enable(e){if(![!0,!1].includes(e))return;const t=this.#h;if(0===t.length)return;const n=this.#s,r=this.#a;n.length=0,r.length=0;for(const i of t){const{path:t,target:s,enable:a}=i;this.settings;if(a!==e)if(!0===e)try{this.#d(s),i.enable=e,n.push(i)}catch(e){throw e}else if(!1===e)try{this.#u(s),i.enable=e,r.push(i)}catch(e){n.push(i)}}!0===e&&0===r.length&&n.length>0||!1===e&&0===n.length&&r.length>0||0===r.length&&0===n.length?this.#r=e:r.length>0&&n.length>0&&(this.#r=null)}get enabled(){return this.#s}get disabled(){return this.#a}get#f(){return this.settings.target}get#h(){const e=this.#o;let t=this.#v;const n=[],i=[];if(":scope"===this.path){const t=e.find((e=>e?.path===this.path));void 0!==t?i.push(t):void 0===t&&i.push({path:this.path,target:this.#t,enable:!1})}else if(void 0!==this.#f)for(const t of[].concat(this.#f)){const n=e.find((e=>e?.path===this.path));void 0!==n?i.push(n):void 0===n&&i.push({path:this.path,target:t,enable:!1})}else if("string"===r(this.path)){const r=A(this.path,{separator:"."});for(const e of t){!0===r(e)&&n.push(e)}for(const t of n){const n=e.find((e=>e?.path===t));let r,s=this.#t;const a=t.split(".");let o=0;for(;o<a.length;){let e=a[o];e:for(const t of this.settings.accessors){if(void 0===s)break e;if(s=t(s,e),void 0!==s)break e}o++}void 0!==s&&(r=s===n?.target?n:{path:t,target:s,enable:!1}),void 0!==r&&i.push(r)}}return this.#o=i,this.#o}get#d(){return void 0!==this.#l||(this.#l=this.settings.methods.assign[this.settings.assign].bind(null,this)),this.#l}get#u(){return void 0!==this.#c||(this.#c=this.settings.methods.deassign[this.settings.deassign].bind(null,this)),this.#c}get#g(){return void 0!==this.#p||(this.#p=this.settings.methods.transsign[this.settings.transsign].bind(null,this)),this.#p}get#y(){return this.settings.methods}get#v(){return n(this.#t,this.settings.propertyDirectory)}emit(){const e=this.#h;for(const t of e){const{target:e}=t;this.#g(e,...arguments)}return this}}class V extends EventTarget{static implement=function(t,n){if(!t||!n)return;const r=((e={})=>{const t={events:{},enableEvents:!1,propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents"}};for(const[n,r]of Object.entries(e))t[n]="propertyDefinitions"===n?Object.assign(t[n],r):r;return t})(n),i=[];return Object.defineProperties(t,{[r.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(0===arguments.length)return i;const e=[],t=[].concat(arguments[0]);for(const n of t)for(const t of i){let r;e:for(const[e,i]of Object.entries(n)){let n;if(n="listener"===e?t.settings[e]===i:t[e]===i,!1===r)break e;r=n}!0===r&&e.push(t)}return e}},[r.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments.length)return t;let n=e(arguments[0]);for(let e of n){const n=Object.assign({},r,e),s=new $(n,t);i.push(s)}return t}},[r.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){let e;if(0===arguments.length?e=t[r.propertyDefinitions.getEvents]():1===arguments.length&&(e=t[r.propertyDefinitions.getEvents](arguments[0])),0===e.length)return t;let n=i.length-1;for(;n>-1;){const t=i[n];e.includes(t)&&(t.enable=!1,i.splice(n,1)),n--}return t}},[r.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){let e;e=0===arguments.length?i:t[r.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!0;return t}},[r.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){let e;e=0===arguments.length?i:t[r.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!1;return t}},[r.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){return t[r.propertyDefinitions.disableEvents](arguments[0]),t[r.propertyDefinitions.enableEvents](arguments[0]),t}}}),r.events&&t[r.propertyDefinitions.addEvents](r.events),!0===r.enableEvents?t[r.propertyDefinitions.enableEvents]():"object"==typeof r.enableEvents&&t[r.propertyDefinitions.enableEvents](r.enableEvents),t};constructor(e={}){return super(),V.implement(this,e)}}class D extends EventTarget{#e;#b;#j;constructor(e){super(),this.#e=e}get type(){return this.#e.type}get definition(){return this.#e.definition}get key(){return this.#e.key}get value(){return this.#e.value}get message(){return void 0!==this.#b||void 0!==this.pass&&void 0===this.#b&&(this.#b=this.#e.messages[String(this.pass)](this)),this.#b}get pass(){return this.#j}set pass(e){void 0===this.#j&&(this.#j=e)}}const{recursiveAssign:_}=g,T={true:e=>`${e.pass}`,false:e=>`${e.pass}`};class q extends EventTarget{#m;#P;#E;constructor(e={},t){super(),this.definition=Object.freeze(Object.assign({messages:T},e)),this.schema=t}get definition(){return this.#P}set definition(e){this.#P=e}get schema(){return this.#E}set schema(e){return void 0!==this.#E||(this.#E=e),this.#E}get type(){return this.definition.type}get messages(){return this.definition.messages}get validate(){return this.#m=function(e,t,n,r){const i=this.definition,s=new D({type:this.type,definition:i,key:e,value:t,messages:_({},this.messages,i.messages)});return s.pass=i.validate(...arguments),s}.bind(this),this.#m}}const{recursiveAssign:I,typedObjectLiteral:L}=g;class M extends q{constructor(e,t){super(Object.assign(e,{type:"required",validate:(e,t,n,r)=>{this.definition;let i;const{requiredProperties:s,requiredPropertiesSize:a,type:o}=this.schema;if(0===a)i=!0;else if("object"===o){const t=L(o),a=L(o);e:for(const[i,o]of Object.entries(s)){const s=I({},o);if(s.required.value=!1,i===e)continue e;const l=Object.getOwnPropertyDescriptor(n,i);if(void 0!==l)t[i]=s,a[i]=l.value;else if(r){if(void 0!==Object.getOwnPropertyDescriptor(r,i))continue e;t[i]=s}else t[i]=s}const l=Object.keys(t).length,c=Object.keys(a).length;if(0===l&&0===c)i=!0;else if(l!==c)i=!1;else{const e=new ie(t,Object.assign({},this.schema.options,{required:!1})),s=[];for(const[t,i]of Object.entries(a)){const i=a[t],o=e.validateProperty(t,i,n,r);s.push(o)}i=!s.find((e=>!1===e.valid))}}else"array"===o&&(i=!0);return i}}),t)}}const{typeOf:C,variables:B}=g,{PrimitiveKeys:z,PrimitiveValues:N}=B;class F extends q{constructor(e={},t){super(Object.assign(e,{type:"type",validate:(e,t)=>{const n=this.definition;let r,i=C(n.value);i="function"===i?C(n.value()):i;const s=C(t);return r="undefined"!==s&&("undefined"===i||i===s),r}}),t)}}class U extends q{constructor(e={},t){super(Object.assign(e,{type:"range",validate:(e,t)=>{const n=this.definition;let r;if("number"!=typeof t)r=!1;else{const{min:e,max:i}=n;let s,a;s=void 0===e||t>=e.value,a=void 0===i||t<=i.value,r=!(!s||!a)}return r}}),t)}}class W extends q{constructor(e={},t){super(Object.assign(e,{type:"length",validate:(e,t)=>{const n=this.definition;let r;if("string"!=typeof t)r=!1;else{const{min:e,max:i}=n;let s,a;s=void 0===e||t.length>=e.value,a=void 0===i||t.length<=i.value,r=!(!s||!a)}return r}}),t)}}class H extends q{constructor(e={},t){super(Object.assign(e,{type:"enum",validate:(e,t)=>{const n=this.definition;let r;if(["string","number","boolean"].includes(typeof t)){r=n.value.includes(t)}else r=!1;return r}}),t)}}class K extends q{constructor(e={},t){super(Object.assign(e,{type:"match",validate:(e,t)=>{const n=this.settings;let r;if(["string","number","boolean"].includes(typeof t)){n.value.exec(t)}else r=!1;return!!r}}),t)}}class R{#t;constructor(e){this.#t=e}}const{expandTree:J,isPropertyDefinition:G,typedObjectLiteral:Q,typeOf:X,variables:Y}=g;class Z extends EventTarget{#O;#E;#x;#w;#f;#k;constructor(e,t){return super(),this.#O=e,this.schema=t,this.proxy}get required(){return this.schema.options.required}get schema(){return this.#E}set schema(e){if(void 0===this.#E)return this.#E=e,this.#E}get type(){return void 0!==this.#x||(this.#x=X(Q(this.#O))),this.#x}get proxy(){return void 0!==this.#w||(this.#w=new Proxy(this.target,this.#S)),this.#w}get#S(){return void 0!==this.#k||(this.#k=new R(this)),this.#k}get target(){if(void 0!==this.#f)return this.#f;let e;const t=Q(this.type);"array"===this.type?e=this.#O.slice(0,1):"object"===this.type&&(e=this.#O);for(const[n,r]of Object.entries(e)){const e=X(r);let i;if(r instanceof ie)i=r;else if(Variables.TypeValues.includes(r))i=J(r,"type.value");else if(Variables.TypeKeys.includes(r))i=J(Variables.TypeValues[Variables.TypeKeys.indexOf(r)],"type.value");else if("object"===e||"array"===e){let e=G(r);if(!1===e){const{path:e}=this.schema,t=e?[e,n].join("."):String(n),s=this.schema;i=new ie(r,Object.assign({},this.schema.options,{path:t,parent:s}))}else if(!0===e){i={validators:[]};e:for(const[e,t]of Object.entries(r)){if("validators"===e)continue e;const n=X(t);let r;r=n&&"object"===n?t:{value:t},i[e]=r}r.validators=r.validators||[];for(const e of r.validators)for(const t of[M,F,U,W,H,K])e instanceof t==!1&&i.validators.push(e)}}i instanceof ie==!1&&(i=this.#A(i)),t[n]=i}return this.#f=t,this.#f}#A(e){const t=e;t.validators=[];const n=new Map,r=this.required,{required:i,type:s,range:a,min:o,max:l,length:c,minLength:p,maxLength:h,match:d}=t;!0===r||!0===i?.value?n.set("required",Object.assign({},t.required,{type:"required",value:!0,validator:M})):n.set("required",Object.assign({},t.required,{type:"required",value:!1,validator:M})),s?n.set("type",Object.assign({},s,{type:"type",validator:F})):n.set("type",Object.assign({},s,{type:"type",value:void 0,validator:F})),a?n.set("range",Object.assign({},a,{type:"range",validator:U})):(o||l)&&n.set("range",Object.assign({},{type:"range",min:o,max:l,validator:U})),c?n.set("length",Object.assign({},c,{type:"length",validator:W})):(p||h)&&n.set("length",Object.assign({},{type:"length",min:p,max:h,validator:W})),t.enum&&n.set("enum",Object.assign({},t.enum,{type:"enum",validator:H})),d&&n.set("match",Object.assign({},d,{type:"match",validator:K})),delete t.min,delete t.max,delete t.minLength,delete t.maxLength;for(const[e,r]of n.entries()){const n=r.validator;t[e]=r,t.validators.push(new n(r,this.schema))}return t}}const ee={true:e=>`${e.valid}`,false:e=>`${e.valid}`};class te extends EventTarget{#e;#O;#$;#V=[];#D=[];#_=[];constructor(e={}){super(),this.#e=Object.assign({messages:ee},e)}get definition(){return this.#e.definition}get path(){return this.#e.path}get key(){return this.#e.key}get value(){return this.#e.value}get properties(){return void 0!==this.#O||(this.#O=this.#e.properties),this.#O}get advance(){return this.#V}get deadvance(){return this.#D}get unadvance(){return this.#_}get valid(){return this.#$}set valid(e){void 0===this.#$&&(this.#$=e)}}const{typedObjectLiteral:ne,typeOf:re}=g;class ie extends EventTarget{#O;options;#x;#t;#T;#q;#i;#I;#L;constructor(e={},t={}){super(),this.#O=e,this.options=((...e)=>Object.assign({required:!1,verificationType:"all"},...e))(t)}get type(){return void 0!==this.#x||(this.#x=re(this.#O)),this.#x}get parent(){return void 0!==this.#T||(this.#T=this.options.parent?this.options.parent:null),this.#T}get root(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}get key(){return void 0!==this.#q||(this.path?this.#q=this.path.split(".").pop():this.#q=null),this.#q}get path(){return void 0!==this.#i||(this.#i=this.options.path?String(this.options.path):null),this.#i}get required(){return this.options.required}get requiredProperties(){if(void 0!==this.#I)return this.#I;let e=ne(this.type);for(const[t,n]of Object.entries(this.context))!0===n.required?.value&&(e[t]=n);return this.#I=e,this.#I}get requiredPropertiesSize(){return void 0!==this.#L||(this.#L=Object.keys(this.requiredProperties).length),this.#L}get verificationType(){return this.options.verificationType}get context(){return void 0!==this.#t||(this.#t=new Z(this.#O,this)),this.#t}#M(){let e,t,n,r=[...arguments];return 1===r.length?(e=null,t=r.shift(),n=null):2===r.length&&"string"==typeof r[0]?(e=r.shift(),t=r.shift(),n=null):2===r.length&&"object"==typeof r[0]?(e=null,t=r.shift(),n=r.shift()):3===r.length&&"string"==typeof r[0]&&(e=r.shift(),t=r.shift(),n=r.shift()),{$sourceName:e,$source:t,$target:n}}validate(){const{$sourceName:e,$source:t,$target:n}=this.#M(...arguments),r=new te({definition:this.context,path:this.path,key:e,value:t,properties:ne(this.type)}),i=Object.entries(t);let s=0,a=[];for(;s<i.length;){const[e,o]=i[s],l=this.validateProperty(e,o,t,n),c=l.deadvance.filter((e=>"required"===e.type));r.properties[e]=l,!0===l.valid?r.advance.push(l):!1===l.valid?r.deadvance.push(l):void 0===l.valid&&r.unadvance.push(l),a=a.concat(c),s++}return!0===this.required?r.deadvance.length?r.valid=!1:r.advance.length?r.valid=!0:r.unadvance.length?r.valid=void 0:r.valid=!1:!1===this.required&&(a.length?r.valid=!1:r.advance.length?r.valid=!0:r.deadvance.length?r.valid=!1:r.unadvance.length?r.valid=void 0:r.valid=!1),r}#C(){let e=[...arguments],[t,n,r,i]=e;r=r instanceof Se?r.valueOf():r;return i=i instanceof Se?i.valueOf():i,{$key:t,$value:n,$source:r,$target:i}}validateProperty(){const{$key:e,$value:t,$source:n,$target:r}=this.#C(...arguments);let i;"array"===this.type?i=this.context[0]:"object"===this.type&&(i=this.context[e]);const{path:s}=this,a=s?[s,e].join("."):e,o=new te({definition:i,path:a,key:e,value:t});if(void 0===i){const n=new D({type:null,definition:null,key:e,value:t},this);n.pass=!1,o.unadvance.push(n)}else if(i instanceof ie){let n;n=r&&r[e]?i.validate(e,t,r[e]):i.validate(e,t),!0===n.valid?o.advance.push(n):!1===n.valid?o.deadvance.push(n):void 0===n.valid&&o.unadvance.push(n)}else e:for(const[s,a]of Object.entries(i.validators)){const i=a.validate(e,t,n,r);if(!0===i.pass?o.advance.push(i):!1===i.pass?o.deadvance.push(i):void 0===i.pass&&o.unadvance.push(i),"one"===this.verificationType&&o.deadvance.length)break e}return o.deadvance.length?o.valid=!1:o.advance.length?o.valid=!0:o.unadvance.length&&(o.valid=!1),o}}const{recursiveAssign:se}=g;class ae extends CustomEvent{#e;#B;#q;constructor(e,t,n){if(super(e,t),this.#e=t,this.#B=n,!this.content.parent)return this;this.content.addEventListener(e,(e=>{const{path:t,value:n,detail:r,change:i}=e;this.content.parent.dispatchEvent(new ae(this.type,{path:t,value:n,detail:r,change:i},this.content.parent))}),{once:!0})}get content(){return this.#B}get key(){return void 0!==this.#q||(this.path?this.#q=this.path.split(".").pop():this.#q=null),this.#q}get change(){return this.#e.change}get value(){return this.#e.value}get path(){return this.#e.path}get detail(){return this.#e.detail}}class oe{#z=!1;#N=!1;#F=!1;#U=!1;#W;#H;#K;#R;constructor(e={}){for(const[t,n]of Object.entries(e))this[t]=n}get preter(){return this.#H}set preter(e){if(!0===this.#N)return this.#H;this.#H=e instanceof Se?e.valueOf():e,this.#N=!0}get anter(){return this.#K}set anter(e){if(!0===this.#F)return this.#K;this.#K=e instanceof Se?e.valueOf():e,this.#F=!0}get conter(){if(!0===this.#U||[this.#N,this.#F].includes(!1))return this.#R;const e=JSON.stringify(this.preter),t=JSON.stringify(this.anter);let n;return console.log("preter",e),console.log("anter",t),n=t!==e,this.#R=n,this.#U=!0,this.#R}}let le=class e extends CustomEvent{#e;#B;#q;#i;#J;#$;constructor(t,n,r){super(t),this.#e=n,this.#B=r,this.#B.addEventListener(t,(t=>{null!==this.#B.parent&&this.#B.parent.dispatchEvent(new e(this.type,{key:t.key,path:t.path,detail:t.detail},this.#B.parent))}),{once:!0})}get key(){return void 0!==this.#q||(this.#q=this.#e.key),this.#q}get path(){return void 0!==this.#i||(this.#i=this.#e.path),this.#i}get value(){return void 0!==this.#J||(this.#J=this.#e.value),this.#J}get valid(){return void 0!==this.#$||(this.#$=this.#e.valid),this.#$}};const{recursiveAssign:ce,typedObjectLiteral:pe}=g;const{impandTree:he,typedObjectLiteral:de}=g;const{typedObjectLiteral:ue}=g;var fe={assign:function(e,t,...n){const{path:r,target:i,schema:s}=e,{events:a,sourceTree:o,enableValidation:l,validationEvents:c}=t,p=[],h=new oe({preter:e});for(let t of n){let n;const h=new oe({preter:e});Array.isArray(t)?n=[]:"object"==typeof t&&(n={});e:for(let[p,h]of Object.entries(t)){const d=new oe({preter:i[p]}),u=new oe({preter:i[p]});if(s&&l){const n=s.validateProperty(p,h,t,e);if(c){let t,i;r?[r,p].join("."):String(p);n.valid?(t="validProperty",i=["validProperty",p].join(":")):(t="nonvalidProperty",i=["nonvalidProperty",p].join(":"));for(const r of[t,i])e.dispatchEvent(new le(r,n,e))}if(!n.valid)continue e}let f,v;if(h&&"object"==typeof h){let t;h instanceof Se&&(f=h.valueOf()),t="array"===s?.type?s.context[0]:"object"===s?.type?s.context[p]:null;const n=r?[r,p].join("."):String(p);let a=pe(h);!1===o?(f=new Se(a,t,ce({},e.options,{path:n,parent:e})),f.assign(h),v={[p]:f}):(i[p]instanceof Se?i[p].assign(h):(f=new Se(a,t,ce({},e.options,{path:n,parent:e})),f.assign(h)),v={[p]:f})}else v={[p]:h};if(Object.assign(i,v),Object.assign(n,v),a){const t=r?[r,p].join("."):String(p);if(a["assignSourceProperty:$key"]){const r=["assignSourceProperty",p].join(":");u.anter=i[p],e.dispatchEvent(new ae(r,{path:t,value:f,change:u,detail:{source:n}},e))}a.assignSourceProperty&&(d.anter=i[p],e.dispatchEvent(new ae("assignSourceProperty",{path:t,value:f,change:d,detail:{source:n}},e)))}}p.push(n),a&&a.assignSource&&(h.anter=e,e.dispatchEvent(new ae("assignSource",{path:r,change:h,detail:{source:n}},e)))}return a&&a.assign&&(h.anter=e,e.dispatchEvent(new ae("assign",{path:r,change:h,detail:{sources:p}},e))),e},defineProperties:function(e,t,n){const{events:r}=t,{path:i}=e,s=Object.entries(n),a=he(n,"value");de(e.valueOf());const o=new oe({preter:e});for(const[t,n]of s)e.defineProperty(t,n,a);return r&&r.defineProperties&&(o.anter=e,e.dispatchEvent(new ae("defineProperties",{path:i,value:e.valueOf(),detail:{descriptors:n}},e))),e},defineProperty:function(e,t,n,r){const{descriptorTree:i,events:s}=t,{target:a,path:o,schema:l}=e,{enableValidation:c,validationEvents:p}=t,h=r.value,d=(Object.getOwnPropertyDescriptor(a,n)||{}).value,u=new oe({preter:d}),f=new oe({preter:d}),v=d instanceof Se;if(l&&c){const t=l.validateProperty(n,h,e);if(p){let r,i;o?[o,n].join("."):String(n);t.valid?(r="validProperty",i=["validProperty",n].join(":")):(r="nonvalidProperty",i=["nonvalidProperty",n].join(":"));for(const n of[r,i])e.dispatchEvent(new le(n,t,e))}if(!t.valid)return e}if("object"==typeof h){let t;t="array"===l.type?l.context[0]:"object"===l.type?l.context[n]:void 0;const s=o?[o,n].join("."):String(n);if(v)!0===i?d.defineProperties(h):Object.defineProperty(a,n,r);else{let o=ue(h);const l=new Se(o,t,{path:s,parent:e});!0===i?(l.defineProperties(h),a[n]=l):!1===i&&Object.defineProperty(a,n,r)}}else Object.defineProperty(a,n,r);if(s){const t=o?[o,n].join("."):String(n);if(s["defineProperty:$key"]){f.anter=a[$sourceKey];const i=["defineProperty",n].join(":");e.dispatchEvent(new ae(i,{path:t,value:h,change:f,detail:{prop:n,descriptor:r}},e))}s.defineProperty&&(u.anter=a[$sourceKey],e.dispatchEvent(new ae("defineProperty",{path:t,value:h,change:u,detail:{prop:n,descriptor:r}},e)))}return e},freeze:function(e,t){const{recursive:n,events:r}=t,{target:i,path:s}=e;if(!0===n)for(const[t,n]of Object.entries(i))n instanceof Se?n.freeze():Object.freeze(n),r&&r.freeze&&e.dispatchEvent(new ae("freeze",{path:s},e));return Object.freeze(i),e},seal:function(e,t){const{recursive:n,events:r}=t,{target:i,path:s}=e;if(!0===n)for(const[t,n]of Object.entries(i))n instanceof Se?n.seal():Object.seal(n),r&&r.seal&&e.dispatchEvent(new ae("seal",{path:s},e));return Object.seal(i),e}};var ve={concat:function(e,t){const{target:n,path:r,schema:i}=e,{enableValidation:s,validationEvents:a,events:o}=t,l=[...arguments].reduce(((e,t)=>(Array.isArray(t)?e.push(...t):e.push(t),e)),[]);let c=n.length;const p=[];let h,d=[...Array.from(n)];e:for(const t of l){if(i&&s){const t=i.validateProperty(c,$subvalue,{},e);if(i&&a){let n,i;r?[r,c].join("."):String(c);t.valid?(n="validProperty",i=["validProperty",":",c].join("")):(n="nonvalidProperty",i=["nonvalidProperty",":",c].join(""));for(const r of[n,i])e.dispatchEvent(new ValidatorEvent(r,t,e))}if(!t.valid){c++;continue e}}const n=r?[r,c].join("."):String(c);if("object"==typeof t){t instanceof Se&&(t=t.valueOf());let r=i?.context[0]||null;const s=new Se(t,r,{path:n,parent:e});p[c]=s}else p[c]=t;if(d=Array.prototype.concat.call(d,p[c]),o){const t=r?[r,c].join("."):String(c);if(o.concatValue&&e.dispatchEvent(new ae("concatValue",{path:t,value:p[c],detail:{valueIndex:c,value:p[c]}},e)),o["concatValue:$index"]){["concatValue",":",c].join("");e.dispatchEvent(new ae("concatValue",{path:t,value:p[c],detail:{valueIndex:c,value:p[c]}},e))}}c++}return h=new Se(d,i,e.options),o&&o.concat&&e.dispatchEvent(new ae("concat",{path:r,detail:{values:h}},e)),h},copyWithin:function(e,t){const{target:n,path:r}=e,{enableValidation:i,validationEvents:s,events:a}=t,o=arguments[0]>=0?arguments[0]:n.length=arguments[0],l=arguments[1]>=0?arguments[1]:n.length+arguments[1],c=void 0===arguments[2]?n.length:arguments[2]>=0?arguments[2]:n.length+arguments[2],p=[];let h=l,d=o;for(;h<c;){const t=n[h];if(p.push(t),Array.prototype.copyWithin.call(n,d,h,h+1),a){const n=r?[r,h].join("."):String(h);if(a.copyWithinIndex&&e.dispatchEvent(new ae("copyWithinIndex",{path:n,value:t,detail:{target:d,start:h,end:h+1,item:t}},e)),a["copyWithinIndex:$index"]){const r=["copyWithinIndex",":",h].join("");e.dispatchEvent(new ae(r,{path:n,value:t,detail:{target:d,start:h,end:h+1,item:t}},e))}}h++,d++}return a&&a.copyWithin&&e.dispatchEvent(new ae("copyWithin",{path:r,detail:{target:o,start:l,end:c,items:p}},e)),e},fill:function(e,t){const{target:n,path:r,schema:i}=e,{enableValidation:s,validationEvents:a,events:o}=t,l=[...arguments];let c,p;c="number"==typeof l[1]?l[1]>=0?l[1]:n.length+l[1]:0,p="number"==typeof l[2]?l[2]>=0?l[2]:n.length+l[2]:n.length;let h=c;e:for(;h<n.length&&h<p;){if(i&&s){let t=i.validate(t);if(a){let n,i;r?[r,h].join("."):String(h);t.valid?(n="validProperty",i=["validProperty",":",h].join("")):(n="nonvalidProperty",i=["nonvalidProperty",":",h].join(""));for(const r of[n,i])e.dispatchEvent(new ValidatorEvent(r,t,e))}if(!t.valid)continue e}const t=r?[r,h].join("."):String(h);let c=l[0];if("object"==typeof c){c instanceof Se&&(c=c.valueOf());const n=i?.context[0]||null;c=new Se(c,n,{path:t,parent:e})}if(Array.prototype.fill.call(n,c,h,h+1),o){const t=r?[r,h].join("."):String(h);if(o.fillIndex&&e.dispatchEvent(new ae("fillIndex",{path:t,value:c,detail:{start:h,end:h+1,value:c}},e)),o["fillIndex:$index"]){const n=["fillIndex",":",h].join("");e.dispatchEvent(new ae(n,{path:t,detail:{start:h,end:h+1,value:c}},e))}}h++}return o&&o.fill&&e.dispatchEvent(new ae("fill",{path:r,detail:{start:c,end:p,value:value}},e)),e},pop:function(e,t){const{events:n}=t,{target:r,path:i}=e,s=Array.prototype.pop.call(r),a=r.length-1;if(n&&n.pop){const t=i?[i,a].join("."):String(a);e.dispatchEvent(new ae("pop",{path:t,value:s,detail:{elementIndex:a,element:s}},e))}return s},push:function(e,t,...n){const{events:r}=t,{target:i,path:s,schema:a}=e,{enableValidation:o,validationEvents:l}=e.options,c=[];let p=0;for(let t of n){if(a&&o){const n=a.validateProperty(p,t,{},e);if(l){let t,r;s?[s,p].join("."):String(p);n.valid?(t="validProperty",r=["validProperty",":",p].join("")):(t="nonvalidProperty",r=["nonvalidProperty",":",p].join(""));for(const i of[t,r])e.dispatchEvent(new ValidatorEvent(i,n,e))}if(!n.valid)return i.length}const n=s?[s,p].join("."):String(p);if("object"==typeof t){t instanceof Se&&(t=t.valueOf());const r=a?.context[0]||null;t=new Se(t,r,{path:n,parent:e}),c.push(t),Array.prototype.push.call(i,t)}else c.push(t),Array.prototype.push.call(i,t);if(r){const t=s?[s,".",p].join(""):String(p);if(r.pushProp&&e.dispatchEvent(new ae("pushProp",{path:t,value:c[p],detail:{elementsIndex:p,element:c[p]}},e)),r["pushProp:$index"]){const n=["pushProp",":",p].join("");e.dispatchEvent(new ae(n,{path:t,value:c[p],detail:{elementsIndex:p,element:c[p]}},e))}}p++}return r&&r.push&&e.dispatchEvent(new ae("push",{path:s,detail:{elements:c}},e)),i.length},reverse:function(e,t){const{events:n}=t,{target:r,path:i}=e;return Array.prototype.reverse.call(r,...arguments),n&&n.reverse&&e.dispatchEvent(new ae("reverse",{path:i,detail:{reference:r}},e)),e},shift:function(e,t){const{events:n}=t,{target:r,path:i}=e,s=Array.prototype.shift.call(r),a=0;if(n&&n.shift){const t=i?[i,a].join("."):String(a);e.dispatchEvent(new ae("shift",{path:t,value:s,detail:{elementIndex:a,element:s}},e))}return s},splice:function(e,t){const{events:n}=t,{target:r,path:i,schema:s}=e,{enableValidation:a,validationEvents:o}=t,l=[...arguments],c=l[0]>=0?l[0]:r.length+l[0],p=l[1]<=0?0:void 0===l[1]||c+l[1]>=r.length?r.length-c:l[1],h=l.slice(2),d=h.length,u=[];let f=0;for(;f<p;){const t=Array.prototype.splice.call(r,c,1)[0];if(u.push(t),n){const r=i?[i,f].join("."):String(f);if(n.spliceDelete&&e.dispatchEvent(new ae("spliceDelete",{path:r,value:t,detail:{index:c+f,deleteIndex:f,deleteItem:t}},e)),n["spliceDelete:$index"]){const n=["spliceDelete",":",f].join("");e.dispatchEvent(new ae(n,{path:r,value:t,detail:{index:c+f,deleteIndex:f,deleteItem:t}},e))}}f++}let v=0;e:for(;v<d;){let t=h[v];if(s&&a){const t=s.validateProperty(elementIndex,element,{},e);if(o){let n,r;i?[i,v].join("."):String(v);t.valid?(n="validProperty",r=["validProperty",":",v].join("")):(n="nonvalidProperty",r=["nonvalidProperty",":",v].join(""));for(const i of[n,r])e.dispatchEvent(new ValidatorEvent(i,t,e))}if(!t.valid){v++;continue e}}const l=i?[i,v].join("."):String(v);let p=c+v;if("object"==typeof t){t instanceof Se&&(t=t.valueOf());const n=s?.context[0]||null;t=new Se(t,n,{path:l,parent:e}),Array.prototype.splice.call(r,p,0,t)}else Array.prototype.splice.call(r,p,0,t);if(n){const r=i?[i,v].join("."):String(v);if(n.spliceAdd&&e.dispatchEvent(new ae("spliceAdd",{path:r,value:t,detail:{index:c+v,addIndex:v,addItem:t}},e)),n["spliceAdd:$index"]){const n=["spliceAdd",":",v].join("");e.dispatchEvent(new ae(n,{path:r,value:t,detail:{index:c+v,addIndex:v,addItem:t}},e))}}v++}return n&&n.splice&&e.dispatchEvent(new ae("splice",{path:i,detail:{$start:c,deleted:u,added:h,length:r.length}},e)),u},unshift:function(e,t,...n){const{events:r}=t,{target:i,path:s,schema:a}=e,{enableValidation:o,validationEvents:l}=t,c=[];let p=n.length-1,h=0;for(;p>-1;){n.length;let t,d=n[p];i[p];if(a&&o){const t=a.validateProperty(p,d,{},e);if(l){let n,r;s&&[s,".",h].join("");t.valid?(n="validProperty",r=["validProperty",":",h].join("")):(n="nonvalidProperty",r=["nonvalidProperty",":",h].join(""));for(const i of[n,r])e.dispatchEvent(new le(i,t,e))}if(!t.valid)return e.length}if("object"==typeof d){const n=a?.context[0]||null,r=s?s.concat(".",h):String(h);t=new Se(d,n,{path:r,parent:e}),c.unshift(t),Array.prototype.unshift.call(i,t)}else t=d,c.unshift(t),Array.prototype.unshift.call(i,d);if(r){const n=["unshiftProp",h].join(":"),i=s?[s,h].join("."):String(h);r.unshiftProp&&e.dispatchEvent(new ae("unshiftProp",{path:i,value:t,detail:{elementIndex:h,element:t}},e)),r["unshiftProp:$index"]&&e.dispatchEvent(new ae(n,{path:i,value:t,detail:{elementIndex:h,element:t}},e))}p--,h++}return r&&r.unshift&&c.length&&e.dispatchEvent(new ae("unshift",{path:s,detail:{elements:c}},e)),e.length}};const{regularExpressions:ge}=g;const{recursiveAssign:ye}=g;const{recursiveAssign:be,regularExpressions:je}=g;const{recursiveAssign:me}=g;const{regularExpressions:Pe}=g;const{recursiveAssign:Ee}=g;var Oe={get:function(e,t,...n){let r;const i=ye({},e.options,t);return"string"==typeof n[0]?(2===n.length&&ye(i,n[1]),r=function(e,t,n){const{target:r,path:i}=e,{events:s,pathkey:a,subpathError:o}=t;if(!0===a){const a=n.split(new RegExp(ge.quotationEscape)),l=a.shift();let c=r[l];if(a.length){if(!1===o&&void 0===c)return;return c.get(a.join("."),t)}if(s&&(s.getProperty&&e.dispatchEvent(new ae("getProperty",{path:i,value:c,detail:{key:l,value:c}},e)),s["getProperty:$key"])){const t=["getProperty",":",l].join(""),n=[i,".",l].join("");e.dispatchEvent(new ae(t,{path:n,detail:{value:c}},e))}return c}if(!1===a)return r[propertyKey]}(e,i,...n)):(1===n.length&&ye(i,n[0]),r=function(e,t){const{path:n}=e,{events:r}=t;return r&&r.get&&e.dispatchEvent(new ae("get",{path:n,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,i,...n)),r},set:function(e,t,...n){let r;const i=me({},e.options,t);return"string"==typeof n[0]?(3===n.length&&me(i,n[2]),r=function(e,t,n,r){const{target:i,path:s,schema:a}=e,{enableValidation:o,validationEvents:l,events:c,pathkey:p,subpathError:h,recursive:d,source:u}=t;if(!0===p){const p=n.split(new RegExp(je.quotationEscape)),f=p.shift();let v;const g=s?[s,f].join("."):String(f);if(p.length){if(d&&void 0===i[f]){let n,r;n="array"===a?.type?a.context[0]:"object"===a?.type?a.context[f]:void 0,r="array"===n?.type?[]:"object"===n?.type?{}:Number(f)?[]:{},v=new Se(r,n,be({},t,{path:g,parent:e}))}else v=i[f];if(!1===h&&void 0===v)return;return v.set(p.join("."),r,t),v}if(a&&o){const t=a.validateProperty(f,r,u,e);if(l){let n,r;s?[s,f].join("."):String(f),t.valid?(n="validProperty",r=["validProperty",":",f].join("")):(n="nonvalidProperty",r=["nonvalidProperty",":",f].join(""));for(const i of[n,r])e.dispatchEvent(new le(i,t,e))}if(!t.valid)return}if("object"==typeof r){let n;r instanceof Se&&(r=r.valueOf()),n="array"===a?.type?a.context[0]:"object"===a?.type?a.context[f]:void 0,v=new Se(r,n,be({},t,{path:g,parent:e}))}else v=r;if(i[f]=v,c){const t=s?[s,f].join("."):String(f);if(c.setProperty&&e.dispatchEvent(new ae("setProperty",{path:t,value:v,detail:{key:f,value:v}},e)),c["setProperty:$key"]){const n=["setProperty",":",f].join("");e.dispatchEvent(new ae(n,{path:t,value:v,detail:{value:v}},e))}}return v}if(!1===p){let o=n;if("object"==typeof r){let n;r instanceof Se&&(r=r.valueOf()),"array"===a?.type&&(n=a.context[0]),n="object"===a?.type?a.context[o]:void 0;const i=s?[s,o].join("."):String(o);propertyValue=new Se(r,n,be({},t,{path:i,parent:e}))}else propertyValue=r;if(i[o]=propertyValue,c){const t=s?[s,o].join("."):String(o);if(c.setProperty&&e.dispatchEvent(new ae("setProperty",{path:t,value:propertyValue,detail:{key:o,value:propertyValue}},e)),c["setProperty:$key"]){const n=["setProperty",":",o].join("");e.dispatchEvent(new ae(n,{path:t,value:propertyValue,detail:{value:propertyValue}},e))}}return propertyValue}}(e,i,...n)):(2===n.length&&me(i,n[1]),r=function(e,t,n){for(const[r,i]of Object.entries(n))e.set(r,i,t);const{path:r}=e,{events:i}=t;return i&&i.set&&e.dispatchEvent(new ae("set",{path:r,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,i,...n)),r},delete:function(e,t,...n){let r;const i=Ee({},e.options,t);return"string"==typeof n[0]?(2===n.length&&Ee(i,n[1]),r=function(e,t,n){const{target:r,path:i,schema:s}=e,{events:a,pathkey:o,subpathError:l,enableValidation:c,validationEvents:p}=t;if(!0!==o)if(!1!==o);else{const o=n,l=r[o];if(s&&c){const t=e.valueOf();delete t[o];const n=s.validate(o,t,e,e);if(p){let t,r;i?[i,o].join("."):String(o),n.valid?(t="validProperty",r=["validProperty",":",o].join("")):(t="nonvalidProperty",r=["nonvalidProperty",":",o].join(""));for(const i of[t,r])e.dispatchEvent(new ValidatorEvent(i,n,e))}if(!n.valid)return}if(l instanceof Se&&l.delete(t),delete r[o],a&&(a.deleteProperty&&e.dispatchEvent(new ae("deleteProperty",{path:i,value:l,detail:{key:o,value:l}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",":",o].join(""),n=[i,".",o].join("");e.dispatchEvent(new ae(t,{path:n,value:l,detail:{value:l}},e))}}else{const o=n.split(new RegExp(Pe.quotationEscape)),h=o.shift();let d=r[h];if(o.length){if(!1===l&&void 0===d)return;return d.delete(o.join("."),t)}if(s&&c){const t=e.valueOf();delete t[h];const n=s.validate(h,t,{},e);if(p){let t,r;const s=i?[i,h].join("."):String(h);n.valid?(t="validProperty",r=["validProperty",":",h].join("")):(t="nonvalidProperty",r=["nonvalidProperty",":",h].join(""));for(const i of[t,r])e.dispatchEvent(new ValidatorEvent(i,Object.assign(n,{path:s}),e))}if(!n.valid)return}if("object"==typeof d&&d.delete(t),delete r[h],a&&(a.deleteProperty&&e.dispatchEvent(new ae("deleteProperty",{path:i,value:d,detail:{key:h,value:d}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",":",h].join(""),n=[i,".",h].join("");e.dispatchEvent(new ae(t,{path:n,value:d,detail:{value:d}},e))}}}(e,i,...n)):(1===n.length&&Ee(i,n[0]),r=function(e,t){const{target:n}=e;for(const[r,i]of Object.entries(n))e.delete(r,t);const{path:r}=e,{events:i}=t;return i&&i.delete&&e.dispatchEvent(new ae("delete",{path:r,detail:{value:e.valueOf()}},e)),e}(e,i,...n)),r}};const xe=Object.freeze({object:[{keys:["valueOf"],createMethod:function(e,t){return function(){return t.parse({type:"object"})}}},{keys:["toString"],createMethod:function(e,t){return function(e={}){const n=void 0!==e.replacer?e.replacer:null,r=void 0!==e.space?e.space:0;return t.parse({type:"string",replacer:n,space:r})}}},{keys:["entries","fromEntries","getOwnPropertyDescriptors","getOwnPropertyDescriptor","getOwnPropertyNames","groupBy","hasOwn","is","getPrototypeOf","isExtensible","isFrozen","isSealed","keys","preventExtensions","values"],createMethod:function(e,t){return Object[e].bind(null,t.valueOf())}},{keys:["propertyIsEnumerable","hasOwnProperty"],createMethod:function(e,t){return()=>t.parse({type:"object"})[e]}},{type:"mutators",keys:Object.keys(fe),createMethod:function(e,t,n){return fe[e].bind(null,t,n)}}],array:[{keys:["from","fromAsync","isArray","of"],createMethod:function(e,t){return Array[e]}},{keys:["at","every","filter","find","findIndex","findLast","findLastIndex","flat","flatMap","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","sort","toReversed","toSorted","toSpliced","with"],createMethod:function(e,t){return Array.prototype[e].bind(null,t)}},{type:"mutators",keys:Object.keys(ve),createMethod:function(e,t,n){return ve[e].bind(null,t,n)}}],accessor:[{type:"mutators",keys:Object.keys(Oe),createMethod:function(e,t,n){return Oe[e].bind(null,t,n)}}]});const{typedObjectLiteral:we,typeOf:ke}=g;class Se extends V{#G;#Q;#E;#x;#f;#T;#q;#i;#k;constructor(e={},t=null,n={}){super(),this.#O=e,this.#Q=(e=>se({path:null,parent:null,enableValidation:!0,validationEvents:{"validProperty:$key":!0,validProperty:!0,"nonvalidProperty:$key":!0,nonvalidProperty:!0},pathkey:!0,subpathError:!1,contentAssignmentMethod:"set",methods:{accessor:{get:{events:{get:!0,getProperty:!0,"getProperty:$key":!0}},set:{recursive:!0,events:{set:!0,setProperty:!0,"setProperty:$key":!0}},delete:{events:{delete:!0,deleteProperty:!0,"deleteProperty:$key":!0}}},array:{concat:{events:{"concatValue:$index":!0,concatValue:!0,concat:!0}},copyWithin:{events:{"copyWithinIndex:$index":!0,copyWithinIndex:!0,copyWithin:!0}},fill:{events:{"fillIndex:$index":!0,fillIndex:!0,fill:!0}},pop:{events:{pop:!0}},push:{events:{"pushProp:$index":!0,pushProp:!0,push:!0}},reverse:{events:{reverse:!0}},shift:{events:{shift:!0}},splice:{events:{"spliceDelete:$index":!0,spliceDelete:!0,"spliceAdd:$index":!0,spliceAdd:!0,splice:!0}},unshift:{events:{"unshiftProp:$index":!0,unshiftProp:!0,unshift:!0}}},object:{assign:{sourceTree:!0,events:{"assignSourceProperty:$key":!0,assignSourceProperty:!0,assignSource:!0,assign:!0}},defineProperties:{descriptorTree:!0,events:{defineProperties:!0}},defineProperty:{descriptorTree:!0,events:{defineProperty:!0,"defineProperty:$key":!0}},freeze:{recursive:!0,events:{freeze:!0}},seal:{recursive:!0,events:{seal:!0}}}}},e))(n),this.schema=t,function(e){for(const[t,n]of Object.entries(xe))for(const r of n){const{keys:n,createMethod:i,type:s}=r;for(const r of n)if("accessor"===t||"mutators"===s){const n=e.options?.methods[t][r]||{};Object.defineProperty(e,r,{enumerable:!1,writable:!1,configurable:!1,value:i(r,e,n)})}else Object.defineProperty(e,r,{enumerable:!1,writable:!1,configurable:!1,value:i(r,e)})}}(this);const{contentAssignmentMethod:r}=this.options;this[r](this.#O)}get#O(){return this.#G}set#O(e){if(void 0===this.#G)return e instanceof Se&&(this.#G=e.valueOf()),this.#G=e,this.#G}get options(){return this.#Q}get schema(){return this.#E}set schema(e){if(void 0!==this.#E)return;const t=ke(e);["undefined","null"].includes(t)?this.#E=null:e instanceof ie?this.#E=e:"array"===t?this.#E=new ie(...arguments):"object"===t&&(this.#E=new ie(e))}get classToString(){return Se.toString()}get type(){return void 0!==this.#x||(this.#x=ke(this.#O)),this.#x}get parent(){return void 0!==this.#T||(this.#T=this.options.parent?this.options.parent:null),this.#T}get root(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}get key(){return void 0!==this.#q||(this.path?this.#q=this.path.split(".").pop():this.#q=null),this.#q}get path(){return void 0!==this.#i||(this.#i=this.options.path?String(this.options.path):null),this.#i}get target(){return void 0!==this.#f||(this.#f=we(this.#O)),this.#f}parse(e={type:"object",replacer:null,space:0}){let t=we(this.type);for(const[e,n]of Object.entries(Object.getOwnPropertyDescriptors(this.target))){const{enumerable:r,value:i,writable:s,configurable:a}=n;n.value instanceof Se?Object.defineProperty(t,e,{enumerable:r,value:i.parse({type:"object"}),writable:s,configurable:a}):Object.defineProperty(t,e,{enumerable:r,value:i,writable:s,configurable:a})}const{type:n,replacer:r,space:i}=e;return"object"===n?t:"string"===n?JSON.stringify(t,r,i):void 0}}export{Se as Content,ie as Schema};
//# sourceMappingURL=objecture.min.js.map
