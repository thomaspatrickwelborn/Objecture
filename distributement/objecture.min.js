var e={default:(e,t)=>void 0===t?e:e[t],get:(e,t)=>void 0===t?e:e.get(t)};function t(e,t=":scope"){if(Array.isArray(e)||void 0===e)return e;const n=[];for(const[r,s]of Object.entries(e)){const e=r.trim().split(" ");let i,a,o;1===e.length?(i=t,a=e[0]):e.length>1&&(i=e[0],a=e[1]),Array.isArray(s)?(o=s[0],s[1]):o=s;const c={type:a,path:i,listener:o,enable:!1};n.push(c)}return n}const n={string:String,number:Number,boolean:Boolean,undefined:void 0,null:null},r=Object.keys(n),s=Object.values(n),i={object:Object,array:Array},a=Object.keys(i),o=Object.values(i),c=Object.assign({},n,i),l=Object.keys(c),p=Object.values(c),u=[n.String,n.Number,n.Boolean,i.Object,i.Array];var d=Object.freeze({__proto__:null,ObjectKeys:a,ObjectValues:o,Objects:i,PrimitiveKeys:r,PrimitiveValues:s,Primitives:n,TypeKeys:l,TypeMethods:u,TypeValues:p,Types:c}),f={quotationEscape:/\.(?=(?:[^"]*"[^"]*")*[^"]*$)/};const h=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function v(e){return e.split(new RegExp(f.quotationEscape))}function g(e){const t=v(e);return t.pop(),t}function y(e){return v(e).pop()}function b(e){return v(e).shift()}function j(e){return Number(b(e))?"array":"object"}function m(e){return{subpaths:v(e),keypaths:g(e),key:y(e),root:b(e),typeofRoot:j(e)}}function E(e){let t;const n=h(e);return"object"===n?t={}:"array"===n?t=[]:"string"===n?"object"===e?t={}:"array"===e&&(t=[]):t=void 0,t}function O(e,t){const n=e.split(new RegExp(f.quotationEscape)),r=n.pop();let s=t;for(const e of n)s=s[e];return s[r]}function P(e,t){const{keypaths:n,key:r,typeofRoot:s}=m(e),i=E(s);let a=i;for(const e of n)Number(e)?a[e]=[]:a[e]={},a=a[e];return a[r]=t,i}const w={depth:0,maxDepth:10,accessors:[e.default]};function k(e,t){const n=[],r=Object.assign({},w,t);if(r.depth++,r.depth>r.maxDepth)return n;for(const t of r.accessors){const s=t(e);if(s)for(const[e,t]of Object.entries(s))if(r.values?r.values&&n.push([e,t]):n.push(e),"object"==typeof t&&null!==t&&t!==s){const s=k(t,r);if(r.values){if(r.values)for(const[t,r]of s){const s=[e,t].join(".");n.push([s,r])}}else for(const t of s){const r=[e,t].join(".");n.push(r)}}}return n}function x(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,r]of Object.entries(n)){const n=h(e[t]),s=h(r);e[t]="object"===n&&"object"===s?x(e[t],r):r}return e}var A=Object.freeze({__proto__:null,accessors:e,expandEvents:t,expandTree:function e(t,n){const r=h(n),s=h(t);if(!["string","function"].includes(r)||!["array","object"].includes(s))return t;let i=E(t);for(const[s,a]of Object.entries(t))"string"===r?i[s]=P(n,a):"function"===r&&(i[s]=n(a)),i[s][n]&&"object"==typeof i[s][n]&&(i[s][n]=e(i[s][n],n));return i},impandTree:function e(t,n){const r=h(n),s=h(t);if(!["string","function"].includes(r)||!["array","object"].includes(s))return t;let i=E(t);for(const[s,a]of Object.entries(t))"string"===r?i[s]=O(n,a):"function"===r&&(i[s]=n(a)),i[s]&&"object"==typeof i[s]&&(i[s]=e(i[s],n));return i},propertyDirectory:k,recursiveAssign:x,recursiveAssignConcat:function e(t,...n){if(!t)return t;for(const r of n)if(r)for(const[n,s]of Object.entries(r)){const r=h(t[n]),i=h(s);t[n]="object"===r&&"object"===i?e(t[n],s):"array"===r&&"array"===i?t[n].concat(s):s}return t},recursiveFreeze:function e(t){for(const[n,r]of Object.entries(t))r&&"object"==typeof r&&e(r);return Object.freeze(t)},regularExpressions:f,typeOf:h,typedObjectLiteral:E,variables:d});function $(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var r=e.substr(0,t),s=e.substr(t+2);if(r.length>0&&s.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function D(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,r=0,s=0,i=-1,a=[""],o=[],c=0;c<e.length;c++){var l=e[c];if("\\"!==l){if("{"===l)if(n)r++;else if(c>i&&!r){t=e.substring(i+1,c);for(var p=0;p<a.length;p++)a[p]+=t;o=[],i=c,n=!0,r++}else r--;else if("}"===l)if(n)s++;else if(1===s){if(t=e.substring(i+1,c),o.length>0){var u=[];o.push(D(t));for(p=0;p<a.length;p++)for(var d=0;d<o.length;d++)for(var f=0;f<o[d].length;f++)u.push(a[p]+o[d][f]);a=u}else{t=$(t);for(p=0;p<a.length;p++)a[p]+=t}i=c,s--}else s--;else n||","!==l||s-r!=1||(t=e.substring(i+1,c),o.push(D(t)),i=c);!n||s!==r&&c!==e.length-1||(n=!1,c=i-1)}else c++}if(-1===i)return[e];var h="{"===e[i]?i:i+1;if(h<e.length){t=e.substr(h);for(p=0;p<a.length;p++)a[p]+=t}return a}function S(e,t){var n,r=!1!==t["!"],s=!1!==t["()"],i=!1;if(r){for(n=0;n<e.length&&"!"===e[n];n++){if(s&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function T(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function _(e,t,n){var r=void 0===t.separator||t.separator,s="",i="",a=".";!0===r?(s="/",i="[/\\\\]",a="[^/\\\\]"):a=r?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=T(e[n]);return t}(s=r)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var o=r?i+"+?":"",c=r?i+"*?":"",l=r?e.split(s):[e];return{source:e,segments:l,options:t,separator:r,separatorSplitter:s,separatorMatcher:i,optionalSeparator:c,requiredSeparator:o,wildcard:a,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:r&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function L(e,t,n,r){return{source:e,isFirst:n,isLast:r,end:e.length-1}}var q="(?!\\.)";function V(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=q+t),e.dotHandled=!0,e.result.match+=t),e.result}function C(e,t,n){var r=e.support,s=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(r.excludeDot||(s.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:V(s,i);if(r.globstar&&"**"===t.source)return V(s,"(?:"+((s.dotHandled?"":q)+e.wildcard+"*?"+i)+")*?");for(;++s.i<=t.end;){if(s.char=s.segment.source[s.i],s.nextChar=s.i<t.end?t.source[s.i+1]:"","\\"===s.char){if(s.i<s.segment.end){s.escapeChar=!0;continue}s.char=""}e=s.pattern,t=s.segment;var a=s.char,o=s.i;if(e.support.brackets&&!s.scanningForParens){if(o>s.openingBracket&&o<=s.closingBracket){s.escapeChar?V(s,T(a)):o===s.closingBracket?(V(s,"]"),s.openingBracket=t.source.length):"-"===a&&o===s.closingBracket-1?V(s,"\\-"):"!"===a&&o===s.openingBracket+1?V(s,"^"):V(s,"]"===a?"\\]":a),s.escapeChar=!1;continue}if(o>s.openingBracket){"]"===a&&!s.escapeChar&&o>s.openingBracket+1&&o>s.closingBracket?(s.closingBracket=o,s.i=s.openingBracket,e.separator?V(s,"(?!"+e.separatorMatcher+")[",!0):V(s,"[",!0)):o===t.end&&(V(s,"\\["),s.i=s.openingBracket,s.openingBracket=t.source.length,s.closingBracket=t.source.length),s.escapeChar=!1;continue}if("["===a&&!s.escapeChar&&o>s.closingBracket&&o<t.end){s.openingBracket=o,s.escapeChar=!1;continue}}if(s.pattern.support.extglobs){var c=s.extglobModifiers,l=(a=s.char,s.nextChar);o=s.i;if("("!==l||s.escapeChar||"@"!==a&&"?"!==a&&"*"!==a&&"+"!==a&&"!"!==a){if(")"!==a||s.escapeChar){if("|"===a&&s.closingParens&&!s.scanningForParens&&!s.escapeChar){V(s,"|");continue}}else if(s.scanningForParens)s.closingParens++;else if(c.length){var p=c.pop();if("!"===p&&-1!==c.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");V(s,")"+(p="!"===p||"@"===p?"":p)),s.addToMatch=!0,s.addToUnmatch=!0,s.closingParens--;continue}}else if(s.scanningForParens)s.openingParens++;else if(o>s.parensHandledUntil&&!s.closingParens)s.parensHandledUntil=o,s.scanningForParens=!0,s.openingParens++;else{if(s.closingParens>=s.openingParens){"!"===a&&(s.addToMatch=!0,s.addToUnmatch=!1,V(s,s.pattern.wildcard+"*?",!0),s.addToMatch=!1,s.addToUnmatch=!0,s.result.useUnmatch=!0),c.push(a),V(s,"(?:",!0),s.openingParens--,s.i++;continue}s.openingParens--}if(s.scanningForParens){s.closingParens!==s.openingParens&&o!==s.segment.end||(s.scanningForParens=!1,s.i=s.parensHandledUntil-1),s.escapeChar=!1;continue}}r=(e=s.pattern).support;!s.escapeChar&&r.star&&"*"===s.char?s.i!==s.segment.end&&"*"===s.nextChar||V(s,e.wildcard+"*?",!0):!s.escapeChar&&r.qMark&&"?"===s.char?V(s,e.wildcard,!0):V(s,T(s.char)),s.escapeChar=!1}return V(s,i)}function R(e,t,n){for(var r=_(e,t,n),s={match:"",unmatch:"",useUnmatch:!1},i=r.segments,a=0;a<i.length;a++){C(r,L(i[a],0,0===a,a===i.length-1),s)}return s.useUnmatch?"(?!^"+s.unmatch+"$)"+s.match:s.match}function z(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function N(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],r=0;r<e.length;r++)for(var s=t(e[r]),i=0;i<s.length;i++)n.push(s[i]);return n}(e,D));for(var n=[],r=[],s="",i=0;i<e.length;i++){var a=S(e[i],t),o=R(a.pattern,t,!a.isNegated);a.isNegated?r.push(o):n.push(o)}return r.length&&(s="(?!(?:"+r.join("|")+")$)"),n.length>1?s+="(?:"+n.join("|")+")":1===n.length?s+=n[0]:s.length&&(s+=R("**",t,!0)),"^"+s+"$"}(e,t),r=new RegExp(n,t.flags),s=z.bind(null,r);return s.options=t,s.pattern=e,s.regexp=r,s}class B{#e;#t;#n;#r=!1;#s;#i=[];#a=[];#o=[];#c=[];#l=[];#p;#u;#d;constructor(t,n){if(!t||!n)return this;this.#e=((t={})=>{const n={enable:!1,accessors:[e.default],propertyDirectory:{scopeKey:t.scopeKey,maxDepth:10},assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent",bindListener:!0,scopeKey:":scope",errorLog:!1,methods:{assign:{addEventListener:function(e,t){const{type:n,listener:r,settings:s}=e,{options:i,useCapture:a}=s;return t.addEventListener(n,r,i||a)},on:function(e,t){const{type:n,listener:r}=e;return t.on(n,r)},once:function(e,t){const{type:n,listener:r}=e;return t.once(n,r)}},deassign:{removeEventListener:function(e,t){const{type:n,listener:r,settings:s}=e,{options:i,useCapture:a}=s;return t.removeEventListener(n,r,i||a)},off:function(e,t){const{type:n,listener:r}=e;return t.off(n,r)}},transsign:{dispatchEvent:function(e,t,n){return t.dispatchEvent(n)},emit:function(e,t,n,...r){return t.emit(n,...r)}}}};for(const[e,r]of Object.entries(t))switch(e){case"propertyDirectory":n[e]=Object.assign(n[e],r);break;case"accessors":n[e]=r,n.propertyDirectory[e]=r;break;case"methods":n[e]=x(n[e],r);break;case"enableEvents":break;default:n[e]=r}return n})(t),this.#t=n,this.enable=this.settings.enable}get settings(){return this.#e}get path(){return this.settings.path}get type(){return this.settings.type}get listener(){if(void 0!==this.#n)return this.#n;const e=this.settings.listener;return!0===this.settings.bindListener?this.#n=e.bind(this.#t):this.#n=e,this.#n}get enable(){return this.#r}set enable(e){const t=this.#f,n=this.#i,r=this.#a;n.length=0,r.length=0;for(const s of t){const{path:t,target:i,enable:a}=s;if(this.settings,a!==e)if(!0===e)try{this.#h(i),s.enable=e,n.push(s)}catch(e){this.settings.errorLog&&console.error(e)}else if(!1===e)try{this.#v(i),s.enable=e,r.push(s)}catch(e){this.settings.errorLog&&console.error(e)}}this.#r=e}get assigned(){return this.#i}get deassigned(){return this.#a}get#g(){return this.settings.target}get#f(){const e=this.#l,t=[];if(this.#g)for(const n of[].concat(this.#g)){const r=e.find((e=>e?.path===this.path));void 0!==r?t.push(r):void 0===r&&t.push({path:this.path,target:n,enable:!1})}else if("string"===h(this.path)){const n=[];if(this.path===this.#y){const e={path:this.path,target:this.#t,enable:!1};t.push(e)}else{if(this.settings.propertyDirectory){const e=this.#b,t=N(this.path,{separator:"."});for(const r of e){!0===t(r)&&n.push(r)}"*"===this.path.charAt(0)&&n.unshift(this.#y)}else n.push(this.path);for(const r of n){const n=e.find((e=>e.path===r));let s,i=this.#t;const a=r.split(".");let o=0;e:for(;o<a.length;){let e=a[o];if(e===this.#y)break e;t:for(const t of this.settings.accessors){try{i=t(i,e)}catch(e){this.settings.errorLog&&console.error(e)}if(void 0!==i)break t}o++}void 0!==i&&(i===n?.target?s=n:"object"==typeof i&&(s={path:r,target:i,enable:!1})),void 0!==s&&t.push(s)}}}return this.#l=t,this.#l}get#y(){return this.settings.scopeKey}get#h(){return void 0!==this.#p||(this.#p=this.settings.methods.assign[this.settings.assign].bind(null,this)),this.#p}get#v(){return void 0!==this.#u||(this.#u=this.settings.methods.deassign[this.settings.deassign].bind(null,this)),this.#u}get#j(){return void 0!==this.#d||(this.#d=this.settings.methods.transsign[this.settings.transsign].bind(null,this)),this.#d}get#m(){return this.settings.methods}get#b(){if(!this.settings.propertyDirectory)return null;const e=(this.settings.accessors,this.settings.propertyDirectory);return k(this.#t,e)}emit(){const e=this.#f,t=this.#o,n=this.#c;t.length=0,n.length=0;for(const r of e){const{target:e}=r;try{this.#j(e,...arguments),t.push(r)}catch(e){n.push(r)}}return this}}class I extends EventTarget{static implement=function(e,n){if(!e||!n)return;const r=((e={})=>{const t={events:{},enableEvents:!1,propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents",emitEvents:"emitEvents"}};for(const[n,r]of Object.entries(e))t[n]="propertyDefinitions"===n?Object.assign(t[n],r):r;return t})(n),s=[];return Object.defineProperties(e,{[r.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments[0])return s;const e=[],t=[].concat(arguments[0]);for(const n of t)for(const t of s){let r;e:for(const[e,s]of Object.entries(n)){let n;if(n="listener"===e?t.settings[e]===s:t[e]===s,!1===r)break e;r=n}!0===r&&e.push(t)}return e}},[r.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments.length)return e;let n=t(arguments[0],r.scopeKey),i=arguments[1]||!1;for(let t of n){const n={};for(const e of["accessors","assign","deassign","transsign","propertyDirectory"]){const t=r[e];void 0!==t&&(n[e]=t)}x(n,t);const a=new B(n,e);i&&(a.enable=!0),s.push(a)}return e}},[r.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[r.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;let n=s.length-1;for(;n>-1;){const e=s[n];t.includes(e)&&(e.enable=!1,s.splice(n,1)),n--}return e}},[r.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[r.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!0;return e}},[r.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[r.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!1;return e}},[r.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[r.propertyDefinitions.getEvents](arguments[0]);for(const e of t)e.enable=!1,e.enable=!0;return e}},[r.propertyDefinitions.emitEvents]:{enumerable:!1,writable:!1,value:function(t,...n){const s=e[r.propertyDefinitions.getEvents](t);for(const e of s)e.emit(...n);return e}}}),r.events&&e[r.propertyDefinitions.addEvents](r.events),!0===r.enableEvents&&e[r.propertyDefinitions.enableEvents](),e};constructor(e={}){return super(),I.implement(this,e)}}class K extends EventTarget{constructor(e){super();const t=Object.assign({},e);Object.defineProperties(this,{type:{value:t.type},key:{value:t.key},value:{value:t.value},message:{configurable:!0,get(){let e;return void 0!==this.pass&&(e=t.messages[String(this.pass)](this),Object.defineProperty(this,"message",{value:e})),e}},pass:{writable:!0,set pass(e){Object.defineProperty(this,"pass",{value:e})}}})}}const{typedObjectLiteral:M}=A,F={true:e=>`${e.valid}`,false:e=>`${e.valid}`};function U(e="expand",t){const n=t||this,r=n.schema,s=[].concat(n.advance,n.deadvance,n.unadvance);if("expand"===e){const t=M(r.type);for(const n of s){const r=[].concat(n.advance,n.deadvance,n.unadvance);t[n.key]={};for(const s of r)t[n.key][s.type]={},s.validation?t[n.key][s.type]=this.report(e,s.validation):t[n.key][s.type]=s}return t}if("impand"===e){if(!1===n.valid)return!1;const t=M(r.type);for(const n of s){const r=[].concat(n.advance,n.deadvance,n.unadvance);let s;e:for(const t of r)if("type"===t.type){t.validation&&n.valid&&(s=this.report(e,t.validation));break e}s||(s=n.valid),t[n.key]=s}return t}}class W extends EventTarget{constructor(e={},t){super();const n=Object.assign({messages:F},e);Object.defineProperties(this,{schema:{value:t},verificationType:{value:n.verificationType},required:{value:n.required},definition:{value:n.definition},key:{value:n.key},value:{value:n.value},advance:{value:[]},deadvance:{value:[]},unadvance:{value:[]},valid:{writable:!0,get valid(){},set valid(e){Object.defineProperty(this,"valid",{value:e})}},report:{configurable:!0,get(){const e=U.bind(this);return Object.defineProperty(this,"report",{value:e}),e}}})}}const{recursiveAssign:H}=A,J={true:e=>`${e.pass}`,false:e=>`${e.pass}`};class G extends EventTarget{constructor(e={},t){super();const n=Object.freeze(Object.assign({messages:J},e));Object.defineProperties(this,{definition:{value:n},schema:{value:t},type:{value:n.type},messages:{value:n.messages},validate:{configurable:!0,get(){const e=function(e,t,n,r){const{definition:s,messages:i,type:a}=this;let o=new K({type:a,key:e,value:s.value,messages:H({},i,s.messages)});const c=s.validate(...arguments);return"object"==typeof c?(o.validation=c,o.pass=c.valid):o.pass=c,o}.bind(this);return Object.defineProperty(this,"validate",{value:e}),e}}})}}const{recursiveAssign:Q,typedObjectLiteral:X}=A;class Y extends G{constructor(e,t){super(Object.assign({},e,{type:"required",validate:(e,n,r,s)=>{const{requiredProperties:i,requiredPropertiesSize:a,type:o}=t,c=Object.assign({},i);let l,p=a;if(Object.assign(X(o),r,s),this.definition,a){if(Object.hasOwn(c,e)&&(delete c[e],p--),p){const e=new fe(c,{path:t.path,parent:t.parent}),n=Object.assign({},s,r);l=e.validate(n).valid}}else l=!0;return l}}),t)}}const{typeOf:Z,variables:ee}=A,{ObjectKeys:te,TypeKeys:ne}=ee;class re extends G{constructor(e={},t){super(Object.assign({},e,{type:"type",validate:(e,t,n,r)=>{let s;const i=this.definition;let a=Z(i.value);if(a="function"===a?Z(i.value()):i.value instanceof fe?i.value.type:Z(i.value),ne.includes(a)){const e=Z(t);if("undefined"===e)s=!1;else if("undefined"===a)s=!0;else if(i.value instanceof fe){s=i.value.validate(t,n)}else s=a===e}else s=!1;return s}}),t)}}class se extends G{constructor(e={},t){super(Object.assign(e,{type:"range",validate:(e,t)=>{const n=this.definition;let r;if("number"!=typeof t)r=!1;else{const{min:e,max:s}=n;let i,a;i=void 0===e||t>=e.value,a=void 0===s||t<=s.value,r=!(!i||!a)}return r}}),t)}}class ie extends G{constructor(e={},t){super(Object.assign(e,{type:"length",validate:(e,t)=>{const n=this.definition;let r;if("string"!=typeof t)r=!1;else{const{min:e,max:s}=n;let i,a;i=void 0===e||t.length>=e.value,a=void 0===s||t.length<=s.value,r=!(!i||!a)}return r}}),t)}}class ae extends G{constructor(e={},t){super(Object.assign(e,{type:"enum",validate:(e,t)=>{const n=this.definition;let r;if(["string","number","boolean"].includes(typeof t)){r=n.value.includes(t)}else r=!1;return r}}),t)}}class oe extends G{constructor(e={},t){super(Object.assign(e,{type:"match",validate:(e,t)=>{const n=this.settings;let r;if(["string","number","boolean"].includes(typeof t)){n.value.exec(t)}else r=!1;return!!r}}),t)}}const{recursiveAssign:ce}=A;var le=(...e)=>Object.assign({required:!1,verificationType:"all",strict:!1,properties:{type:"type",value:"value"}},...e);const{typedObjectLiteral:pe,typeOf:ue,variables:de}=A;class fe extends EventTarget{constructor(e={},t={}){super(),Object.defineProperties(this,{options:{value:le(t)},type:{value:ue(e)},parent:{configurable:!0,get(){const{options:e}=this,t=e.parent?e.parent:null;return Object.defineProperty(this,"parent",{value:t}),t}},root:{configurable:!0,get(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}},key:{configurable:!0,get(){const{path:e}=this,t=e?e.split(".").pop():null;return Object.defineProperty(this,"key",{value:t}),t}},path:{configurable:!0,get(){const{options:e}=this,t=e.path?String(e.path):null;return Object.defineProperty(this,"path",{value:t}),t}},required:{configurable:!0,get(){const e=this.options.required;return Object.defineProperty(this,"required",{value:e}),e}},requiredProperties:{configurable:!0,get(){const e=pe(this.type);for(const[t,n]of Object.entries(this.target))!0===n.required?.value&&(e[t]=n);return Object.defineProperty(this,"requiredProperties",{value:Object.freeze(e)}),e}},requiredPropertiesSize:{configurable:!0,get(){const e=Object.keys(this.requiredProperties).length;return Object.defineProperty(this,"requiredPropertiesSize",{value:e}),e}},verificationType:{configurable:!0,get(){const e=this.options.verificationType;return Object.defineProperty(this,"verificationType",{value:e}),e}},target:{configurable:!0,get(){let t;const n=this.type;"array"===n?t=e.slice(0,1):"object"===n&&(t=e);const r=function(e,t){const n=pe(e);if(he(e,t))return e;for(const[r,s]of Object.entries(e)){let e={};ue(s);const i=he(s,t);if(de.TypeValues.includes(s))Object.assign(e,{type:{value:s}});else if(de.TypeKeys.includes(s))Object.assign(e,{type:{value:de.Types[s]}});else if(i){if(i)for(const[n,i]of Object.entries(s)){const s=ve(i,t);if(s)s&&(e[n]=i);else{let s;if("type"===n)if(i&&"object"==typeof i){const e=t.path?[t.path,r].join("."):r;s=new fe(i,Object.assign({},t.options,{parent:t,path:e}))}else s=i;else s=i;e[n]={type:n,value:s}}}}else{const n=t.path?[t.path,r].join("."):r;Object.assign(e,{type:{type:"type",value:new fe(s,Object.assign({},t.options,{parent:t,path:n}))}})}e.validators=[],n[r]=e;const a=new Map;a.set("type",Object.assign({},{type:"type",validator:re,value:e.type.value})),a.set("required",Object.assign({},{type:"required",validator:Y,value:e.required?.value||!1})),e.range?a.set("range",Object.assign({},e.range,{type:"range",validator:se})):(e.min||e.max)&&a.set("range",Object.assign({},{type:"range",min:e.min,max:e.max,validator:se})),e.length?a.set("length",Object.assign({},e.length,{type:"length",validator:ie})):(e.minLength||e.maxLength)&&a.set("length",Object.assign({},{type:"length",min:e.minLength,max:maxLength,validator:ie})),e.enum&&a.set("enum",Object.assign({},e.enum,{type:"enum",validator:ae})),e.match&&a.set("match",Object.assign({},e.match,{type:"match",validator:oe})),delete e.min,delete e.max,delete e.minLength,delete e.maxLength;for(const[n,r]of a.entries()){const s=r.validator;e[n]=r,e.validators.push(new s(r,t))}}return n}(t,this);return Object.defineProperty(this,"target",{value:r}),r}},validate:{value:function(...e){let{$sourceName:t,$source:n,$target:r}=function(...e){let t,n,r;1===e.length?(t=null,n=e.shift(),r=null):2===e.length?["number","string"].includes(typeof e[0])?(t=e.shift(),n=e.shift(),r=null):e[0]&&"object"==typeof e[0]&&(t=null,n=e.shift(),r=e.shift()):3===e.length&&["number","string"].includes(typeof e[0])&&(t=e.shift(),n=e.shift(),r=e.shift());return{$sourceName:t,$source:n,$target:r}}(...e);r=r||pe(n);const{target:s,path:i,required:a,type:o,verificationType:c}=this;let l=new W({required:a,verificationType:c,definition:s,key:t,value:n},this);const p=Object.entries(n);let u=0;for(;u<p.length;){const[e,t]=p[u],s=this.validateProperty(e,t,n,r);!0===s.valid?l.advance.push(s):!1===s.valid?l.deadvance.push(s):void 0===s.valid&&l.unadvance.push(s),u++}return l.advance.length?l.valid=!0:l.deadvance.length?l.valid=!1:l.unadvance.length?l.valid=void 0:l.valid=!0,l}},validateProperty:{value:function(){const{$key:e,$value:t,$source:n,$target:r}=function(...e){let[t,n,r,s]=e;return{$key:t,$value:n,$source:r,$target:s}}(...arguments),{target:s,path:i,required:a,schema:o,type:c,verificationType:l}=this;let p;"array"===c?p=s[0]:"object"===c&&(p=s[e]);const u=new W({required:a,verificationType:l,definition:p,key:e,value:t},this);if(void 0===p){const n=new K({type:null,definition:null,key:e,value:t},this);n.pass=!1,u.unadvance.push(n)}else e:for(const[s,i]of Object.entries(p.validators)){const s=i.validate(e,t,n,r);if(!0===s.pass?u.advance.push(s):!1===s.pass?u.deadvance.push(s):void 0===s.pass&&u.unadvance.push(s),"one"===this.verificationType&&u.deadvance.length)break e}return u.deadvance.length?u.valid=!1:u.advance.length?u.valid=!0:u.unadvance.length&&(u.valid=!1),u}}})}}function he(e,t){if(!e||e instanceof fe)return!1;const n=t.options.properties.type;return Object.hasOwn(e,n)}function ve(e,t){if(!e)return!1;const n=t.options.properties.value;return Object.hasOwn(e,n)}const{recursiveAssign:ge}=A;class ye extends CustomEvent{constructor(e,t,n){super(e,t),Object.defineProperties(this,{model:{get:()=>n},key:{configurable:!0,get(){const e=this.path?this.path.split(".").pop():null;return Object.defineProperty(this,"key",{value:e}),e}},change:{configurable:!0,get(){const e=t.change;return Object.defineProperty(this,"change",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},path:{configurable:!0,get(){const e=t.path;return Object.defineProperty(this,"path",{value:e}),e}},detail:{configurable:!0,get(){const e=t.detail;return Object.defineProperty(this,"detail",{value:e}),e}}})}}class be{#E=!1;#O=!1;#P=!1;#w=!1;#k;#x;#A;#$;constructor(e={}){for(const[t,n]of Object.entries(e))this[t]=n}get preter(){return this.#x}set preter(e){if(!0===this.#O)return this.#x;this.#x=e?.valueOf(),this.#O=!0}get anter(){return this.#A}set anter(e){if(!0===this.#P)return this.#A;this.#A=e?.valueOf(),this.#P=!0}get conter(){if(!0===this.#w||[this.#O,this.#P].includes(!1))return this.#$;const e=JSON.stringify(this.preter);let t;return t=JSON.stringify(this.anter)!==e,this.#$=t,this.#w=!0,this.#$}}let je=class extends CustomEvent{constructor(e,t,n){super(e),Object.defineProperties(this,{key:{configurable:!0,get(){const e=t.key;return Object.defineProperty(this,"key",{value:e}),e}},path:{configurable:!0,get(){const e=n.path?[n.path,t.key].join("."):t.key;return Object.defineProperty(this,"path",{value:e}),e}},value:{configurable:!0,get(){const e=t.value;return Object.defineProperty(this,"value",{value:e}),e}},valid:{configurable:!0,get(){const e=t.valid;return Object.defineProperty(this,"valid",{value:e}),e}}})}};const{recursiveAssign:me,typedObjectLiteral:Ee}=A;const{typedObjectLiteral:Oe}=A;const{impandTree:Pe,recursiveAssign:we,typedObjectLiteral:ke}=A;var xe={assign:function(e,t,...n){const r=Object.assign({},t),s=r.assignArray||"assign",{path:i,schema:a,source:o,target:c}=e,{enableValidation:l,mutatorEvents:p,required:u,sourceTree:d,validationEvents:f}=r,h=[],v=new be({preter:e});for(let t of n){let n;const o=new be({preter:e});let u;Array.isArray(t)?n=[]:t&&"object"==typeof t&&(n={}),l&&a&&(u=a.validate(t,e.valueOf()),u.report());e:for(let[o,u]of Object.entries(t)){const h=new be({preter:c[o]}),v=new be({preter:c[o]});if(a&&l){const n=e.valueOf(),r=t,s=a.validateProperty(o,u,r,n);if(f){let t,n;s.valid?(t="validProperty",n=["validProperty",o].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",o].join(":"));for(const r of[t,n])e.dispatchEvent(new je(r,s,e))}if(!s.valid)continue e}let g;if(u&&"object"==typeof u){let t;u instanceof e.constructor&&(g=u.valueOf()),t="array"===a?.type?a.target[0].type.value:"object"===a?.type?a.target[o].type.value:null;const l=i?[i,o].join("."):String(o);if(!1===d){const s=me({},r,{path:l,parent:e});g=new e.constructor(u,t,s);const i={[o]:g};Object.assign(c,i),Object.assign(n,i)}else{if(c[o]instanceof e.constructor)g=c[o];else{const n=Ee(u),s=me({},r,{path:l,parent:e});g=new e.constructor(n,t,s)}const i={[o]:g};Object.assign(c,i),Object.assign(n,i),e.retroReenableEvents(),"array"===g.type?["push","unshift"].includes(s)?g[s](...u):g[s](u):"object"===g.type&&g.assign(u)}}else{g=u;const e={[o]:g};Object.assign(c,e),Object.assign(n,e)}if(p){const t=i?[i,o].join("."):String(o);if(p["assignSourceProperty:$key"]){const r=["assignSourceProperty",o].join(":");v.anter=c[o],e.dispatchEvent(new ye(r,{path:t,value:g,change:v,detail:{source:n}},e))}p.assignSourceProperty&&(h.anter=c[o],e.dispatchEvent(new ye("assignSourceProperty",{path:t,value:g,change:h,detail:{source:n}},e)))}}h.push(n),p&&p.assignSource&&(o.anter=e,e.dispatchEvent(new ye("assignSource",{path:i,change:o,detail:{source:n}},e)))}return p&&p.assign&&(v.anter=e,e.dispatchEvent(new ye("assign",{path:i,change:v,detail:{sources:h}},e))),e},defineProperties:function(e,t,n){const{path:r,schema:s}=e;let{enableValidation:i,mutatorEvents:a,required:o,validation:c,validationEvents:l,validationReport:p}=t;const u=Object.entries(n),d=new be({preter:e});for(const[n,r]of u)e.defineProperty(n,r,Object.assign({},t,{validation:c,validationReport:p}));return a&&a.defineProperties&&(d.anter=e,e.dispatchEvent(new ye("defineProperties",{path:r,value:e.valueOf(),detail:{descriptors:n}},e))),e},defineProperty:function(e,t,n,r){const s=Object.assign({},t),i=s.assignArray||"defineProperties",{descriptorTree:a,enableValidation:o,mutatorEvents:c,validation:l,validationEvents:p,validationReport:u}=s,{target:d,path:f,schema:h}=e,v=r.value,g=(Object.getOwnPropertyDescriptor(d,n)||{}).value,y=new be({preter:g}),b=new be({preter:g}),j=g instanceof e.constructor;if(h&&o){const t=h.validateProperty(n,Pe(v,"value")||v,{},e.valueOf());if(p){let r,s;t.valid?(r="validProperty",s=["validProperty",n].join(":")):(r="nonvalidProperty",s=["nonvalidProperty",n].join(":"));for(const n of[r,s])e.dispatchEvent(new je(n,t,e))}if(!t.valid)return e}if(v&&"object"==typeof v){const t=f?[f,n].join("."):String(n);if(j)!0===a?g.defineProperties(r):Object.defineProperty(d,n,r);else{let o;h&&(o="array"===h.type?h.target[0].type.value:"object"===h.type?h.target[n].type.value:void 0);let c=ke(v);const l=we({},s,{path:t,parent:e}),p=new e.constructor(c,o,l);!0===a?(d[n]=p,e.retroReenableEvents(),"array"===p.type?["push","unshift"].includes(i)?p[i](...v):p[i](v):"object"===p.type&&p.defineProperties(v)):!1===a&&Object.defineProperty(d,n,r)}}else Object.defineProperty(d,n,r);if(c){const t=f?[f,n].join("."):String(n);if(c["defineProperty:$key"]){b.anter=d[n];const s=["defineProperty",n].join(":");e.dispatchEvent(new ye(s,{path:t,value:v,change:b,detail:{prop:n,descriptor:r}},e))}c.defineProperty&&(y.anter=d[n],e.dispatchEvent(new ye("defineProperty",{path:t,value:v,change:y,detail:{prop:n,descriptor:r}},e)))}return e},freeze:function(e,t){const{recursive:n,mutatorEvents:r}=t,{target:s}=e;if(!0===n)for(const[t,n]of Object.entries(s))n instanceof e.constructor&&(n.freeze(),r&&r.freezeProperty&&e.dispatchEvent(new ye("freezeProperty",{path:n.path},e)));return Object.freeze(s),r&&r.freeze&&e.dispatchEvent(new ye("freeze",{path:e.path},e)),e},seal:function(e,t){const{recursive:n,mutatorEvents:r}=t,{target:s}=e;if(!0===n)for(const[t,n]of Object.entries(s))n instanceof e.constructor&&(n.seal(),r&&r.sealProperty&&e.dispatchEvent(new ye("sealProperty",{path:n.path},e)));return Object.seal(s),r&&r.seal&&e.dispatchEvent(new ye("seal",{path:e.path},e)),e}};const{typedObjectLiteral:Ae}=A;const{typedObjectLiteral:$e}=A;const{recursiveAssign:De,typedObjectLiteral:Se,typeOf:Te}=A;const{typedObjectLiteral:_e}=A;const{recursiveAssign:Le,typedObjectLiteral:qe,typeOf:Ve}=A;var Ce={concat:function(e,t){const{target:n,path:r,schema:s}=e,{enableValidation:i,mutatorEvents:a,source:o,validationEvents:c}=t,l=[].concat(...arguments);let p=n.length;const u=[];let d,f=[...Array.from(n)];e:for(let t of l){if(s&&i){const t=e.valueOf(),n=o||Ae(t),r=s.validateProperty(p,$subvalue,n,t);if(s&&c){let t,n;r.valid?(t="validProperty",n=["validProperty",p].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",p].join(":"));for(const s of[t,n])e.dispatchEvent(new je(s,r,e))}if(!r.valid){p++;continue e}}const n=r?[r,p].join("."):String(p);if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());let r=s?.target[0].type.value||null;const i=Ae(t);let a=new e.constructor(i,r,{path:n,parent:e});a.concat(t),u[p]=a}else u[p]=t;if(f=Array.prototype.concat.call(f,u[p]),a){const t=r?[r,p].join("."):String(p);a.concatElement&&e.dispatchEvent(new ye("concatElement",{path:t,value:u[p],detail:{valueIndex:p,value:u[p]}},e)),a["concatElement:$index"]&&e.dispatchEvent(new ye("concatElement",{path:t,value:u[p],detail:{valueIndex:p,value:u[p]}},e))}p++}return d=new e.constructor(f,s,e.options),a&&a.concat&&e.dispatchEvent(new ye("concat",{path:r,detail:{values:d}},e)),d},copyWithin:function(e,t){const{target:n,path:r}=e,{enableValidation:s,validationEvents:i,mutatorEvents:a}=t,o=arguments[0]>=0?arguments[0]:n.length=arguments[0],c=arguments[1]>=0?arguments[1]:n.length+arguments[1],l=void 0===arguments[2]?n.length:arguments[2]>=0?arguments[2]:n.length+arguments[2],p=[];let u=c,d=o;for(;u<l;){const t=n[u];if(p.push(t),Array.prototype.copyWithin.call(n,d,u,u+1),e.retroReenableEvents(),a){const n=r?[r,u].join("."):String(u);if(a.copyWithinElement&&e.dispatchEvent(new ye("copyWithinElement",{path:n,value:t,detail:{target:d,start:u,end:u+1,item:t}},e)),a["copyWithinElement:$index"]){const r=["copyWithinElement",u].join(":");e.dispatchEvent(new ye(r,{path:n,value:t,detail:{target:d,start:u,end:u+1,item:t}},e))}}u++,d++}return a&&a.copyWithin&&e.dispatchEvent(new ye("copyWithin",{path:r,detail:{target:o,start:c,end:l,items:p}},e)),e},fill:function(e,t,...n){const r=Object.assign({},t),{target:s,path:i,schema:a}=e,o=r.assignObject,c=r.assignArray||o,{enableValidation:l,lengthen:p,mutatorEvents:u,validationEvents:d}=r,f=[];let h,v;h="number"==typeof n[1]?n[1]>=0?n[1]:s.length+n[1]:0,v="number"==typeof n[2]?n[2]>=0?n[2]:s.length+n[2]:s.length,p&&s.length<v&&(s.length=v);let g=h;e:for(;g<s.length&&g<v;){if(a&&l){let t=a.validate(t,e.valueOf());if(d){let n,r;t.valid?(n="validProperty",r=["validProperty",g].join(":")):(n="nonvalidProperty",r=["nonvalidProperty",g].join(":"));for(const s of[n,r])e.dispatchEvent(new je(s,t,e))}if(!t.valid)continue e}const t=i?[i,g].join("."):String(g);let p,h=n[0];if(h&&"object"==typeof h){h instanceof e.constructor&&(h=h.valueOf());const n=a?.target[0].type.value||null,s=$e(h),i=Object.assign({},r,{path:t,parent:e});p=new e.constructor(s,n,i)}if(Array.prototype.fill.call(s,p,g,g+1),e.retroReenableEvents(),"array"===p.type?["push","unshift"].includes(c)?p[c](...h):p[c](h):"object"===p.type&&p[o](h),f.push(p),u){const t=i?[i,g].join("."):String(g);if(u.fillElement&&e.dispatchEvent(new ye("fillElement",{path:t,value:p,detail:{start:g,end:g+1,value:p}},e)),u["fillElement:$index"]){const n=["fillElement",g].join(":");e.dispatchEvent(new ye(n,{path:t,detail:{start:g,end:g+1,value:p}},e))}}g++}return u&&u.fill&&e.dispatchEvent(new ye("fill",{path:i,detail:{start:h,end:v,filled:f}},e)),e},pop:function(e,t){const{mutatorEvents:n}=t,{target:r,path:s}=e,i=Array.prototype.pop.call(r),a=r.length-1;if(e.retroReenableEvents(),n&&n.pop){const t=s?[s,a].join("."):String(a);e.dispatchEvent(new ye("pop",{path:t,value:i,detail:{elementIndex:a,element:i}},e))}return i},push:function(e,t,...n){const r=Object.assign({},t),s="push",i=r.assignObject,{enableValidation:a,mutatorEvents:o,source:c,validationEvents:l}=r,{target:p,path:u,schema:d}=e,f=[];let h=0;for(let t of n){let n;if(d&&a){const n=e.valueOf(),r=c||Se(n),s=d.validateProperty(h,t,r,n);if(l){let t,n;s.valid?(t="validProperty",n=["validProperty",h].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",h].join(":"));for(const r of[t,n])e.dispatchEvent(new je(r,s,e))}if(!s.valid)return p.length}const v=u?[u,h].join("."):String(h);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const a=d?.target[0].type.value||null,o=Se(Te(t)),c=Object.assign({},r,{path:v,parent:e});n=new e.constructor(o,a,c),Array.prototype.push.call(p,n),e.retroReenableEvents(),"array"===n.type?["push","unshift"].includes(s)?n[s](...t):n[s](t):"object"===n.type&&n[i](t)}else n=t,Array.prototype.push.call(p,n);if(f.push(n),o){const t=u?[u,h].join("."):String(h);if(o.pushElement&&e.dispatchEvent(new ye("pushElement",{path:t,value:f[h],detail:{elementsIndex:h,element:f[h]}},e)),o["pushElement:$index"]){const n=["pushElement",h].join(":");e.dispatchEvent(new ye(n,{path:t,value:f[h],detail:{elementsIndex:h,element:f[h]}},e))}}h++}return o&&o.push&&e.dispatchEvent(new ye("push",{path:u,detail:{elements:f}},e)),p.length},reverse:function(e,t){const{mutatorEvents:n}=t,{target:r,path:s}=e;return Array.prototype.reverse.call(r,...arguments),e.retroReenableEvents(),n&&n.reverse&&e.dispatchEvent(new ye("reverse",{path:s,detail:{reference:r}},e)),e},shift:function(e,t){const{mutatorEvents:n}=t,{target:r,path:s}=e,i=Array.prototype.shift.call(r),a=0;if(e.retroReenableEvents(),n&&n.shift){const t=s?[s,a].join("."):String(a);e.dispatchEvent(new ye("shift",{path:t,value:i,detail:{elementIndex:a,element:i}},e))}return i},splice:function(e,t){const n=Object.assign({},t),r=n.assignObject,s=n.assignArray||r,{mutatorEvents:i,source:a}=n,{target:o,path:c,schema:l}=e,{enableValidation:p,validationEvents:u}=n,d=[...arguments],f=d[0]>=0?d[0]:o.length+d[0],h=d[1]<=0?0:void 0===d[1]||f+d[1]>=o.length?o.length-f:d[1],v=d.slice(2),g=v.length,y=[];let b=0;for(;b<h;){const t=Array.prototype.splice.call(o,f,1)[0];if(y.push(t),i){const n=c?[c,b].join("."):String(b);if(i.spliceDeleteElement&&e.dispatchEvent(new ye("spliceDeleteElement",{path:n,value:t,detail:{index:f+b,deleteIndex:b,deleteItem:t}},e)),i["spliceDeleteElement:$index"]){const r=["spliceDeleteElement",b].join(":");e.dispatchEvent(new ye(r,{path:n,value:t,detail:{index:f+b,deleteIndex:b,deleteItem:t}},e))}}b++}let j=0;e:for(;j<g;){let t=v[j];if(l&&p){const t=e.valueOf(),n=a||_e(t),r=l.validateProperty(elementIndex,element,n,t);if(u){let t,n;r.valid?(t="validProperty",n=["validProperty",j].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",j].join(":"));for(const s of[t,n])e.dispatchEvent(new ValidatorEvent(s,r,e))}if(!r.valid){j++;continue e}}const d=c?[c,j].join("."):String(j);let h=f+j;if(t&&"object"==typeof t){t instanceof e.constructor&&(t=t.valueOf());const i=l?.target[0].type.value||null,a=_e(t),c=recursiveAssign({},n,{path:d,parent:e});t=new e.constructor(a,i,c),Array.prototype.splice.call(o,h,0,t),e.retroReenableEvents(),"array"===t.type?["push","unshift"].includes(s)?t[s](...$value):t[s]($value):"object"===t.type&&t[r]($value)}else Array.prototype.splice.call(o,h,0,t);if(i){const n=c?[c,j].join("."):String(j);if(i.spliceAddElement&&e.dispatchEvent(new ye("spliceAddElement",{path:n,value:t,detail:{index:f+j,addIndex:j,addItem:t}},e)),i["spliceAddElement:$index"]){const r=["spliceAddElement",j].join(":");e.dispatchEvent(new ye(r,{path:n,value:t,detail:{index:f+j,addIndex:j,addItem:t}},e))}}j++}return i&&i.splice&&e.dispatchEvent(new ye("splice",{path:c,detail:{$start:f,deleted:y,added:v,length:o.length}},e)),y},unshift:function(e,t,...n){const r=Object.assign({},t),s=r.assignObject,{enableValidation:i,mutatorEvents:a,source:o,validationEvents:c}=r,{target:l,path:p,schema:u}=e,d=[];let f=0;for(let t of n){let n;if(u&&i){const n=e.valueOf(),r=o||qe(n),s=u.validateProperty(f,t,r,n);if(c){let t,n;s.valid?(t="validProperty",n=["validProperty",f].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",f].join(":"));for(const r of[t,n])e.dispatchEvent(new ValidatorEvent(r,s,e))}if(!s.valid)return l.length}const h=p?[p,f].join("."):String(f);if(t&&"object"==typeof t){t=t instanceof e.constructor?t.valueOf():t;const i=u?.target[0].type.value||null,a=qe(Ve(t)),o=Object.assign({},r,{path:h,parent:e});n=new e.constructor(a,i,o),Array.prototype.unshift.call(l,n),e.retroReenableEvents(),"array"===n.type?n.unshift(...t):"object"===n.type&&n[s](t)}else n=t,Array.prototype.unshift.call(l,n);if(d.unshift(n),a){const t=p?[p,f].join("."):String(f);if(a.unshiftElement&&e.dispatchEvent(new ye("unshiftElement",{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e)),a["unshiftElement:$index"]){const n=["unshiftElement",f].join(":");e.dispatchEvent(new ye(n,{path:t,value:d[f],detail:{elementsIndex:f,element:d[f]}},e))}}f++}return a&&a.unshift&&e.dispatchEvent(new ye("unshift",{path:p,detail:{elements:d}},e)),l.length}};const{regularExpressions:Re}=A;const{recursiveAssign:ze}=A;const{recursiveAssign:Ne,regularExpressions:Be,typedObjectLiteral:Ie,typeOf:Ke}=A;const{recursiveAssign:Me}=A;const{regularExpressions:Fe}=A;const{recursiveAssign:Ue}=A;var We={get:function(e,t,...n){let r;const s=t;return"string"==typeof n[0]?(2===n.length&&ze(s,n[1]),r=function(e,t,n){const{target:r,path:s}=e,{mutatorEvents:i,pathkey:a,subpathError:o}=t;if(!0===a){const a=n.split(new RegExp(Re.quotationEscape)),c=a.shift();let l=r[c];if(a.length){if(!1===o&&void 0===l)return;return l.get(a.join("."),t)}if(i&&(i.getProperty&&e.dispatchEvent(new ye("getProperty",{path:s,value:l,detail:{key:c,value:l}},e)),i["getProperty:$key"])){const t=["getProperty",c].join(":"),n=[s,c].join(".");e.dispatchEvent(new ye(t,{path:n,detail:{value:l}},e))}return l}if(!1===a)return r[propertyKey]}(e,s,...n)):(1===n.length&&ze(s,n[0]),r=function(e,t){const{path:n}=e,{mutatorEvents:r}=t;return r&&r.get&&e.dispatchEvent(new ye("get",{path:n,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,s,...n)),r},set:function(e,t,...n){let r;const s=t;return"string"==typeof n[0]?(3===n.length&&Me(s,n[2]),r=function(e,t,n,r){const s=Object.assign({},t),i="set",a=s.assignArray||"set",{target:o,path:c,schema:l}=e,{enableValidation:p,mutatorEvents:u,pathkey:d,recursive:f,subpathError:h,validationEvents:v,source:g}=s;if(!0===d){const t=n.split(new RegExp(Be.quotationEscape)),d=t.shift();let y;const b=Ke(r),j=c?[c,d].join("."):String(d);if(t.length){if(f&&void 0===o[d]){let t,n;t="array"===l?.type?l.target[0].type.value:"object"===l?.type?l.target[d].type.value:void 0,n="array"===b?[]:"object"===b||isNaN(Number(d))?{}:[];const r=Ne({},s,{path:j,parent:e});y=new e.constructor(n,t,r)}else y=o[d];if(!1===h&&void 0===y)return;return"array"===y.type?["push","unshift"].includes(a)?y[a](...r):y[a](r):"object"===y.type&&y[i](t.join("."),r,s),y}if(l&&p){const t=e.valueOf(),n=g||Ie(t),s=l.validateProperty(d,r,n,t);if(v){let t,n;s.valid?(t="validProperty",n=["validProperty",d].join(":")):(t="nonvalidProperty",n=["nonvalidProperty",d].join(":"));for(const r of[t,n])e.dispatchEvent(new je(r,s,e))}if(!s.valid)return}if(r&&"object"==typeof r){r instanceof e.constructor&&(r=r.valueOf());const t=Ke(r);let n,c;n="array"===l?.type?l.target[0].type.value:"object"===l?.type?l.target[d].type.value:void 0,c="array"===t?[]:"object"===t||isNaN(Number(d))?{}:[];const p=Ne({},s,{path:j,parent:e});y=new e.constructor(c,n,p),o[d]=y,e.retroReenableEvents(),"array"===y.type?["push","unshift"].includes(a)?y[a](...r):y[a](r):"object"===y.type&&y[i](r)}else y=r,o[d]=y;const m=y.valueOf();if(u){const t=c?[c,d].join("."):String(d);if(u.setProperty&&e.dispatchEvent(new ye("setProperty",{path:t,value:m,detail:{key:d,value:m}},e)),u["setProperty:$key"]){const n=["setProperty",d].join(":");e.dispatchEvent(new ye(n,{path:t,value:m,detail:{value:m}},e))}}return y}if(!1===d){let t=n;if(r&&"object"==typeof r){r instanceof e.constructor&&(r=r.valueOf());const n=Ke(r);let p,u;"array"===l?.type&&(p=l.target[0].type.value),p="object"===l?.type?l.target[t].type.value:void 0,u="array"===n?[]:"object"===n||isNaN(Number(t))?{}:[];const d=c?[c,t].join("."):String(t),f=Ne({},s,{path:d,parent:e});propertyValue=new e.constructor(u,p,f),o[t]=propertyValue,e.retroReenableEvents(),"array"===propertyValue.type?["push","unshift"].includes(a)?propertyValue[a](...r):propertyValue[a](r):"object"===propertyValue.type&&propertyValue[i](r)}else propertyValue=r,o[t]=propertyValue;if(u){const n=c?[c,t].join("."):String(t);if(u.setProperty&&e.dispatchEvent(new ye("setProperty",{path:n,value:_propertyValue,detail:{key:t,value:_propertyValue}},e)),u["setProperty:$key"]){const r=["setProperty",t].join(":");e.dispatchEvent(new ye(r,{path:n,value:_propertyValue,detail:{value:_propertyValue}},e))}}return propertyValue}}(e,s,...n)):(2===n.length&&Me(s,n[1]),r=function(e,t,n){const{path:r,schema:s}=e;let{enableValidation:i,mutatorEvents:a,required:o,validationEvents:c}=t;for(const[r,s]of Object.entries(n))e.set(r,s,Object.assign(t,{source:n}));return a&&a.set&&e.dispatchEvent(new ye("set",{path:r,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,s,...n)),r},delete:function(e,t,...n){let r;const s=t;return"string"==typeof n[0]?(2===n.length&&Ue(s,n[1]),r=function(e,t,n){const{target:r,path:s,schema:i}=e,{mutatorEvents:a,pathkey:o,subpathError:c,enableValidation:l,validationEvents:p}=t;if(!0!==o)if(!1!==o);else{const o=n,c=r[o];if(i&&l){const t=e.valueOf();delete t[o];const n=i.validate(o,t,e.valueOf());if(p){let t,r;n.valid?(t="validProperty",r=["validProperty",o].join(":")):(t="nonvalidProperty",r=["nonvalidProperty",o].join(":"));for(const s of[t,r])e.dispatchEvent(new je(s,n,e))}if(!n.valid)return}if(c instanceof e.constructor&&c.delete(t),delete r[o],a&&(a.deleteProperty&&e.dispatchEvent(new ye("deleteProperty",{path:s,value:c,detail:{key:o,value:c}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",o].join(":"),n=[s,o].join(".");e.dispatchEvent(new ye(t,{path:n,value:c,detail:{value:c}},e))}}else{const o=n.split(new RegExp(Fe.quotationEscape)),u=o.shift();let d=r[u];if(o.length){if(!1===c&&void 0===d)return;return d.delete(o.join("."),t)}if(i&&l){const t=e.valueOf();delete t[u];const n=i.validate(u,t,{},e.valueOf());if(p){let t,r;const i=s?[s,u].join("."):String(u);n.valid?(t="validProperty",r=["validProperty",u].join(":")):(t="nonvalidProperty",r=["nonvalidProperty",u].join(":"));for(const s of[t,r])e.dispatchEvent(new je(s,Object.assign(n,{path:i}),e))}if(!n.valid)return}if(d&&"object"==typeof d&&d.delete(t),delete r[u],a&&(a.deleteProperty&&e.dispatchEvent(new ye("deleteProperty",{path:s,value:d,detail:{key:u,value:d}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",u].join(":"),n=[s,u].join(".");e.dispatchEvent(new ye(t,{path:n,value:d,detail:{value:d}},e))}}}(e,s,...n)):(1===n.length&&Ue(s,n[0]),r=function(e,t){const{target:n}=e;for(const[r,s]of Object.entries(n))e.delete(r,t);const{path:r}=e,{mutatorEvents:s}=t;return s&&s.delete&&e.dispatchEvent(new ye("delete",{path:r,detail:{value:e.valueOf()}},e)),e}(e,s,...n)),r}};const{recursiveAssign:He,recursiveFreeze:Je}=A,Ge=Object.freeze({object:[{keys:["valueOf"],methodDescriptor:function(e,t){return{value:function(){return t.parse({type:"object"})}}}},{keys:["toString"],methodDescriptor:function(e,t){return{value:function(e={}){const n=void 0!==e.replacer?e.replacer:null,r=void 0!==e.space?e.space:0;return t.parse({type:"string",replacer:n,space:r})}}}},{keys:["entries","fromEntries","getOwnPropertyDescriptors","getOwnPropertyDescriptor","getOwnPropertyNames","groupBy","hasOwn","is","getPrototypeOf","isExtensible","isFrozen","isSealed","keys","preventExtensions","values"],methodDescriptor:function(e,t){return{value:Object[e].bind(null,t.valueOf())}}},{keys:["propertyIsEnumerable","hasOwnProperty"],methodDescriptor:function(e,t){return{value:()=>t.parse({type:"object"})[e]}}},{type:"mutators",keys:Object.keys(xe),methodDescriptor:function(e,t,n){return{value:xe[e].bind(null,t,n)}}}],array:[{keys:["length"],methodDescriptor:function(e,t,n){return{get:()=>t.target.length,set(e){t.target.length=e}}}},{keys:["from","fromAsync","isArray","of"],methodDescriptor:function(e,t){return{value:Array[e]}}},{keys:["at","every","filter","find","findIndex","findLast","findLastIndex","flat","flatMap","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","sort","toReversed","toSorted","toSpliced","with"],methodDescriptor:function(e,t){return{value:Array.prototype[e].bind(null,t)}}},{type:"mutators",keys:Object.keys(Ce),methodDescriptor:function(e,t,n){return{value:Ce[e].bind(null,t,n)}}}],map:[{type:"mutators",keys:Object.keys(We),methodDescriptor:function(e,t,n){return{value:We[e].bind(null,t,n)}}}]});const{recursiveAssign:Qe,typedObjectLiteral:Xe}=A,Ye=Object.freeze(["push","unshift"]),Ze=Object.freeze(["assign","defineProperties","set"]);const{typedObjectLiteral:et,typeOf:tt}=A;class nt extends I{constructor(e={},t=null,n={}){super({propertyDirectory:{accessors:[(e,t)=>void 0===t?e.target:e.get(t)]}});const r=e instanceof nt?e.valueOf():e;let s=null,i=null;try{Object.defineProperty(this,"mount",{value:function(e){const t=e.parent,n=e.path,r=n?n.split(".").pop():n;s&&s.unmount(r),s=t,i=n}})}catch(e){console.error(e)}try{Object.defineProperty(this,"unmount",{value:function(e){e.path;delete this[$property]}})}catch(e){console.error(e)}Object.defineProperties(this,{options:{configurable:!0,get(){const e=(e=>ge({path:null,parent:null,enableEvents:!1,enableValidation:!0,validationEvents:{"validProperty:$key":!0,validProperty:!0,"nonvalidProperty:$key":!0,nonvalidProperty:!0},pathkey:!0,subpathError:!1,assignObject:"set",assignArray:"set",methods:{map:{get:{mutatorEvents:{get:!0,getProperty:!0,"getProperty:$key":!0}},set:{recursive:!0,mutatorEvents:{set:!0,setProperty:!0,"setProperty:$key":!0}},delete:{mutatorEvents:{delete:!0,deleteProperty:!0,"deleteProperty:$key":!0}}},array:{concat:{mutatorEvents:{"concatElement:$index":!0,concatElement:!0,concat:!0}},copyWithin:{mutatorEvents:{"copyWithinElement:$index":!0,copyWithinElement:!0,copyWithin:!0}},fill:{lengthen:!0,mutatorEvents:{"fillElement:$index":!0,fillElement:!0,fill:!0}},pop:{mutatorEvents:{pop:!0}},push:{mutatorEvents:{"pushElement:$index":!0,pushElement:!0,push:!0}},reverse:{mutatorEvents:{reverse:!0}},shift:{mutatorEvents:{shift:!0}},splice:{mutatorEvents:{"spliceDeleteElement:$index":!0,spliceDeleteElement:!0,"spliceAddElement:$index":!0,spliceAddElement:!0,splice:!0}},unshift:{mutatorEvents:{"unshiftElement:$index":!0,unshiftElement:!0,unshift:!0}}},object:{assign:{sourceTree:!0,mutatorEvents:{"assignSourceProperty:$key":!0,assignSourceProperty:!0,assignSource:!0,assign:!0}},defineProperties:{descriptorTree:!0,mutatorEvents:{defineProperties:!0}},defineProperty:{descriptorTree:!0,mutatorEvents:{defineProperty:!0,"defineProperty:$key":!0}},freeze:{recursive:!0,mutatorEvents:{freezeProperty:!0,freeze:!0}},seal:{recursive:!0,mutatorEvents:{sealProperty:!0,seal:!0}}}}},e))(n);if(e.events&&(this.addEvents(e.events),delete e.events),e.enableEvents){const t=typeof e.enableEvents;"boolean"===t?this.enableEvents():"object"===t&&this.enableEvents(e.enableEvents)}return Object.defineProperty(this,"options",{value:e}),e}},parent:{get:()=>s},path:{get:()=>i},key:{get:()=>i?i.pop():i},target:{configurable:!0,get(){const e=et(r);return Object.defineProperty(this,"target",{value:e}),e}},type:{configurable:!0,get(){const e=tt(this.target);return Object.defineProperty(this,"type",{value:e}),e}},schema:{configurable:!0,get(){const e=tt(t);let n;return["undefined","null"].includes(e)?n=null:t instanceof fe?n=t:["array","object"].includes(e)&&(n=new fe(t)),Object.defineProperty(this,"schema",{value:n}),n}}}),this.mount({parent:this.options.parent,path:this.options.path}),function(e){for(const[t,n]of Object.entries(Ge))for(const r of n){const{keys:n,methodDescriptor:s,type:i}=r;for(const r of n)if("map"===t||"mutators"===i){const n=structuredClone(e.options.methods[t][r]),i=Object.assign({},e.options,n);delete i.mutatorEvents,i.mutatorEvents=n.mutatorEvents,Object.defineProperty(e,r,s(r,e,i))}else Object.defineProperty(e,r,s(r,e))}}(this),function(e,t,n){const{type:r}=e,{assignObject:s,assignArray:i}=n;"array"===r&&Ye.includes(i)?e[i](...t):["array","object"].includes(r)&&Ze.includes(s)&&e[s](t)}(this,r,this.options)}retroReenableEvents(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}parse(e={type:"object",replacer:null,space:0}){let t=et(this.type);for(const[e,n]of Object.entries(Object.getOwnPropertyDescriptors(this.target))){let{enumerable:r,value:s,writable:i,configurable:a}=n;s instanceof nt?Object.defineProperty(t,e,{enumerable:r,value:s.valueOf(),writable:i,configurable:a}):Object.defineProperty(t,e,{enumerable:r,value:s,writable:i,configurable:a})}let{type:n,replacer:r,space:s}=e;return"object"===n?t:"string"===n?JSON.stringify(t,r,s):void 0}}export{nt as Model,fe as Schema,W as Validation,G as Validator,K as Verification};
//# sourceMappingURL=objecture.min.js.map
