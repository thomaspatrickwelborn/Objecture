var e={default:(e,t)=>void 0===t?e:e[t],get:(e,t)=>void 0===t?e:e.get(t)};function t(e,t=":scope"){if(Array.isArray(e)||void 0===e)return e;const n=[];for(const[s,r]of Object.entries(e)){const e=s.trim().split(" ");let i,a,o,c;1===e.length?(i=t,a=e[0]):e.length>1&&(i=e[0],a=e[1]),Array.isArray(r)?(o=r[0],c=r[1]):o=r;const l={type:a,path:i,listener:o,enable:!1};n.push(l)}return n}const n={depth:0,maxDepth:10,accessors:[e.default]};function s(e,t){const r=[],i=Object.assign({},n,t);if(i.depth++,i.depth>i.maxDepth)return r;for(const t of i.accessors){const n=t(e);if(n)for(const[e,t]of Object.entries(n))if(r.push(e),"object"==typeof t&&null!==t&&t!==n){const n=s(t,i);for(const t of n){let n;n="object"==typeof t?[e,...t].join("."):[e,t].join("."),r.push(n)}}}return r}const r=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function i(e,...t){if(!e)return e;for(const n of t)if(n)for(const[t,s]of Object.entries(n)){const n=r(e[t]),a=r(s);e[t]="object"===n&&"object"===a?i(e[t],s):s}return e}const a={string:String,number:Number,boolean:Boolean,bigint:BigInt,undefined:void 0,null:null},o=Object.keys(a),c=Object.values(a),l={object:Object,array:Array},p=Object.keys(l),h=Object.values(l),d=Object.assign({},a,l),u=Object.keys(d),f=Object.values(d),v=[a.String,a.Number,a.Boolean,l.Object,l.Array];var g=Object.freeze({__proto__:null,ObjectKeys:p,ObjectValues:h,Objects:l,PrimitiveKeys:o,PrimitiveValues:c,Primitives:a,TypeKeys:u,TypeMethods:v,TypeValues:f,Types:d}),y=Object.freeze({__proto__:null,accessors:e,expandEvents:t,impandEvents:function(e){if(!Array.isArray(e))return e;const t={};for(const n of e){const{path:e,type:s,listener:r,options:i}=n,a=`${$path} ${$type}`;t[a]=void 0!==i?[r,i]:r}return t},isPropertyDefinition:function(e){return!!(Object.getOwnPropertyDescriptor(e,"type")&&(f.includes(e.type)||u.includes(e.type))||"object"==typeof e.type&&Object.getOwnPropertyDescriptor(e.type,"value")&&(f.includes(e.type.value)||u.includes(e.type.value)))},propertyDirectory:s,recursiveAssign:i,recursiveAssignConcat:function e(t,...n){if(!t)return t;for(const s of n)if(s)for(const[n,i]of Object.entries(s)){const s=r(t[n]),a=r(i);t[n]="object"===s&&"object"===a?e(t[n],i):"array"===s&&"array"===a?t[n].concat(i):i}return t},recursiveFreeze:function e(t){for(const[n,s]of Object.entries(t))s&&"object"==typeof s&&e(s);return Object.freeze(t)},regularExpressions:{quotationEscape:/\.(?=(?:[^"]*"[^"]*")*[^"]*$)/},typeOf:r,typedObjectLiteral:function(e){let t;const n=r(e);return"object"===n?t={}:"array"===n?t=[]:"string"===n?"object"===e?t={}:"array"===e&&(t=[]):t=void 0,t},variables:g});function b(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var s=e.substr(0,t),r=e.substr(t+2);if(s.length>0&&r.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function j(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,s=0,r=0,i=-1,a=[""],o=[],c=0;c<e.length;c++){var l=e[c];if("\\"!==l){if("{"===l)if(n)s++;else if(c>i&&!s){t=e.substring(i+1,c);for(var p=0;p<a.length;p++)a[p]+=t;o=[],i=c,n=!0,s++}else s--;else if("}"===l)if(n)r++;else if(1===r){if(t=e.substring(i+1,c),o.length>0){var h=[];o.push(j(t));for(p=0;p<a.length;p++)for(var d=0;d<o.length;d++)for(var u=0;u<o[d].length;u++)h.push(a[p]+o[d][u]);a=h}else{t=b(t);for(p=0;p<a.length;p++)a[p]+=t}i=c,r--}else r--;else n||","!==l||r-s!=1||(t=e.substring(i+1,c),o.push(j(t)),i=c);!n||r!==s&&c!==e.length-1||(n=!1,c=i-1)}else c++}if(-1===i)return[e];var f="{"===e[i]?i:i+1;if(f<e.length){t=e.substr(f);for(p=0;p<a.length;p++)a[p]+=t}return a}function m(e,t){var n,s=!1!==t["!"],r=!1!==t["()"],i=!1;if(s){for(n=0;n<e.length&&"!"===e[n];n++){if(r&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function P(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function E(e,t,n){var s=void 0===t.separator||t.separator,r="",i="",a=".";!0===s?(r="/",i="[/\\\\]",a="[^/\\\\]"):a=s?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=P(e[n]);return t}(r=s)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var o=s?i+"+?":"",c=s?i+"*?":"",l=s?e.split(r):[e];return{source:e,segments:l,options:t,separator:s,separatorSplitter:r,separatorMatcher:i,optionalSeparator:c,requiredSeparator:o,wildcard:a,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:s&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function O(e,t,n,s){return{source:e,isFirst:n,isLast:s,end:e.length-1}}var x="(?!\\.)";function w(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=x+t),e.dotHandled=!0,e.result.match+=t),e.result}function k(e,t,n){var s=e.support,r=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(s.excludeDot||(r.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:w(r,i);if(s.globstar&&"**"===t.source)return w(r,"(?:"+((r.dotHandled?"":x)+e.wildcard+"*?"+i)+")*?");for(;++r.i<=t.end;){if(r.char=r.segment.source[r.i],r.nextChar=r.i<t.end?t.source[r.i+1]:"","\\"===r.char){if(r.i<r.segment.end){r.escapeChar=!0;continue}r.char=""}e=r.pattern,t=r.segment;var a=r.char,o=r.i;if(e.support.brackets&&!r.scanningForParens){if(o>r.openingBracket&&o<=r.closingBracket){r.escapeChar?w(r,P(a)):o===r.closingBracket?(w(r,"]"),r.openingBracket=t.source.length):"-"===a&&o===r.closingBracket-1?w(r,"\\-"):"!"===a&&o===r.openingBracket+1?w(r,"^"):w(r,"]"===a?"\\]":a),r.escapeChar=!1;continue}if(o>r.openingBracket){"]"===a&&!r.escapeChar&&o>r.openingBracket+1&&o>r.closingBracket?(r.closingBracket=o,r.i=r.openingBracket,e.separator?w(r,"(?!"+e.separatorMatcher+")[",!0):w(r,"[",!0)):o===t.end&&(w(r,"\\["),r.i=r.openingBracket,r.openingBracket=t.source.length,r.closingBracket=t.source.length),r.escapeChar=!1;continue}if("["===a&&!r.escapeChar&&o>r.closingBracket&&o<t.end){r.openingBracket=o,r.escapeChar=!1;continue}}if(r.pattern.support.extglobs){var c=r.extglobModifiers,l=(a=r.char,r.nextChar);o=r.i;if("("!==l||r.escapeChar||"@"!==a&&"?"!==a&&"*"!==a&&"+"!==a&&"!"!==a){if(")"!==a||r.escapeChar){if("|"===a&&r.closingParens&&!r.scanningForParens&&!r.escapeChar){w(r,"|");continue}}else if(r.scanningForParens)r.closingParens++;else if(c.length){var p=c.pop();if("!"===p&&-1!==c.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");w(r,")"+(p="!"===p||"@"===p?"":p)),r.addToMatch=!0,r.addToUnmatch=!0,r.closingParens--;continue}}else if(r.scanningForParens)r.openingParens++;else if(o>r.parensHandledUntil&&!r.closingParens)r.parensHandledUntil=o,r.scanningForParens=!0,r.openingParens++;else{if(r.closingParens>=r.openingParens){"!"===a&&(r.addToMatch=!0,r.addToUnmatch=!1,w(r,r.pattern.wildcard+"*?",!0),r.addToMatch=!1,r.addToUnmatch=!0,r.result.useUnmatch=!0),c.push(a),w(r,"(?:",!0),r.openingParens--,r.i++;continue}r.openingParens--}if(r.scanningForParens){r.closingParens!==r.openingParens&&o!==r.segment.end||(r.scanningForParens=!1,r.i=r.parensHandledUntil-1),r.escapeChar=!1;continue}}s=(e=r.pattern).support;!r.escapeChar&&s.star&&"*"===r.char?r.i!==r.segment.end&&"*"===r.nextChar||w(r,e.wildcard+"*?",!0):!r.escapeChar&&s.qMark&&"?"===r.char?w(r,e.wildcard,!0):w(r,P(r.char)),r.escapeChar=!1}return w(r,i)}function S(e,t,n){for(var s=E(e,t,n),r={match:"",unmatch:"",useUnmatch:!1},i=s.segments,a=0;a<i.length;a++){k(s,O(i[a],0,0===a,a===i.length-1),r)}return r.useUnmatch?"(?!^"+r.unmatch+"$)"+r.match:r.match}function $(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function A(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],s=0;s<e.length;s++)for(var r=t(e[s]),i=0;i<r.length;i++)n.push(r[i]);return n}(e,j));for(var n=[],s=[],r="",i=0;i<e.length;i++){var a=m(e[i],t),o=S(a.pattern,t,!a.isNegated);a.isNegated?s.push(o):n.push(o)}return s.length&&(r="(?!(?:"+s.join("|")+")$)"),n.length>1?r+="(?:"+n.join("|")+")":1===n.length?r+=n[0]:r.length&&(r+=S("**",t,!0)),"^"+r+"$"}(e,t),s=new RegExp(n,t.flags),r=$.bind(null,s);return r.options=t,r.pattern=e,r.regexp=s,r}class D{#e;#t;#n;#s=!1;#r;#i=[];#a=[];#o=[];#c=[];#l=[];#p;#h;#d;constructor(t,n){if(!t||!n)return this;this.#e=((t={})=>{const n={enable:!1,accessors:[e.default],propertyDirectory:{scopeKey:t.scopeKey,maxDepth:10},assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent",bindListener:!0,scopeKey:":scope",methods:{assign:{addEventListener:function(e,t){const{type:n,listener:s,settings:r}=e,{options:i,useCapture:a}=r;return t.addEventListener(n,s,i||a)},on:function(e,t){const{type:n,listener:s}=e;return t.on(n,s)},once:function(e,t){const{type:n,listener:s}=e;return t.once(n,s)}},deassign:{removeEventListener:function(e,t){const{type:n,listener:s,settings:r}=e,{options:i,useCapture:a}=r;return t.removeEventListener(n,s,i||a)},off:function(e,t){const{type:n,listener:s}=e;return t.off(n,s)}},transsign:{dispatchEvent:function(e,t,n){return t.dispatchEvent(n)},emit:function(e,t,n,...s){return t.emit(n,...s)}}}};for(const[e,s]of Object.entries(t))switch(e){case"propertyDirectory":n[e]=Object.assign(n[e],s);break;case"accessors":n[e]=s,n.propertyDirectory[e]=s;break;case"methods":n[e]=i(n[e],s);break;case"enableEvents":break;default:n[e]=s}return n})(t),this.#t=n,this.enable=this.settings.enable}get settings(){return this.#e}get path(){return this.settings.path}get type(){return this.settings.type}get listener(){if(void 0!==this.#n)return this.#n;const e=this.settings.listener;return!0===this.settings.bindListener?this.#n=e.bind(this.#t):this.#n=e,this.#n}get enable(){return this.#s}set enable(e){const t=this.#u,n=this.#i,s=this.#a;n.length=0,s.length=0;for(const r of t){const{path:t,target:i,enable:a}=r;this.settings;if(a!==e)if(!0===e)try{this.#f(i),r.enable=e,n.push(r)}catch(e){console.error(e)}else if(!1===e)try{this.#v(i),r.enable=e,s.push(r)}catch(e){console.error(e)}}this.#s=e}get assigned(){return this.#i}get deassigned(){return this.#a}get#g(){return this.settings.target}get#u(){const e=this.#l,t=[];if(this.#g)for(const n of[].concat(this.#g)){const s=e.find((e=>e?.path===this.path));void 0!==s?t.push(s):void 0===s&&t.push({path:this.path,target:n,enable:!1})}else if("string"===r(this.path)){const n=[];if(this.path===this.#y){const e={path:this.path,target:this.#t,enable:!1};t.push(e)}else{if(this.settings.propertyDirectory){const e=this.#b,t=A(this.path,{separator:"."});for(const s of e){!0===t(s)&&n.push(s)}"*"===this.path.charAt(0)&&n.unshift(this.#y)}else n.push(this.path);for(const s of n){const n=e.find((e=>e.path===s));let r,i=this.#t;const a=s.split(".");let o=0;e:for(;o<a.length;){let e=a[o];if(e===this.#y)break e;t:for(const t of this.settings.accessors)if(i=t(i,e),void 0!==i)break t;o++}void 0!==i&&(i===n?.target?r=n:"object"==typeof i&&(r={path:s,target:i,enable:!1})),void 0!==r&&t.push(r)}}}return this.#l=t,this.#l}get#y(){return this.settings.scopeKey}get#f(){return void 0!==this.#p||(this.#p=this.settings.methods.assign[this.settings.assign].bind(null,this)),this.#p}get#v(){return void 0!==this.#h||(this.#h=this.settings.methods.deassign[this.settings.deassign].bind(null,this)),this.#h}get#j(){return void 0!==this.#d||(this.#d=this.settings.methods.transsign[this.settings.transsign].bind(null,this)),this.#d}get#m(){return this.settings.methods}get#b(){if(!this.settings.propertyDirectory)return null;const e=(this.settings.accessors,this.settings.propertyDirectory);return s(this.#t,e)}emit(){const e=this.#u,t=this.#o,n=this.#c;t.length=0,n.length=0;for(const s of e){const{target:e}=s;try{this.#j(e,...arguments),t.push(s)}catch(e){n.push(s)}}return this}}class V extends EventTarget{static implement=function(e,n){if(!e||!n)return;const s=((e={})=>{const t={events:{},enableEvents:!1,propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents",emitEvents:"emitEvents"}};for(const[n,s]of Object.entries(e))t[n]="propertyDefinitions"===n?Object.assign(t[n],s):s;return t})(n),r=[];return Object.defineProperties(e,{[s.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments[0])return r;const e=[],t=[].concat(arguments[0]);for(const n of t)for(const t of r){let s;e:for(const[e,r]of Object.entries(n)){let n;if(n="listener"===e?t.settings[e]===r:t[e]===r,!1===s)break e;s=n}!0===s&&e.push(t)}return e}},[s.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){if(!arguments.length)return e;let n=t(arguments[0],s.scopeKey);for(let t of n){const n={};for(const e of["accessors","assign","deassign","transsign","propertyDirectory"]){const t=s[e];void 0!==t&&(n[e]=t)}i(n,t);const a=new D(n,e);r.push(a)}return e}},[s.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[s.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;let n=r.length-1;for(;n>-1;){const e=r[n];t.includes(e)&&(e.enable=!1,r.splice(n,1)),n--}return e}},[s.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[s.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!0;return e}},[s.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[s.propertyDefinitions.getEvents](arguments[0]);if(0===t.length)return e;for(const e of t)e.enable=!1;return e}},[s.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){const t=e[s.propertyDefinitions.getEvents](arguments[0]);for(const e of t)e.enable=!1,e.enable=!0;return e}},[s.propertyDefinitions.emitEvents]:{enumerable:!1,writable:!1,value:function(t,...n){const r=e[s.propertyDefinitions.getEvents](t);for(const e of r)e.emit(...n);return e}}}),s.events&&e[s.propertyDefinitions.addEvents](s.events),!0===s.enableEvents&&e[s.propertyDefinitions.enableEvents](),e};constructor(e={}){return super(),V.implement(this,e)}}class _ extends EventTarget{#e;#P;#E;constructor(e){super(),this.#e=e}get type(){return this.#e.type}get definition(){return this.#e.definition}get key(){return this.#e.key}get value(){return this.#e.value}get message(){return void 0!==this.#P||void 0!==this.pass&&void 0===this.#P&&(this.#P=this.#e.messages[String(this.pass)](this)),this.#P}get pass(){return this.#E}set pass(e){void 0===this.#E&&(this.#E=e)}}const{recursiveAssign:q}=y,T={true:e=>`${e.pass}`,false:e=>`${e.pass}`};class I extends EventTarget{#O;#x;#w;constructor(e={},t){super(),this.definition=Object.freeze(Object.assign({messages:T},e)),this.schema=t}get definition(){return this.#x}set definition(e){this.#x=e}get schema(){return this.#w}set schema(e){return void 0!==this.#w||(this.#w=e),this.#w}get type(){return this.definition.type}get messages(){return this.definition.messages}get validate(){return this.#O=function(e,t,n,s){const r=this.definition,i=new _({type:this.type,definition:r,key:e,value:t,messages:q({},this.messages,r.messages)});return i.pass=r.validate(...arguments),i}.bind(this),this.#O}}const{recursiveAssign:L,typedObjectLiteral:M}=y;class C extends I{constructor(e,t){super(Object.assign(e,{type:"required",validate:(e,t,n,s)=>{this.definition;let r;const{requiredProperties:i,requiredPropertiesSize:a,type:o}=this.schema;if(0===a)r=!0;else if("object"===o){const t=M(o),a=M(o);e:for(const[r,o]of Object.entries(i)){const i=L({},o);if(i.required.value=!1,r===e)continue e;const c=Object.getOwnPropertyDescriptor(n,r);if(void 0!==c)t[r]=i,a[r]=c.value;else if(s){if(void 0!==Object.getOwnPropertyDescriptor(s,r))continue e;t[r]=i}else t[r]=i}const c=Object.keys(t).length,l=Object.keys(a).length;if(0===c&&0===l)r=!0;else if(c!==l)r=!1;else{const e=new ie(t,Object.assign({},this.schema.options,{required:!1})),i=[];for(const[t,r]of Object.entries(a)){const r=a[t],o=e.validateProperty(t,r,n,s);i.push(o)}r=!i.find((e=>!1===e.valid))}}else"array"===o&&(r=!0);return r}}),t)}}const{typeOf:z,variables:B}=y,{PrimitiveKeys:N,ObjectKeys:K}=B;class F extends I{constructor(e={},t){super(Object.assign(e,{type:"type",validate:(e,t)=>{let n;const s=this.definition,r="function"===z(s.value)?z(s.value()):r;if(N.concat(K).includes(r)){const e=z(t);n="undefined"!==e&&("undefined"===r||r===e)}else n=!1;return n}}),t)}}class U extends I{constructor(e={},t){super(Object.assign(e,{type:"range",validate:(e,t)=>{const n=this.definition;let s;if("number"!=typeof t)s=!1;else{const{min:e,max:r}=n;let i,a;i=void 0===e||t>=e.value,a=void 0===r||t<=r.value,s=!(!i||!a)}return s}}),t)}}class W extends I{constructor(e={},t){super(Object.assign(e,{type:"length",validate:(e,t)=>{const n=this.definition;let s;if("string"!=typeof t)s=!1;else{const{min:e,max:r}=n;let i,a;i=void 0===e||t.length>=e.value,a=void 0===r||t.length<=r.value,s=!(!i||!a)}return s}}),t)}}class H extends I{constructor(e={},t){super(Object.assign(e,{type:"enum",validate:(e,t)=>{const n=this.definition;let s;if(["string","number","boolean"].includes(typeof t)){s=n.value.includes(t)}else s=!1;return s}}),t)}}class R extends I{constructor(e={},t){super(Object.assign(e,{type:"match",validate:(e,t)=>{const n=this.settings;let s;if(["string","number","boolean"].includes(typeof t)){n.value.exec(t)}else s=!1;return!!s}}),t)}}class J{#t;constructor(e){this.#t=e}}const{expandTree:G,isPropertyDefinition:Q,typedObjectLiteral:X,typeOf:Y,variables:Z}=y;class ee extends EventTarget{#k;#w;#S;#$;#g;#A;constructor(e,t){return super(),this.#k=e,this.schema=t,this.proxy}get required(){return this.schema.options.required}get schema(){return this.#w}set schema(e){if(void 0===this.#w)return this.#w=e,this.#w}get type(){return void 0!==this.#S||(this.#S=Y(X(this.#k))),this.#S}get proxy(){return void 0!==this.#$||(this.#$=new Proxy(this.target,this.#D)),this.#$}get#D(){return void 0!==this.#A||(this.#A=new J(this)),this.#A}get target(){if(void 0!==this.#g)return this.#g;let e;const t=X(this.type);"array"===this.type?e=this.#k.slice(0,1):"object"===this.type&&(e=this.#k);for(const[n,s]of Object.entries(e)){const e=Y(s);let r;if(s instanceof ie)r=s;else if(Variables.TypeValues.includes(s))r=G(s,"type.value");else if(Variables.TypeKeys.includes(s))r=G(Variables.TypeValues[Variables.TypeKeys.indexOf(s)],"type.value");else if("object"===e||"array"===e){let e=Q(s);if(!1===e){const{path:e}=this.schema,t=e?[e,n].join("."):String(n),i=this.schema;r=new ie(s,Object.assign({},this.schema.options,{path:t,parent:i}))}else if(!0===e){r={validators:[]};e:for(const[e,t]of Object.entries(s)){if("validators"===e)continue e;const n=Y(t);let s;s=n&&"object"===n?t:{value:t},r[e]=s}s.validators=s.validators||[];for(const e of s.validators)for(const t of[C,F,U,W,H,R])e instanceof t==!1&&r.validators.push(e)}}r instanceof ie==!1&&(r=this.#V(r)),t[n]=r}return this.#g=t,this.#g}#V(e){const t=e;t.validators=[];const n=new Map,s=this.required,{required:r,type:i,range:a,min:o,max:c,length:l,minLength:p,maxLength:h,match:d}=t;!0===s||!0===r?.value?n.set("required",Object.assign({},t.required,{type:"required",value:!0,validator:C})):n.set("required",Object.assign({},t.required,{type:"required",value:!1,validator:C})),i?n.set("type",Object.assign({},i,{type:"type",validator:F})):n.set("type",Object.assign({},i,{type:"type",value:void 0,validator:F})),a?n.set("range",Object.assign({},a,{type:"range",validator:U})):(o||c)&&n.set("range",Object.assign({},{type:"range",min:o,max:c,validator:U})),l?n.set("length",Object.assign({},l,{type:"length",validator:W})):(p||h)&&n.set("length",Object.assign({},{type:"length",min:p,max:h,validator:W})),t.enum&&n.set("enum",Object.assign({},t.enum,{type:"enum",validator:H})),d&&n.set("match",Object.assign({},d,{type:"match",validator:R})),delete t.min,delete t.max,delete t.minLength,delete t.maxLength;for(const[e,s]of n.entries()){const n=s.validator;t[e]=s,t.validators.push(new n(s,this.schema))}return t}}const te={true:e=>`${e.valid}`,false:e=>`${e.valid}`};class ne extends EventTarget{#e;#k;#_;#q=[];#T=[];#I=[];constructor(e={}){super(),this.#e=Object.assign({messages:te},e)}get definition(){return this.#e.definition}get path(){return this.#e.path}get key(){return this.#e.key}get value(){return this.#e.value}get properties(){return void 0!==this.#k||(this.#k=this.#e.properties),this.#k}get advance(){return this.#q}get deadvance(){return this.#T}get unadvance(){return this.#I}get valid(){return this.#_}set valid(e){void 0===this.#_&&(this.#_=e)}}const{typedObjectLiteral:se,typeOf:re}=y;class ie extends EventTarget{#k;options;#S;#t;#L;#M;#r;#C;#z;constructor(e={},t={}){super(),this.#k=e,this.options=((...e)=>Object.assign({required:!1,verificationType:"all"},...e))(t)}get type(){return void 0!==this.#S||(this.#S=re(this.#k)),this.#S}get parent(){return void 0!==this.#L||(this.#L=this.options.parent?this.options.parent:null),this.#L}get root(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}get key(){return void 0!==this.#M||(this.path?this.#M=this.path.split(".").pop():this.#M=null),this.#M}get path(){return void 0!==this.#r||(this.#r=this.options.path?String(this.options.path):null),this.#r}get required(){return this.options.required}get requiredProperties(){if(void 0!==this.#C)return this.#C;let e=se(this.type);for(const[t,n]of Object.entries(this.context))!0===n.required?.value&&(e[t]=n);return this.#C=e,this.#C}get requiredPropertiesSize(){return void 0!==this.#z||(this.#z=Object.keys(this.requiredProperties).length),this.#z}get verificationType(){return this.options.verificationType}get context(){return void 0!==this.#t||(this.#t=new ee(this.#k,this)),this.#t}#B(){let e,t,n,s=[...arguments];return 1===s.length?(e=null,t=s.shift(),n=null):2===s.length&&"string"==typeof s[0]?(e=s.shift(),t=s.shift(),n=null):2===s.length&&"object"==typeof s[0]?(e=null,t=s.shift(),n=s.shift()):3===s.length&&"string"==typeof s[0]&&(e=s.shift(),t=s.shift(),n=s.shift()),{$sourceName:e,$source:t,$target:n}}validate(){const{$sourceName:e,$source:t,$target:n}=this.#B(...arguments),s=new ne({definition:this.context,path:this.path,key:e,value:t,properties:se(this.type)}),r=Object.entries(t);let i=0,a=[];for(;i<r.length;){const[e,o]=r[i],c=this.validateProperty(e,o,t,n),l=c.deadvance.filter((e=>"required"===e.type));s.properties[e]=c,!0===c.valid?s.advance.push(c):!1===c.valid?s.deadvance.push(c):void 0===c.valid&&s.unadvance.push(c),a=a.concat(l),i++}return!0===this.required?s.deadvance.length?s.valid=!1:s.advance.length?s.valid=!0:s.unadvance.length?s.valid=void 0:s.valid=!1:!1===this.required&&(a.length?s.valid=!1:s.advance.length?s.valid=!0:s.deadvance.length?s.valid=!1:s.unadvance.length?s.valid=void 0:s.valid=!1),s}#N(){let e=[...arguments],[t,n,s,r]=e;s=s instanceof Ae?s.valueOf():s;return r=r instanceof Ae?r.valueOf():r,{$key:t,$value:n,$source:s,$target:r}}validateProperty(){const{$key:e,$value:t,$source:n,$target:s}=this.#N(...arguments);let r;"array"===this.type?r=this.context[0]:"object"===this.type&&(r=this.context[e]);const{path:i}=this,a=i?[i,e].join("."):e,o=new ne({definition:r,path:a,key:e,value:t});if(void 0===r){const n=new _({type:null,definition:null,key:e,value:t},this);n.pass=!1,o.unadvance.push(n)}else if(r instanceof ie){let n;n=s&&s[e]?r.validate(e,t,s[e]):r.validate(e,t),!0===n.valid?o.advance.push(n):!1===n.valid?o.deadvance.push(n):void 0===n.valid&&o.unadvance.push(n)}else e:for(const[i,a]of Object.entries(r.validators)){const r=a.validate(e,t,n,s);if(!0===r.pass?o.advance.push(r):!1===r.pass?o.deadvance.push(r):void 0===r.pass&&o.unadvance.push(r),"one"===this.verificationType&&o.deadvance.length)break e}return o.deadvance.length?o.valid=!1:o.advance.length?o.valid=!0:o.unadvance.length&&(o.valid=!1),o}}const{recursiveAssign:ae}=y;class oe extends CustomEvent{#e;#K;#M;constructor(e,t,n){if(super(e,t),this.#e=t,this.#K=n,!this.model.parent)return this}get model(){return this.#K}get key(){return void 0!==this.#M||(this.path?this.#M=this.path.split(".").pop():this.#M=null),this.#M}get change(){return this.#e.change}get value(){return this.#e.value}get path(){return this.#e.path}get detail(){return this.#e.detail}}class ce{#F=!1;#U=!1;#W=!1;#H=!1;#R;#J;#G;#Q;constructor(e={}){for(const[t,n]of Object.entries(e))this[t]=n}get preter(){return this.#J}set preter(e){if(!0===this.#U)return this.#J;this.#J=e instanceof Ae?e.valueOf():e,this.#U=!0}get anter(){return this.#G}set anter(e){if(!0===this.#W)return this.#G;this.#G=e instanceof Ae?e.valueOf():e,this.#W=!0}get conter(){if(!0===this.#H||[this.#U,this.#W].includes(!1))return this.#Q;const e=JSON.stringify(this.preter);let t;return t=JSON.stringify(this.anter)!==e,this.#Q=t,this.#H=!0,this.#Q}}let le=class extends CustomEvent{#e;#K;#M;#r;#X;#_;constructor(e,t,n){super(e),this.#e=t,this.#K=n}get key(){return void 0!==this.#M||(this.#M=this.#e.key),this.#M}get path(){return void 0!==this.#r||(this.#r=this.#e.path),this.#r}get value(){return void 0!==this.#X||(this.#X=this.#e.value),this.#X}get valid(){return void 0!==this.#_||(this.#_=this.#e.valid),this.#_}};const{recursiveAssign:pe,typedObjectLiteral:he}=y;const{impandTree:de,typedObjectLiteral:ue}=y;const{typedObjectLiteral:fe}=y;var ve={assign:function(e,t,...n){const{path:s,target:r,schema:i}=e,{events:a,sourceTree:o,enableValidation:c,validationEvents:l}=t,p=[],h=new ce({preter:e});for(let t of n){let n;const h=new ce({preter:e});Array.isArray(t)?n=[]:"object"==typeof t&&(n={});e:for(let[p,h]of Object.entries(t)){const d=new ce({preter:r[p]}),u=new ce({preter:r[p]});if(i&&c){const n=i.validateProperty(p,h,t,e);if(l){let t,r;s?[s,p].join("."):String(p);n.valid?(t="validProperty",r=["validProperty",p].join(":")):(t="nonvalidProperty",r=["nonvalidProperty",p].join(":"));for(const s of[t,r])e.dispatchEvent(new le(s,n,e))}if(!n.valid)continue e}let f;if(h&&"object"==typeof h){let t;h instanceof Ae&&(f=h.valueOf()),t="array"===i?.type?i.context[0]:"object"===i?.type?i.context[p]:null;const a=s?[s,p].join("."):String(p);let c=he(h);f=!1===o?new Ae(c,t,pe({},e.options,{path:a,parent:e})):r[p]instanceof Ae?r[p]:new Ae(c,t,pe({},e.options,{path:a,parent:e}));const l={[p]:f};Object.assign(r,l),Object.assign(n,l),f.assign(h)}else{f=h;const e={[p]:f};Object.assign(r,e),Object.assign(n,e)}if(a){const t=s?[s,p].join("."):String(p);if(a["assignSourceProperty:$key"]){const s=["assignSourceProperty",p].join(":");u.anter=r[p],e.dispatchEvent(new oe(s,{path:t,value:f,change:u,detail:{source:n}},e))}a.assignSourceProperty&&(d.anter=r[p],e.dispatchEvent(new oe("assignSourceProperty",{path:t,value:f,change:d,detail:{source:n}},e)))}}p.push(n),a&&a.assignSource&&(h.anter=e,e.dispatchEvent(new oe("assignSource",{path:s,change:h,detail:{source:n}},e)))}return a&&a.assign&&(h.anter=e,e.dispatchEvent(new oe("assign",{path:s,change:h,detail:{sources:p}},e))),e},defineProperties:function(e,t,n){const{events:s}=t,{path:r}=e,i=Object.entries(n),a=de(n,"value");ue(e.valueOf());const o=new ce({preter:e});for(const[t,n]of i)e.defineProperty(t,n,a);return s&&s.defineProperties&&(o.anter=e,e.dispatchEvent(new oe("defineProperties",{path:r,value:e.valueOf(),detail:{descriptors:n}},e))),e},defineProperty:function(e,t,n,s){const{descriptorTree:r,events:i}=t,{target:a,path:o,schema:c}=e,{enableValidation:l,validationEvents:p}=t,h=s.value,d=(Object.getOwnPropertyDescriptor(a,n)||{}).value,u=new ce({preter:d}),f=new ce({preter:d}),v=d instanceof Ae;if(c&&l){const t=c.validateProperty(n,h,e);if(p){let s,r;o?[o,n].join("."):String(n);t.valid?(s="validProperty",r=["validProperty",n].join(":")):(s="nonvalidProperty",r=["nonvalidProperty",n].join(":"));for(const n of[s,r])e.dispatchEvent(new le(n,t,e))}if(!t.valid)return e}if("object"==typeof h){let t;t="array"===c.type?c.context[0]:"object"===c.type?c.context[n]:void 0;const i=o?[o,n].join("."):String(n);if(v)!0===r?d.defineProperties(h):Object.defineProperty(a,n,s);else{let o=fe(h);const c=new Ae(o,t,{path:i,parent:e});c.retroReenableEvents(),!0===r?(c.defineProperties(h),a[n]=c):!1===r&&Object.defineProperty(a,n,s)}}else Object.defineProperty(a,n,s);if(i){const t=o?[o,n].join("."):String(n);if(i["defineProperty:$key"]){f.anter=a[$sourceKey];const r=["defineProperty",n].join(":");e.dispatchEvent(new oe(r,{path:t,value:h,change:f,detail:{prop:n,descriptor:s}},e))}i.defineProperty&&(u.anter=a[$sourceKey],e.dispatchEvent(new oe("defineProperty",{path:t,value:h,change:u,detail:{prop:n,descriptor:s}},e)))}return e},freeze:function(e,t){const{recursive:n,events:s}=t,{target:r}=e;if(!0===n)for(const[t,n]of Object.entries(r))n instanceof Ae&&(n.freeze(),s&&s.freezeProperty&&e.dispatchEvent(new oe("freezeProperty",{path:n.path},e)));return Object.freeze(r),s&&s.freeze&&e.dispatchEvent(new oe("freeze",{path:e.path},e)),e},seal:function(e,t){const{recursive:n,events:s}=t,{target:r}=e;if(!0===n)for(const[t,n]of Object.entries(r))n instanceof Ae&&(n.seal(),s&&s.sealProperty&&e.dispatchEvent(new oe("sealProperty",{path:n.path},e)));return Object.seal(r),s&&s.seal&&e.dispatchEvent(new oe("seal",{path:e.path},e)),e}};var ge={concat:function(e,t){const{target:n,path:s,schema:r}=e,{enableValidation:i,validationEvents:a,events:o}=t,c=[...arguments].reduce(((e,t)=>(Array.isArray(t)?e.push(...t):e.push(t),e)),[]);let l=n.length;const p=[];let h,d=[...Array.from(n)];e:for(const t of c){if(r&&i){const t=r.validateProperty(l,$subvalue,{},e);if(r&&a){let n,r;s?[s,l].join("."):String(l);t.valid?(n="validProperty",r=["validProperty",":",l].join("")):(n="nonvalidProperty",r=["nonvalidProperty",":",l].join(""));for(const s of[n,r])e.dispatchEvent(new ValidatorEvent(s,t,e))}if(!t.valid){l++;continue e}}const n=s?[s,l].join("."):String(l);if("object"==typeof t){t instanceof Ae&&(t=t.valueOf());let s=r?.context[0]||null;const i=new Ae(t,s,{path:n,parent:e});p[l]=i}else p[l]=t;if(d=Array.prototype.concat.call(d,p[l]),o){const t=s?[s,l].join("."):String(l);if(o.concatValue&&e.dispatchEvent(new oe("concatValue",{path:t,value:p[l],detail:{valueIndex:l,value:p[l]}},e)),o["concatValue:$index"]){["concatValue",":",l].join("");e.dispatchEvent(new oe("concatValue",{path:t,value:p[l],detail:{valueIndex:l,value:p[l]}},e))}}l++}return h=new Ae(d,r,e.options),o&&o.concat&&e.dispatchEvent(new oe("concat",{path:s,detail:{values:h}},e)),h},copyWithin:function(e,t){const{target:n,path:s}=e,{enableValidation:r,validationEvents:i,events:a}=t,o=arguments[0]>=0?arguments[0]:n.length=arguments[0],c=arguments[1]>=0?arguments[1]:n.length+arguments[1],l=void 0===arguments[2]?n.length:arguments[2]>=0?arguments[2]:n.length+arguments[2],p=[];let h=c,d=o;for(;h<l;){const t=n[h];if(p.push(t),Array.prototype.copyWithin.call(n,d,h,h+1),a){const n=s?[s,h].join("."):String(h);if(a.copyWithinIndex&&e.dispatchEvent(new oe("copyWithinIndex",{path:n,value:t,detail:{target:d,start:h,end:h+1,item:t}},e)),a["copyWithinIndex:$index"]){const s=["copyWithinIndex",":",h].join("");e.dispatchEvent(new oe(s,{path:n,value:t,detail:{target:d,start:h,end:h+1,item:t}},e))}}h++,d++}return a&&a.copyWithin&&e.dispatchEvent(new oe("copyWithin",{path:s,detail:{target:o,start:c,end:l,items:p}},e)),e},fill:function(e,t){const{target:n,path:s,schema:r}=e,{enableValidation:i,validationEvents:a,events:o}=t,c=[...arguments];let l,p;l="number"==typeof c[1]?c[1]>=0?c[1]:n.length+c[1]:0,p="number"==typeof c[2]?c[2]>=0?c[2]:n.length+c[2]:n.length;let h=l;e:for(;h<n.length&&h<p;){if(r&&i){let t=r.validate(t);if(a){let n,r;s?[s,h].join("."):String(h);t.valid?(n="validProperty",r=["validProperty",":",h].join("")):(n="nonvalidProperty",r=["nonvalidProperty",":",h].join(""));for(const s of[n,r])e.dispatchEvent(new ValidatorEvent(s,t,e))}if(!t.valid)continue e}const t=s?[s,h].join("."):String(h);let l=c[0];if("object"==typeof l){l instanceof Ae&&(l=l.valueOf());const n=r?.context[0]||null;l=new Ae(l,n,{path:t,parent:e})}if(Array.prototype.fill.call(n,l,h,h+1),o){const t=s?[s,h].join("."):String(h);if(o.fillIndex&&e.dispatchEvent(new oe("fillIndex",{path:t,value:l,detail:{start:h,end:h+1,value:l}},e)),o["fillIndex:$index"]){const n=["fillIndex",":",h].join("");e.dispatchEvent(new oe(n,{path:t,detail:{start:h,end:h+1,value:l}},e))}}h++}return o&&o.fill&&e.dispatchEvent(new oe("fill",{path:s,detail:{start:l,end:p,value:value}},e)),e},pop:function(e,t){const{events:n}=t,{target:s,path:r}=e,i=Array.prototype.pop.call(s),a=s.length-1;if(n&&n.pop){const t=r?[r,a].join("."):String(a);e.dispatchEvent(new oe("pop",{path:t,value:i,detail:{elementIndex:a,element:i}},e))}return i},push:function(e,t,...n){const{events:s}=t,{target:r,path:i,schema:a}=e,{enableValidation:o,validationEvents:c}=e.options,l=[];let p=0;for(let t of n){if(a&&o){const n=a.validateProperty(p,t,{},e);if(c){let t,s;i?[i,p].join("."):String(p);n.valid?(t="validProperty",s=["validProperty",":",p].join("")):(t="nonvalidProperty",s=["nonvalidProperty",":",p].join(""));for(const r of[t,s])e.dispatchEvent(new ValidatorEvent(r,n,e))}if(!n.valid)return r.length}const n=i?[i,p].join("."):String(p);if("object"==typeof t){t instanceof Ae&&(t=t.valueOf());const s=a?.context[0]||null;t=new Ae(t,s,{path:n,parent:e}),l.push(t),Array.prototype.push.call(r,t)}else l.push(t),Array.prototype.push.call(r,t);if(s){const t=i?[i,".",p].join(""):String(p);if(s.pushProp&&e.dispatchEvent(new oe("pushProp",{path:t,value:l[p],detail:{elementsIndex:p,element:l[p]}},e)),s["pushProp:$index"]){const n=["pushProp",":",p].join("");e.dispatchEvent(new oe(n,{path:t,value:l[p],detail:{elementsIndex:p,element:l[p]}},e))}}p++}return s&&s.push&&e.dispatchEvent(new oe("push",{path:i,detail:{elements:l}},e)),r.length},reverse:function(e,t){const{events:n}=t,{target:s,path:r}=e;return Array.prototype.reverse.call(s,...arguments),n&&n.reverse&&e.dispatchEvent(new oe("reverse",{path:r,detail:{reference:s}},e)),e},shift:function(e,t){const{events:n}=t,{target:s,path:r}=e,i=Array.prototype.shift.call(s),a=0;if(n&&n.shift){const t=r?[r,a].join("."):String(a);e.dispatchEvent(new oe("shift",{path:t,value:i,detail:{elementIndex:a,element:i}},e))}return i},splice:function(e,t){const{events:n}=t,{target:s,path:r,schema:i}=e,{enableValidation:a,validationEvents:o}=t,c=[...arguments],l=c[0]>=0?c[0]:s.length+c[0],p=c[1]<=0?0:void 0===c[1]||l+c[1]>=s.length?s.length-l:c[1],h=c.slice(2),d=h.length,u=[];let f=0;for(;f<p;){const t=Array.prototype.splice.call(s,l,1)[0];if(u.push(t),n){const s=r?[r,f].join("."):String(f);if(n.spliceDelete&&e.dispatchEvent(new oe("spliceDelete",{path:s,value:t,detail:{index:l+f,deleteIndex:f,deleteItem:t}},e)),n["spliceDelete:$index"]){const n=["spliceDelete",":",f].join("");e.dispatchEvent(new oe(n,{path:s,value:t,detail:{index:l+f,deleteIndex:f,deleteItem:t}},e))}}f++}let v=0;e:for(;v<d;){let t=h[v];if(i&&a){const t=i.validateProperty(elementIndex,element,{},e);if(o){let n,s;r?[r,v].join("."):String(v);t.valid?(n="validProperty",s=["validProperty",":",v].join("")):(n="nonvalidProperty",s=["nonvalidProperty",":",v].join(""));for(const r of[n,s])e.dispatchEvent(new ValidatorEvent(r,t,e))}if(!t.valid){v++;continue e}}const c=r?[r,v].join("."):String(v);let p=l+v;if("object"==typeof t){t instanceof Ae&&(t=t.valueOf());const n=i?.context[0]||null;t=new Ae(t,n,{path:c,parent:e}),Array.prototype.splice.call(s,p,0,t)}else Array.prototype.splice.call(s,p,0,t);if(n){const s=r?[r,v].join("."):String(v);if(n.spliceAdd&&e.dispatchEvent(new oe("spliceAdd",{path:s,value:t,detail:{index:l+v,addIndex:v,addItem:t}},e)),n["spliceAdd:$index"]){const n=["spliceAdd",":",v].join("");e.dispatchEvent(new oe(n,{path:s,value:t,detail:{index:l+v,addIndex:v,addItem:t}},e))}}v++}return n&&n.splice&&e.dispatchEvent(new oe("splice",{path:r,detail:{$start:l,deleted:u,added:h,length:s.length}},e)),u},unshift:function(e,t,...n){const{events:s}=t,{target:r,path:i,schema:a}=e,{enableValidation:o,validationEvents:c}=t,l=[];let p=n.length-1,h=0;for(;p>-1;){n.length;let t,d=n[p];r[p];if(a&&o){const t=a.validateProperty(p,d,{},e);if(c){let n,s;i&&[i,".",h].join("");t.valid?(n="validProperty",s=["validProperty",":",h].join("")):(n="nonvalidProperty",s=["nonvalidProperty",":",h].join(""));for(const r of[n,s])e.dispatchEvent(new le(r,t,e))}if(!t.valid)return e.length}if("object"==typeof d){const n=a?.context[0]||null,s=i?i.concat(".",h):String(h);t=new Ae(d,n,{path:s,parent:e}),l.unshift(t),Array.prototype.unshift.call(r,t)}else t=d,l.unshift(t),Array.prototype.unshift.call(r,d);if(s){const n=["unshiftProp",h].join(":"),r=i?[i,h].join("."):String(h);s.unshiftProp&&e.dispatchEvent(new oe("unshiftProp",{path:r,value:t,detail:{elementIndex:h,element:t}},e)),s["unshiftProp:$index"]&&e.dispatchEvent(new oe(n,{path:r,value:t,detail:{elementIndex:h,element:t}},e))}p--,h++}return s&&s.unshift&&l.length&&e.dispatchEvent(new oe("unshift",{path:i,detail:{elements:l}},e)),e.length}};const{regularExpressions:ye}=y;const{recursiveAssign:be}=y;const{recursiveAssign:je,regularExpressions:me,typeOf:Pe}=y;const{recursiveAssign:Ee}=y;const{regularExpressions:Oe}=y;const{recursiveAssign:xe}=y;var we={get:function(e,t,...n){let s;const r=be({},e.options,t);return"string"==typeof n[0]?(2===n.length&&be(r,n[1]),s=function(e,t,n){const{target:s,path:r}=e,{events:i,pathkey:a,subpathError:o}=t;if(!0===a){const a=n.split(new RegExp(ye.quotationEscape)),c=a.shift();let l=s[c];if(a.length){if(!1===o&&void 0===l)return;return l.get(a.join("."),t)}if(i&&(i.getProperty&&e.dispatchEvent(new oe("getProperty",{path:r,value:l,detail:{key:c,value:l}},e)),i["getProperty:$key"])){const t=["getProperty",":",c].join(""),n=[r,".",c].join("");e.dispatchEvent(new oe(t,{path:n,detail:{value:l}},e))}return l}if(!1===a)return s[propertyKey]}(e,r,...n)):(1===n.length&&be(r,n[0]),s=function(e,t){const{path:n}=e,{events:s}=t;return s&&s.get&&e.dispatchEvent(new oe("get",{path:n,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s},set:function(e,t,...n){let s;const r=Ee({},e.options,t);return"string"==typeof n[0]?(3===n.length&&Ee(r,n[2]),s=function(e,t,n,s){const{target:r,path:i,schema:a}=e,{enableValidation:o,validationEvents:c,events:l,pathkey:p,subpathError:h,recursive:d,source:u}=t;if(!0===p){const p=n.split(new RegExp(me.quotationEscape)),f=p.shift();let v;const g=Pe(s),y=i?[i,f].join("."):String(f);if(p.length){if(d&&void 0===r[f]){let n,s;n="array"===a?.type?a.context[0]:"object"===a?.type?a.context[f]:void 0,s="array"===g?[]:"object"===g||isNaN(Number(f))?{}:[],v=new Ae(s,n,je({},t,{path:y,parent:e}))}else v=r[f];if(!1===h&&void 0===v)return;return v.set(p.join("."),s,t),v}if(a&&o){const t=a.validateProperty(f,s,u,e);if(c){let n,s;i?[i,f].join("."):String(f),t.valid?(n="validProperty",s=["validProperty",":",f].join("")):(n="nonvalidProperty",s=["nonvalidProperty",":",f].join(""));for(const r of[n,s])e.dispatchEvent(new le(r,t,e))}if(!t.valid)return}if("object"==typeof s){s instanceof Ae&&(s=s.valueOf());const n=Pe(s);let i,o;i="array"===a?.type?a.context[0]:"object"===a?.type?a.context[f]:void 0,o="array"===n?[]:"object"===n||isNaN(Number(f))?{}:[],v=new Ae(o,i,je({},t,{path:y,parent:e})),r[f]=v,v.set(s)}else v=s,r[f]=v;if(l){const t=i?[i,f].join("."):String(f);if(l.setProperty&&e.dispatchEvent(new oe("setProperty",{path:t,value:v,detail:{key:f,value:v}},e)),l["setProperty:$key"]){const n=["setProperty",":",f].join("");e.dispatchEvent(new oe(n,{path:t,value:v,detail:{value:v}},e))}}return v}if(!1===p){let o=n;if("object"==typeof s){s instanceof Ae&&(s=s.valueOf());const n=Pe(s);let c,l;"array"===a?.type&&(c=a.context[0]),c="object"===a?.type?a.context[o]:void 0,l="array"===n?[]:"object"===n||isNaN(Number(o))?{}:[];const p=i?[i,o].join("."):String(o);propertyValue=new Ae(l,c,je({},t,{path:p,parent:e})),r[o]=propertyValue,propertyValue.set(s)}else propertyValue=s,r[o]=propertyValue;if(l){const t=i?[i,o].join("."):String(o);if(l.setProperty&&e.dispatchEvent(new oe("setProperty",{path:t,value:propertyValue,detail:{key:o,value:propertyValue}},e)),l["setProperty:$key"]){const n=["setProperty",":",o].join("");e.dispatchEvent(new oe(n,{path:t,value:propertyValue,detail:{value:propertyValue}},e))}}return propertyValue}}(e,r,...n)):(2===n.length&&Ee(r,n[1]),s=function(e,t,n){for(const[s,r]of Object.entries(n))e.set(s,r,t);const{path:s}=e,{events:r}=t;return r&&r.set&&e.dispatchEvent(new oe("set",{path:s,value:e.valueOf(),detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s},delete:function(e,t,...n){let s;const r=xe({},e.options,t);return"string"==typeof n[0]?(2===n.length&&xe(r,n[1]),s=function(e,t,n){const{target:s,path:r,schema:i}=e,{events:a,pathkey:o,subpathError:c,enableValidation:l,validationEvents:p}=t;if(!0!==o)if(!1!==o);else{const o=n,c=s[o];if(i&&l){const t=e.valueOf();delete t[o];const n=i.validate(o,t,e,e);if(p){let t,s;r?[r,o].join("."):String(o),n.valid?(t="validProperty",s=["validProperty",":",o].join("")):(t="nonvalidProperty",s=["nonvalidProperty",":",o].join(""));for(const r of[t,s])e.dispatchEvent(new ValidatorEvent(r,n,e))}if(!n.valid)return}if(c instanceof Ae&&c.delete(t),delete s[o],a&&(a.deleteProperty&&e.dispatchEvent(new oe("deleteProperty",{path:r,value:c,detail:{key:o,value:c}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",":",o].join(""),n=[r,".",o].join("");e.dispatchEvent(new oe(t,{path:n,value:c,detail:{value:c}},e))}}else{const o=n.split(new RegExp(Oe.quotationEscape)),h=o.shift();let d=s[h];if(o.length){if(!1===c&&void 0===d)return;return d.delete(o.join("."),t)}if(i&&l){const t=e.valueOf();delete t[h];const n=i.validate(h,t,{},e);if(p){let t,s;const i=r?[r,h].join("."):String(h);n.valid?(t="validProperty",s=["validProperty",":",h].join("")):(t="nonvalidProperty",s=["nonvalidProperty",":",h].join(""));for(const r of[t,s])e.dispatchEvent(new ValidatorEvent(r,Object.assign(n,{path:i}),e))}if(!n.valid)return}if("object"==typeof d&&d.delete(t),delete s[h],a&&(a.deleteProperty&&e.dispatchEvent(new oe("deleteProperty",{path:r,value:d,detail:{key:h,value:d}},e)),a["deleteProperty:$key"])){const t=["deleteProperty",":",h].join(""),n=[r,".",h].join("");e.dispatchEvent(new oe(t,{path:n,value:d,detail:{value:d}},e))}}}(e,r,...n)):(1===n.length&&xe(r,n[0]),s=function(e,t){const{target:n}=e;for(const[s,r]of Object.entries(n))e.delete(s,t);const{path:s}=e,{events:r}=t;return r&&r.delete&&e.dispatchEvent(new oe("delete",{path:s,detail:{value:e.valueOf()}},e)),e}(e,r,...n)),s}};const ke=Object.freeze({object:[{keys:["valueOf"],createMethod:function(e,t){return function(){return t.parse({type:"object"})}}},{keys:["toString"],createMethod:function(e,t){return function(e={}){const n=void 0!==e.replacer?e.replacer:null,s=void 0!==e.space?e.space:0;return t.parse({type:"string",replacer:n,space:s})}}},{keys:["entries","fromEntries","getOwnPropertyDescriptors","getOwnPropertyDescriptor","getOwnPropertyNames","groupBy","hasOwn","is","getPrototypeOf","isExtensible","isFrozen","isSealed","keys","preventExtensions","values"],createMethod:function(e,t){return Object[e].bind(null,t.valueOf())}},{keys:["propertyIsEnumerable","hasOwnProperty"],createMethod:function(e,t){return()=>t.parse({type:"object"})[e]}},{type:"mutators",keys:Object.keys(ve),createMethod:function(e,t,n){return ve[e].bind(null,t,n)}}],array:[{keys:["from","fromAsync","isArray","of"],createMethod:function(e,t){return Array[e]}},{keys:["at","every","filter","find","findIndex","findLast","findLastIndex","flat","flatMap","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","sort","toReversed","toSorted","toSpliced","with"],createMethod:function(e,t){return Array.prototype[e].bind(null,t)}},{type:"mutators",keys:Object.keys(ge),createMethod:function(e,t,n){return ge[e].bind(null,t,n)}}],accessor:[{type:"mutators",keys:Object.keys(we),createMethod:function(e,t,n){return we[e].bind(null,t,n)}}]});const{typedObjectLiteral:Se,typeOf:$e}=y;class Ae extends V{#Y;#Z;#w;#S;#g;#L;#M;#r;#A;constructor(e={},t=null,n={}){if(super({accessors:[(e,t)=>void 0===t?e.target:e.get(t),(e,t)=>void 0===t?e:e[t]]}),n.addEvents&&this.addEvents(n.addEvents),n.enableEvents){const e=typeof n.enableEvents;"boolean"===e?this.enableEvents():"object"===e&&this.enableEvents(n.enableEvents)}this.#k=e,this.schema=t,this.#Z=(e=>ae({path:null,parent:null,enableValidation:!0,validationEvents:{"validProperty:$key":!0,validProperty:!0,"nonvalidProperty:$key":!0,nonvalidProperty:!0},pathkey:!0,subpathError:!1,assignmentMethod:"set",methods:{accessor:{get:{events:{get:!0,getProperty:!0,"getProperty:$key":!0}},set:{recursive:!0,events:{set:!0,setProperty:!0,"setProperty:$key":!0}},delete:{events:{delete:!0,deleteProperty:!0,"deleteProperty:$key":!0}}},array:{concat:{events:{"concatValue:$index":!0,concatValue:!0,concat:!0}},copyWithin:{events:{"copyWithinIndex:$index":!0,copyWithinIndex:!0,copyWithin:!0}},fill:{events:{"fillIndex:$index":!0,fillIndex:!0,fill:!0}},pop:{events:{pop:!0}},push:{events:{"pushProp:$index":!0,pushProp:!0,push:!0}},reverse:{events:{reverse:!0}},shift:{events:{shift:!0}},splice:{events:{"spliceDelete:$index":!0,spliceDelete:!0,"spliceAdd:$index":!0,spliceAdd:!0,splice:!0}},unshift:{events:{"unshiftProp:$index":!0,unshiftProp:!0,unshift:!0}}},object:{assign:{sourceTree:!0,events:{"assignSourceProperty:$key":!0,assignSourceProperty:!0,assignSource:!0,assign:!0}},defineProperties:{descriptorTree:!0,events:{defineProperties:!0}},defineProperty:{descriptorTree:!0,events:{defineProperty:!0,"defineProperty:$key":!0}},freeze:{recursive:!0,events:{freezeProperty:!0,freeze:!0}},seal:{recursive:!0,events:{sealProperty:!0,seal:!0}}}}},e))(n),function(e){for(const[t,n]of Object.entries(ke))for(const s of n){const{keys:n,createMethod:r,type:i}=s;for(const s of n)if("accessor"===t||"mutators"===i){const n=e.options?.methods[t][s]||{};Object.defineProperty(e,s,{enumerable:!1,writable:!1,configurable:!1,value:r(s,e,n)})}else Object.defineProperty(e,s,{enumerable:!1,writable:!1,configurable:!1,value:r(s,e)})}}(this),this[this.options.assignmentMethod](this.#k)}get#k(){return this.#Y}set#k(e){if(void 0===this.#Y)return e instanceof Ae&&(this.#Y=e.valueOf()),this.#Y=e,this.#Y}get options(){return this.#Z}get schema(){return this.#w}set schema(e){if(void 0!==this.#w)return;const t=$e(e);["undefined","null"].includes(t)?this.#w=null:e instanceof ie?this.#w=e:"array"===t?this.#w=new ie(...arguments):"object"===t&&(this.#w=new ie(e))}get classToString(){return Ae.toString()}get type(){return void 0!==this.#S||(this.#S=$e(this.#k)),this.#S}get parent(){return void 0!==this.#L||(this.#L=this.options.parent?this.options.parent:null),this.#L}get root(){let e=this;e:for(;e&&![void 0,null].includes(e.parent);)e=e.parent;return e}get key(){return void 0!==this.#M||(this.path?this.#M=this.path.split(".").pop():this.#M=null),this.#M}get path(){return void 0!==this.#r||(this.#r=this.options.path?String(this.options.path):null),this.#r}get target(){return void 0!==this.#g||(this.#g=Se(this.#k)),this.#g}retroReenableEvents(){let e=this;for(;e;)e.reenableEvents({enable:!0}),e=e.parent;return this}parse(e={type:"object",replacer:null,space:0}){let t=Se(this.type);for(const[e,n]of Object.entries(Object.getOwnPropertyDescriptors(this.target))){const{enumerable:s,value:r,writable:i,configurable:a}=n;n.value instanceof Ae?Object.defineProperty(t,e,{enumerable:s,value:r.parse({type:"object"}),writable:i,configurable:a}):Object.defineProperty(t,e,{enumerable:s,value:r,writable:i,configurable:a})}const{type:n,replacer:s,space:r}=e;return"object"===n?t:"string"===n?JSON.stringify(t,s,r):void 0}}export{Ae as Model,ie as Schema,ne as Validation,I as Validator,_ as Verification};
//# sourceMappingURL=objecture.min.js.map
